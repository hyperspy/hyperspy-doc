

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tools: the Signal class &mdash; HyperSpy 1.2+dev documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/hyperspy_logo.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="HyperSpy 1.2+dev documentation" href="../index.html"/>
        <link rel="up" title="HyperSpy User Guide (DRAFT)" href="index.html"/>
        <link rel="next" title="Signal1D Tools" href="signal1d.html"/>
        <link rel="prev" title="Getting started" href="getting_started.html"/>
 
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-25260850-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> HyperSpy
          

          
            
            <img src="../_static/hyperspy_logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.2+dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">HyperSpy User Guide (DRAFT)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="what_is_new.html">What&#8217;s new</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html">Installing HyperSpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Tools: the Signal class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-signal-class-and-its-subclasses">The Signal class and its subclasses</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-navigation-and-signal-dimensions">The navigation and signal dimensions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#transforming-between-signal-subclasses">Transforming between signal subclasses</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#binned-and-unbinned-signals">Binned and unbinned signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generic-tools">Generic tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mathematical-operations">Mathematical operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#indexing">Indexing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#signal-operations">Signal operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#iterating-over-the-navigation-axes">Iterating over the navigation axes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#iterating-external-functions-with-the-map-method">Iterating external functions with the map method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cropping">Cropping</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rebinning">Rebinning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#folding-and-unfolding">Folding and unfolding</a></li>
<li class="toctree-l4"><a class="reference internal" href="#splitting-and-stacking">Splitting and stacking</a></li>
<li class="toctree-l4"><a class="reference internal" href="#changing-the-data-type">Changing the data type</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transposing-changing-signal-spaces">Transposing (changing signal spaces)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#basic-statistical-analysis">Basic statistical analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-the-noise-properties">Setting the noise properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#speeding-up-operations">Speeding up operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#reusing-a-signal-for-output">Reusing a Signal for output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#interactive-operations">Interactive operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#region-of-interest-roi">Region Of Interest (ROI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#handling-complex-data">Handling complex data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calculate-the-angle-phase-argument">Calculate the angle / phase / argument</a></li>
<li class="toctree-l4"><a class="reference internal" href="#phase-unwrapping">Phase unwrapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-a-linear-phase-ramp">Add a linear phase ramp</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="signal1d.html">Signal1D Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="signal2d.html">Signal2D Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualisation.html">Data visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="mva.html">Machine learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html">Model fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="eels.html">Electron Energy Loss Spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="eds.html">Energy-Dispersive X-ray Spectrometry (EDS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dielectric_function.html">Dielectric function tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="io.html">Loading and saving data</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="metadata_structure.html">Metadata structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">Full HyperSpy API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing HyperSpy</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">HyperSpy</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">HyperSpy User Guide (DRAFT)</a> &raquo;</li>
      
    <li>Tools: the Signal class</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/user_guide/tools.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tools-the-signal-class">
<h1>Tools: the Signal class<a class="headerlink" href="#tools-the-signal-class" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-signal-class-and-its-subclasses">
<h2>The Signal class and its subclasses<a class="headerlink" href="#the-signal-class-and-its-subclasses" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This subsection can be a bit confusing for beginners.
Do not worry if you do not understand it all.</p>
</div>
<p>HyperSpy stores the data in the <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> class, that is
the object that you get when e.g. you load a single file using
<a class="reference internal" href="../api/hyperspy.html#hyperspy.io.load" title="hyperspy.io.load"><code class="xref py py-func docutils literal"><span class="pre">load()</span></code></a>. Most of the data analysis functions are also contained in
this class or its specialized subclasses. The <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a>
class contains general functionality that is available to all the subclasses.
The subclasses provide functionality that is normally specific to a particular
type of data, e.g. the <a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.signal1d.Signal1D" title="hyperspy._signals.signal1d.Signal1D"><code class="xref py py-class docutils literal"><span class="pre">Signal1D</span></code></a> class provides
common functionality to deal with one-dimensional (e.g. spectral) data and
<a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.eels.EELSSpectrum" title="hyperspy._signals.eels.EELSSpectrum"><code class="xref py py-class docutils literal"><span class="pre">EELSSpectrum</span></code></a> (which is a subclass of
<a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.signal1d.Signal1D" title="hyperspy._signals.signal1d.Signal1D"><code class="xref py py-class docutils literal"><span class="pre">Signal1D</span></code></a>) adds extra functionality to the
<a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.signal1d.Signal1D" title="hyperspy._signals.signal1d.Signal1D"><code class="xref py py-class docutils literal"><span class="pre">Signal1D</span></code></a> class for electron energy-loss
spectroscopy data analysis.</p>
<p>The <a class="reference internal" href="#signal-subclasses-table-label"><span>table below</span></a> summarises all the
currently available specialised <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> subclasses.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 1.0: </span>The <code class="xref py py-class docutils literal"><span class="pre">Signal1D</span></code>,
<code class="xref py py-class docutils literal"><span class="pre">Signal2D</span></code> and <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a>
classes deprecated the old <cite>Spectrum</cite> <cite>Image</cite> and <cite>Signal</cite> classes.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0: </span>New <a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.complex_signal.ComplexSignal" title="hyperspy._signals.complex_signal.ComplexSignal"><code class="xref py py-class docutils literal"><span class="pre">ComplexSignal</span></code></a>,
<a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.complex_signal1d.ComplexSignal1D" title="hyperspy._signals.complex_signal1d.ComplexSignal1D"><code class="xref py py-class docutils literal"><span class="pre">ComplexSignal1D</span></code></a> and
<a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.complex_signal2d.ComplexSignal2D" title="hyperspy._signals.complex_signal2d.ComplexSignal2D"><code class="xref py py-class docutils literal"><span class="pre">ComplexSignal2D</span></code></a>
<a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> subclasses specialised in complex data.</p>
</div>
<p>The <a class="reference internal" href="../api/hyperspy.html#module-hyperspy.signals" title="hyperspy.signals"><code class="xref py py-mod docutils literal"><span class="pre">signals</span></code></a> module, which contains all available signal subclasses,
is imported in the user namespace when loading hyperspy. In the following
example we create a Signal2D instance from a 2D numpy array:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span>
<span class="go">&lt;Signal2D, title: , dimensions: (|64, 64)&gt;</span>
</pre></div>
</div>
<p>The different signals store other objects in what are called attributes. For
examples, the data is stored in a numpy array in the
<a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.data" title="hyperspy.signal.BaseSignal.data"><code class="xref py py-attr docutils literal"><span class="pre">data</span></code></a> attribute, the original parameters in the
<code class="xref py py-attr docutils literal"><span class="pre">original_metadata</span></code> attribute, the mapped parameters
in the <code class="xref py py-attr docutils literal"><span class="pre">metadata</span></code> attribute and the axes
information (including calibration) can be accessed (and modified) in the
<code class="xref py py-attr docutils literal"><span class="pre">axes_manager</span></code> attribute.</p>
</div>
<div class="section" id="the-navigation-and-signal-dimensions">
<h2>The navigation and signal dimensions<a class="headerlink" href="#the-navigation-and-signal-dimensions" title="Permalink to this headline">¶</a></h2>
<p>HyperSpy can deal with data of arbitrary dimensions. Each dimension is
internally classified as either &#8220;navigation&#8221; or &#8220;signal&#8221; and the way this
classification is done determines the behaviour of the signal.</p>
<p>The concept is probably best understood with an example: let&#8217;s imagine a three
dimensional dataset e.g. a numpy array with dimensions <cite>(10, 20, 30)</cite>. This
dataset could be an spectrum image acquired by scanning over a sample in two
dimensions. As in this case the signal is one-dimensional we use a
<code class="xref py py-class docutils literal"><span class="pre">Signal1D</span></code> subclass for this data e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (20, 10|30)&gt;</span>
</pre></div>
</div>
<p>In HyperSpy&#8217;s terminology, the <em>signal dimension</em> of this dataset is 30 and
the navigation dimensions (20, 10). Notice the separator <cite>|</cite> between the
navigation and signal dimensions.</p>
<p>However, the same dataset could also be interpreted as an image
stack instead.  Actually it could has been acquired by capturing two
dimensional images at different wavelengths. Then it would be natural to
identify the two spatial dimensions as the signal dimensions and the wavelength
dimension as the navigation dimension. To view the data in this way we could
have used a <code class="xref py py-class docutils literal"><span class="pre">Signal2D</span></code> instead e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span>
<span class="go">&lt;Signal2D, title: , dimensions: (10|30, 20)&gt;</span>
</pre></div>
</div>
<p>Indeed, for data analysis purposes,
one may like to operate with an image stack as if it was a set of spectra or
viceversa. One can easily switch between these two alternative ways of
classifiying the dimensions of a three-dimensional dataset by
<a class="reference internal" href="#transforming-signal"><span>transforming between BaseSignal subclasses</span></a>.</p>
<p>The same dataset could be seen as a three-dimensional signal:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">td</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">td</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (|30, 20, 10)&gt;</span>
</pre></div>
</div>
<p>Notice that with use <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> because there is
no specialised subclass for three-dimensional data. Also note that by default
<a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> interprets all dimensions as signal dimensions.
We could also configure it to operate on the dataset as a three-dimensional
array of scalars by changing the default <em>view</em> of
<a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> by taking the transpose of it:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scalar</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scalar</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (30, 20, 10|)&gt;</span>
</pre></div>
</div>
<p>For more examples of manipulating signal axes in the &#8220;signal-navigation&#8221; space
can be found in <a class="reference internal" href="#signal-transpose"><span>Transposing (changing signal spaces)</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although each dimension can be arbitrarily classified as &#8220;navigation
dimension&#8221; or &#8220;signal dimension&#8221;, for most common tasks there is no need to
modify HyperSpy&#8217;s default choice.</p>
</div>
<div class="section" id="transforming-between-signal-subclasses">
<span id="transforming-signal"></span><h3>Transforming between signal subclasses<a class="headerlink" href="#transforming-between-signal-subclasses" title="Permalink to this headline">¶</a></h3>
<p>The different subclasses are characterized by the <cite>signal_type</cite> metadata attribute,
the data <cite>dtype</cite> and the signal dimension. See the table and diagram below.
<cite>signal_type</cite> describes the nature of the signal. It can be any string, normally the
acronym associated with a particular signal. In certain cases HyperSpy provides
features that are only available for a particular signal type through
<a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> subclasses. The <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> method
<a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.set_signal_type" title="hyperspy.signal.BaseSignal.set_signal_type"><code class="xref py py-meth docutils literal"><span class="pre">set_signal_type()</span></code></a> changes the signal_type in place, which
may result in a <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> subclass transformation.</p>
<p>Furthermore, the <cite>dtype</cite> of the signal data also affects the subclass assignment. There are
e.g. specialised signal subclasses to handle complex data (see the following diagram).</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../_images/HyperSpySignalOverview.png"><img alt="../_images/HyperSpySignalOverview.png" src="../_images/HyperSpySignalOverview.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Diagram showing the inheritance structure of the different subclasses</span></p>
</div>
<table border="1" class="docutils" id="id3">
<span id="signal-subclasses-table-label"></span><caption><span class="caption-text">BaseSignal subclass <code class="xref py py-attr docutils literal"><span class="pre">metadata</span></code> attributes.</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="59%" />
<col width="15%" />
<col width="19%" />
<col width="8%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">BaseSignal subclass</th>
<th class="head">signal_dimension</th>
<th class="head">signal_type</th>
<th class="head">dtype</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a></td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>real</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.signal1d.Signal1D" title="hyperspy._signals.signal1d.Signal1D"><code class="xref py py-class docutils literal"><span class="pre">Signal1D</span></code></a></td>
<td>1</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>real</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.eels.EELSSpectrum" title="hyperspy._signals.eels.EELSSpectrum"><code class="xref py py-class docutils literal"><span class="pre">EELSSpectrum</span></code></a></td>
<td>1</td>
<td>EELS</td>
<td>real</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.eds_sem.EDSSEMSpectrum" title="hyperspy._signals.eds_sem.EDSSEMSpectrum"><code class="xref py py-class docutils literal"><span class="pre">EDSSEMSpectrum</span></code></a></td>
<td>1</td>
<td>EDS_SEM</td>
<td>real</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.eds_tem.EDSTEMSpectrum" title="hyperspy._signals.eds_tem.EDSTEMSpectrum"><code class="xref py py-class docutils literal"><span class="pre">EDSTEMSpectrum</span></code></a></td>
<td>1</td>
<td>EDS_TEM</td>
<td>real</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.signal2d.Signal2D" title="hyperspy._signals.signal2d.Signal2D"><code class="xref py py-class docutils literal"><span class="pre">Signal2D</span></code></a></td>
<td>2</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>real</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.dielectric_function.DielectricFunction" title="hyperspy._signals.dielectric_function.DielectricFunction"><code class="xref py py-class docutils literal"><span class="pre">DielectricFunction</span></code></a></td>
<td>1</td>
<td>DielectricFunction</td>
<td>complex</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.complex_signal.ComplexSignal" title="hyperspy._signals.complex_signal.ComplexSignal"><code class="xref py py-class docutils literal"><span class="pre">ComplexSignal</span></code></a></td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>complex</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.complex_signal1d.ComplexSignal1D" title="hyperspy._signals.complex_signal1d.ComplexSignal1D"><code class="xref py py-class docutils literal"><span class="pre">ComplexSignal1D</span></code></a></td>
<td>1</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>complex</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.complex_signal2d.ComplexSignal2D" title="hyperspy._signals.complex_signal2d.ComplexSignal2D"><code class="xref py py-class docutils literal"><span class="pre">ComplexSignal2D</span></code></a></td>
<td>2</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>complex</td>
</tr>
</tbody>
</table>
<p>The following example shows how to transform between different subclasses.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">100</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (20, 10|100)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span>
<span class="go">├── signal_type =</span>
<span class="go">└── title =</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">to_signal2D</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span>
<span class="go">&lt;Signal2D, title: , dimensions: (100|20, 10)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span><span class="o">.</span><span class="n">metadata</span>
<span class="go">├── signal_type =</span>
<span class="go">└── title =</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_signal_type</span><span class="p">(</span><span class="s2">&quot;EELS&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;EELSSpectrum, title: , dimensions: (20, 10|100)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="s2">&quot;complex&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;ComplexSignal1D, title: , dimensions: (20, 10|100)&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="binned-and-unbinned-signals">
<span id="signal-binned"></span><h2>Binned and unbinned signals<a class="headerlink" href="#binned-and-unbinned-signals" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.</span></p>
</div>
<p>Signals that are a histogram of a probability density function (pdf) should
have the <code class="docutils literal"><span class="pre">signal.metadata.Signal.binned</span></code> attribute set to
<code class="docutils literal"><span class="pre">True</span></code>. This is because some methods operate differently in signals that are
<em>binned</em>.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 1.0: </span><code class="docutils literal"><span class="pre">Simulation</span></code>, <code class="docutils literal"><span class="pre">SpectrumSimulation</span></code> and <code class="docutils literal"><span class="pre">ImageSimulation</span></code>
classes removed.</p>
</div>
<p>The default value of the <code class="docutils literal"><span class="pre">binned</span></code> attribute is shown in the
following table:</p>
<table border="1" class="docutils" id="id4">
<caption><span class="caption-text">Binned default values for the different subclasses.</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="89%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">BaseSignal subclass</th>
<th class="head">binned</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a></td>
<td>False</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.signal1d.Signal1D" title="hyperspy._signals.signal1d.Signal1D"><code class="xref py py-class docutils literal"><span class="pre">Signal1D</span></code></a></td>
<td>False</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.eels.EELSSpectrum" title="hyperspy._signals.eels.EELSSpectrum"><code class="xref py py-class docutils literal"><span class="pre">EELSSpectrum</span></code></a></td>
<td>True</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.eds_sem.EDSSEMSpectrum" title="hyperspy._signals.eds_sem.EDSSEMSpectrum"><code class="xref py py-class docutils literal"><span class="pre">EDSSEMSpectrum</span></code></a></td>
<td>True</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.eds_tem.EDSTEMSpectrum" title="hyperspy._signals.eds_tem.EDSTEMSpectrum"><code class="xref py py-class docutils literal"><span class="pre">EDSTEMSpectrum</span></code></a></td>
<td>True</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.signal2d.Signal2D" title="hyperspy._signals.signal2d.Signal2D"><code class="xref py py-class docutils literal"><span class="pre">Signal2D</span></code></a></td>
<td>False</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.complex_signal.ComplexSignal" title="hyperspy._signals.complex_signal.ComplexSignal"><code class="xref py py-class docutils literal"><span class="pre">ComplexSignal</span></code></a></td>
<td>False</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.complex_signal1d.ComplexSignal1D" title="hyperspy._signals.complex_signal1d.ComplexSignal1D"><code class="xref py py-class docutils literal"><span class="pre">ComplexSignal1D</span></code></a></td>
<td>False</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.complex_signal2d.ComplexSignal2D" title="hyperspy._signals.complex_signal2d.ComplexSignal2D"><code class="xref py py-class docutils literal"><span class="pre">ComplexSignal2D</span></code></a></td>
<td>False</td>
</tr>
</tbody>
</table>
<p>To change the default value:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Signal</span><span class="o">.</span><span class="n">binned</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
</div>
<div class="section" id="generic-tools">
<h2>Generic tools<a class="headerlink" href="#generic-tools" title="Permalink to this headline">¶</a></h2>
<p>Below we briefly introduce some of the most commonly used tools (methods). For
more details about a particular method click on its name. For a detailed list
of all the methods available see the <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> documentation.</p>
<p>The methods of this section are available to all the signals. In other chapters
methods that are only available in specialized
subclasses.</p>
<div class="section" id="mathematical-operations">
<h3>Mathematical operations<a class="headerlink" href="#mathematical-operations" title="Permalink to this headline">¶</a></h3>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 1.0.</span></p>
</div>
<p>A number of mathematical operations are available
in <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a>. Most of them are just wrapped numpy
functions.</p>
<p>The methods that perform mathematical opearation over one or more axis at a
time are:</p>
<ul class="simple">
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.sum" title="hyperspy.signal.BaseSignal.sum"><code class="xref py py-meth docutils literal"><span class="pre">sum()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.max" title="hyperspy.signal.BaseSignal.max"><code class="xref py py-meth docutils literal"><span class="pre">max()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.min" title="hyperspy.signal.BaseSignal.min"><code class="xref py py-meth docutils literal"><span class="pre">min()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.mean" title="hyperspy.signal.BaseSignal.mean"><code class="xref py py-meth docutils literal"><span class="pre">mean()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.std" title="hyperspy.signal.BaseSignal.std"><code class="xref py py-meth docutils literal"><span class="pre">std()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.var" title="hyperspy.signal.BaseSignal.var"><code class="xref py py-meth docutils literal"><span class="pre">var()</span></code></a></li>
</ul>
<p>Note that by default all this methods perform the operation over <em>all</em>
navigation axes.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;E&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (4, 2|6)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># by default perform operation over all navigation axes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (|6)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># can also pass axes individually</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (2|6)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or a tuple of axes to operate on, with duplicates, by index or directly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (|1)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Scalar axis, size: 1&gt;</span>
</pre></div>
</div>
<p>The following methods operate only on one axis at a time:</p>
<ul class="simple">
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.diff" title="hyperspy.signal.BaseSignal.diff"><code class="xref py py-meth docutils literal"><span class="pre">diff()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.derivative" title="hyperspy.signal.BaseSignal.derivative"><code class="xref py py-meth docutils literal"><span class="pre">derivative()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.integrate_simpson" title="hyperspy.signal.BaseSignal.integrate_simpson"><code class="xref py py-meth docutils literal"><span class="pre">integrate_simpson()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.integrate1D" title="hyperspy.signal.BaseSignal.integrate1D"><code class="xref py py-meth docutils literal"><span class="pre">integrate1D()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.valuemax" title="hyperspy.signal.BaseSignal.valuemax"><code class="xref py py-meth docutils literal"><span class="pre">valuemax()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.indexmax" title="hyperspy.signal.BaseSignal.indexmax"><code class="xref py py-meth docutils literal"><span class="pre">indexmax()</span></code></a></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0: </span>numpy ufunc operate on HyperSpy signals</p>
</div>
<p id="ufunc-label">All numpy ufunc can operate on <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a>
instances, for example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">General</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: A, dimensions: (|2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">&lt;Signal1D, title: exp(A), dimensions: (|2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([ 1.        ,  2.71828183])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">&lt;Signal1D, title: power(A, 2), dimensions: (|2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">&lt;Signal1D, title: add(A, A), dimensions: (|2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="go">&lt;Signal1D, title: add(Untitled Signal 1, Untitled Signal 2), dimensions: (|2)&gt;</span>
</pre></div>
</div>
<p>Notice that the title is automatically updated. When the signal has no title
a new title is automatically generated:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="go">&lt;Signal1D, title: add(Untitled Signal 1, Untitled Signal 2), dimensions: (|2)&gt;</span>
</pre></div>
</div>
<p>Functions (other than unfucs) that operate on numpy arrays can also operate
on <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> instances, however they return a numpy
array instead of a <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> instance e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">array([ 0.,  0.])</span>
</pre></div>
</div>
</div>
<div class="section" id="indexing">
<span id="signal-indexing"></span><h3>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.6.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8.1.</span></p>
</div>
<p>Indexing a <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a>  provides a powerful, convenient and
Pythonic way to access and modify its data. In HyperSpy indexing is achieved
using <code class="docutils literal"><span class="pre">isig</span></code> and <code class="docutils literal"><span class="pre">inav</span></code>, which allow the navigation and signal dimensions
to be indexed independently. The idea is essentially to specify a subset of the
data based on its position in the array and it is therefore essential to know
the convention adopted for specifying that position, which is described here.</p>
<p>Those new to Python may find indexing a somewhat esoteric concept but once
mastered it is one of the most powerful features of Python based code and
greatly simplifies many common tasks. HyperSpy&#8217;s Signal indexing is similar
to numpy array indexing and those new to Python are encouraged to read the
associated <a class="reference external" href="http://ipython.org/">numpy documentation on the subject</a>.</p>
<p>Key features of indexing in HyperSpy are as follows (note that some of these
features differ from numpy):</p>
<ul class="simple">
<li>HyperSpy indexing does:<ul>
<li>Allow independent indexing of signal and navigation dimensions</li>
<li>Support indexing with decimal numbers.</li>
<li>Use the image order for indexing i.e. [x, y, z,...] (hyperspy) vs
[...,z,y,x] (numpy)</li>
</ul>
</li>
<li>HyperSpy indexing does not:<ul>
<li>Support indexing using arrays.</li>
<li>Allow the addition of new axes using the newaxis object.</li>
</ul>
</li>
</ul>
<p>The examples below illustrate a range of common indexing tasks.</p>
<p>First consider indexing a single spectrum, which has only one signal dimension
(and no navigation dimensions) so we use <code class="docutils literal"><span class="pre">isig</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|10)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|1)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3, 4])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|6)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|6)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([5, 7, 9])</span>
</pre></div>
</div>
<p>Unlike numpy, HyperSpy supports indexing using decimal numbers, in which case
HyperSpy indexes using the axis scales instead of the indices.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|10)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span>
<span class="go">array([ 0. ,  0.5,  1. ,  1.5,  2. ,  2.5,  3. ,  3.5,  4. ,  4.5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mf">0.5</span><span class="p">:</span><span class="mf">4.</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([1, 2, 3, 4, 5, 6, 7])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mf">0.5</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mf">0.5</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([1, 3])</span>
</pre></div>
</div>
<p>Importantly the original <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> and its &#8220;indexed self&#8221;
share their data and, therefore, modifying the value of the data in one
modifies the same value in the other. Note also that in the example below
s.data is used to access the data as a numpy array directly and this array is
then indexed using numpy indexing.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (10,)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 2, 4, 6, 8])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([10, 10, 10, 10, 10])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([10,  1, 10,  3, 10,  5, 10,  7, 10,  9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 0, 0, 0, 0])</span>
</pre></div>
</div>
<p>Of course it is also possible to use the same syntax to index multidimensional
data treating navigation axes using <code class="docutils literal"><span class="pre">inav</span></code> and signal axes using <code class="docutils literal"><span class="pre">isig</span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (10, 10, 10)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([[[ 0,  1,  2,  3],</span>
<span class="go">    [ 4,  5,  6,  7],</span>
<span class="go">    [ 8,  9, 10, 11]],</span>

<span class="go">   [[12, 13, 14, 15],</span>
<span class="go">    [16, 17, 18, 19],</span>
<span class="go">    [20, 21, 22, 23]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="o">.</span><span class="n">signal_axes</span>
<span class="go">(&lt;t axis, size: 4&gt;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="o">.</span><span class="n">navigation_axes</span>
<span class="go">(&lt;x axis, size: 3, index: 0&gt;, &lt;y axis, size: 2, index: 0&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axes_manager</span>
<span class="go">&lt;Axes manager, axes: (&lt;t axis, size: 4&gt;,)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isig</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([3, 2, 1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Signal1D, title: , dimensions: (2, 3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axes_manager</span>
<span class="go">&lt;Axes manager, axes: (&lt;x axis, size: 3, index: 0&gt;, &lt;y axis, size: 2, index: 0&gt;)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([[ 0,  4,  8],</span>
<span class="go">   [12, 16, 20]])</span>
</pre></div>
</div>
<p>Independent indexation of the signal and navigation dimensions is demonstrated
further in the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (10, 10, 10)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([[[ 0,  1,  2,  3],</span>
<span class="go">    [ 4,  5,  6,  7],</span>
<span class="go">    [ 8,  9, 10, 11]],</span>

<span class="go">   [[12, 13, 14, 15],</span>
<span class="go">    [16, 17, 18, 19],</span>
<span class="go">    [20, 21, 22, 23]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="o">.</span><span class="n">signal_axes</span>
<span class="go">(&lt;t axis, size: 4&gt;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="o">.</span><span class="n">navigation_axes</span>
<span class="go">(&lt;x axis, size: 3, index: 0&gt;, &lt;y axis, size: 2, index: 0&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axes_manager</span>
<span class="go">&lt;Axes manager, axes: (&lt;t axis, size: 4&gt;,)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Signal1D, title: , dimensions: (2, 3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axes_manager</span>
<span class="go">&lt;Axes manager, axes: (&lt;x axis, size: 3, index: 0&gt;, &lt;y axis, size: 2, index: 0&gt;)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([[ 0,  4,  8],</span>
<span class="go">   [12, 16, 20]])</span>
</pre></div>
</div>
<p>The same syntax can be used to set the data values in signal and navigation
dimensions respectively:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (10, 10, 10)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([[[ 0,  1,  2,  3],</span>
<span class="go">    [ 4,  5,  6,  7],</span>
<span class="go">    [ 8,  9, 10, 11]],</span>

<span class="go">   [[12, 13, 14, 15],</span>
<span class="go">    [16, 17, 18, 19],</span>
<span class="go">    [20, 21, 22, 23]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([1, 1, 1, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([16, 17, 18, 19])</span>
</pre></div>
</div>
</div>
<div class="section" id="signal-operations">
<span id="id1"></span><h3>Signal operations<a class="headerlink" href="#signal-operations" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.6.</span></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.8.3.</span></p>
</div>
<p><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> supports all the Python binary arithmetic
opearations (+, -, *, //, %, divmod(), pow(), **, &lt;&lt;, &gt;&gt;, &amp;, ^, |),
augmented binary assignments (+=, -=, *=, /=, //=, %=, **=, &lt;&lt;=, &gt;&gt;=, &amp;=,
^=, |=), unary operations (-, +, abs() and ~) and rich comparisons operations
(&lt;, &lt;=, ==, x!=y, &lt;&gt;, &gt;, &gt;=).</p>
<p>These operations are performed element-wise. When the dimensions of the signals
are not equal <a class="reference external" href="http://docs.scipy.org/doc/numpy/user/basics.broadcasting.html">numpy broadcasting rules apply</a> independently
for the navigation and signal axes.</p>
<p>In the following example <cite>s2</cite> has only one navigation axis while <cite>s</cite> has two.
However, because the size of their first navigation axis is the same, their
dimensions are compatible and <cite>s2</cite> is
broacasted to match <cite>s</cite>&#8216;s dimensions.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2, 3|4, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2|4, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">+</span> <span class="n">s2</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2, 3|4, 5)&gt;</span>
</pre></div>
</div>
<p>In the following example the dimensions are not compatible and an exception
is raised.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2, 3|4, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span>
<span class="go">&lt;Signal2D, title: , dimensions: (3|4, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">+</span> <span class="n">s2</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;ipython-input-55-044bb11a0bd9&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
    <span class="n">s</span> <span class="o">+</span> <span class="n">s2</span>
  File <span class="nb">&quot;&lt;string&gt;&quot;</span>, line <span class="m">2</span>, in <span class="n">__add__</span>
  File <span class="nb">&quot;/home/fjd29/Python/hyperspy/hyperspy/signal.py&quot;</span>, line <span class="m">2686</span>, in <span class="n">_binary_operator_ruler</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">exception_message</span><span class="p">)</span>
<span class="gr">ValueError</span>: <span class="n">Invalid dimensions for this operation</span>
</pre></div>
</div>
<p>Broacasting operates exactly in the same way for the signal axes:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2, 3|4, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span>
<span class="go">&lt;Signal1D, title: , dimensions: (2, 3|4)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">+</span> <span class="n">s2</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2, 3|4, 5)&gt;</span>
</pre></div>
</div>
<p>In-place operators also support broadcasting, but only when broadcasting would
not change the left most signal dimensions:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">+=</span> <span class="n">s2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2, 3|4, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">+=</span> <span class="n">s</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;ipython-input-64-fdb9d3a69771&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
    <span class="n">s2</span> <span class="o">+=</span> <span class="n">s</span>
  File <span class="nb">&quot;&lt;string&gt;&quot;</span>, line <span class="m">2</span>, in <span class="n">__iadd__</span>
  File <span class="nb">&quot;/home/fjd29/Python/hyperspy/hyperspy/signal.py&quot;</span>, line <span class="m">2737</span>, in <span class="n">_binary_operator_ruler</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="n">op_name</span><span class="p">)(</span><span class="n">odata</span><span class="p">)</span>
<span class="gr">ValueError</span>: <span class="n">non-broadcastable output operand with shape (3,2,1,4) doesn\&#39;t match the broadcast shape (3,2,5,4)</span>
</pre></div>
</div>
</div>
<div class="section" id="iterating-over-the-navigation-axes">
<span id="signal-iterator"></span><h3>Iterating over the navigation axes<a class="headerlink" href="#iterating-over-the-navigation-axes" title="Permalink to this headline">¶</a></h3>
<p>BaseSignal instances are iterables over the navigation axes. For example, the
following code creates a stack of 10 images and saves them in separate &#8220;png&#8221;
files by iterating over the signal instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">single_image</span> <span class="ow">in</span> <span class="n">image_stack</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">single_image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;image </span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="o">.</span><span class="n">indices</span><span class="p">))</span>
<span class="go">The &quot;image (0, 0).png&quot; file was created.</span>
<span class="go">The &quot;image (1, 0).png&quot; file was created.</span>
<span class="go">The &quot;image (2, 0).png&quot; file was created.</span>
<span class="go">The &quot;image (3, 0).png&quot; file was created.</span>
<span class="go">The &quot;image (4, 0).png&quot; file was created.</span>
<span class="go">The &quot;image (0, 1).png&quot; file was created.</span>
<span class="go">The &quot;image (1, 1).png&quot; file was created.</span>
<span class="go">The &quot;image (2, 1).png&quot; file was created.</span>
<span class="go">The &quot;image (3, 1).png&quot; file was created.</span>
<span class="go">The &quot;image (4, 1).png&quot; file was created.</span>
</pre></div>
</div>
<p>The data of the signal instance that is returned at each iteration is a view of
the original data, a property that we can use to perform operations on the
data.  For example, the following code rotates the image at each coordinate  by
a given angle and uses the <a class="reference internal" href="../api/hyperspy.misc.html#hyperspy.misc.utils.stack" title="hyperspy.misc.utils.stack"><code class="xref py py-func docutils literal"><span class="pre">stack()</span></code></a> function in combination
with <a class="reference external" href="http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions">list comprehensions</a>
to make a horizontal &#8220;collage&#8221; of the image stack:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">lena</span><span class="p">()]</span><span class="o">*</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">image</span><span class="p">,</span> <span class="n">angle</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">image_stack</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">180</span><span class="p">)):</span>
<span class="gp">... </span>   <span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">reshape</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collage</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">image</span> <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">image_stack</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collage</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="../_images/rotate_lena.png"><img alt="../_images/rotate_lena.png" src="../_images/rotate_lena.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Rotation of images by iteration.</span></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.</span></p>
</div>
</div>
<div class="section" id="iterating-external-functions-with-the-map-method">
<h3>Iterating external functions with the map method<a class="headerlink" href="#iterating-external-functions-with-the-map-method" title="Permalink to this headline">¶</a></h3>
<p>Performing an operation on the data at each coordinate, as in the previous example,
using an external function can be more easily accomplished using the
<a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.map" title="hyperspy.signal.BaseSignal.map"><code class="xref py py-meth docutils literal"><span class="pre">map()</span></code></a> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">lena</span><span class="p">()]</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">angle</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">reshape</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collage</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">image</span> <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">image_stack</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collage</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="id6">
<a class="reference internal image-reference" href="../_images/rotate_lena_apply_simple.png"><img alt="../_images/rotate_lena_apply_simple.png" src="../_images/rotate_lena_apply_simple.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Rotation of images by the same amount using <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.map" title="hyperspy.signal.BaseSignal.map"><code class="xref py py-meth docutils literal"><span class="pre">map()</span></code></a>.</span></p>
</div>
<p>The <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.map" title="hyperspy.signal.BaseSignal.map"><code class="xref py py-meth docutils literal"><span class="pre">map()</span></code></a> method can also take variable
arguments as in the following example.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">lena</span><span class="p">()]</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">135</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modes</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="s1">&#39;reflect&#39;</span><span class="p">,</span> <span class="s1">&#39;wrap&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">angle</span><span class="o">=</span><span class="n">angles</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">reshape</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">mode</span><span class="o">=</span><span class="n">modes</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="go">calculating 100% |#############################################| ETA:  00:00:00Cropping</span>
</pre></div>
</div>
<div class="figure align-center" id="id7">
<a class="reference internal image-reference" href="../_images/rotate_lena_apply_ndkwargs.png"><img alt="../_images/rotate_lena_apply_ndkwargs.png" src="../_images/rotate_lena_apply_ndkwargs.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Rotation of images using <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.map" title="hyperspy.signal.BaseSignal.map"><code class="xref py py-meth docutils literal"><span class="pre">map()</span></code></a> with different
arguments for each image in the stack.</span></p>
</div>
</div>
<div class="section" id="cropping">
<h3>Cropping<a class="headerlink" href="#cropping" title="Permalink to this headline">¶</a></h3>
<p>Cropping can be performed in a very compact and powerful way using
<a class="reference internal" href="#signal-indexing"><span>Indexing</span></a> . In addition it can be performed using the following
method or GUIs if cropping <a class="reference internal" href="signal1d.html#signal1d-crop"><span>signal1D</span></a> or <span class="xref std std-ref">signal2D</span>. There is also a general <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.crop" title="hyperspy.signal.BaseSignal.crop"><code class="xref py py-meth docutils literal"><span class="pre">crop()</span></code></a>
method that operates <em>in place</em>.</p>
</div>
<div class="section" id="rebinning">
<h3>Rebinning<a class="headerlink" href="#rebinning" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.rebin" title="hyperspy.signal.BaseSignal.rebin"><code class="xref py py-meth docutils literal"><span class="pre">rebin()</span></code></a> method rebins data in place down to a size
determined by the user.</p>
</div>
<div class="section" id="folding-and-unfolding">
<h3>Folding and unfolding<a class="headerlink" href="#folding-and-unfolding" title="Permalink to this headline">¶</a></h3>
<p>When dealing with multidimensional datasets it is sometimes useful to transform
the data into a two dimensional dataset. This can be accomplished using the
following two methods:</p>
<ul class="simple">
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.fold" title="hyperspy.signal.BaseSignal.fold"><code class="xref py py-meth docutils literal"><span class="pre">fold()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.unfold" title="hyperspy.signal.BaseSignal.unfold"><code class="xref py py-meth docutils literal"><span class="pre">unfold()</span></code></a></li>
</ul>
<p>It is also possible to unfold only the navigation or only the signal space:</p>
<ul class="simple">
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.unfold_navigation_space" title="hyperspy.signal.BaseSignal.unfold_navigation_space"><code class="xref py py-meth docutils literal"><span class="pre">unfold_navigation_space()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.unfold_signal_space" title="hyperspy.signal.BaseSignal.unfold_signal_space"><code class="xref py py-meth docutils literal"><span class="pre">unfold_signal_space()</span></code></a></li>
</ul>
</div>
<div class="section" id="splitting-and-stacking">
<span id="signal-stack-split"></span><h3>Splitting and stacking<a class="headerlink" href="#splitting-and-stacking" title="Permalink to this headline">¶</a></h3>
<p>Several objects can be stacked together over an existing axis or over a
new axis using the <a class="reference internal" href="../api/hyperspy.misc.html#hyperspy.misc.utils.stack" title="hyperspy.misc.utils.stack"><code class="xref py py-func docutils literal"><span class="pre">stack()</span></code></a> function, if they share axis
with same dimension.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">lena</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">hs</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">image</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="id8">
<a class="reference internal image-reference" href="../_images/stack_lena_3_3.png"><img alt="../_images/stack_lena_3_3.png" src="../_images/stack_lena_3_3.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Stacking example.</span></p>
</div>
<p>An object can be splitted into several objects
with the <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.split" title="hyperspy.signal.BaseSignal.split"><code class="xref py py-meth docutils literal"><span class="pre">split()</span></code></a> method. This function can be used
to reverse the <a class="reference internal" href="../api/hyperspy.misc.html#hyperspy.misc.utils.stack" title="hyperspy.misc.utils.stack"><code class="xref py py-func docutils literal"><span class="pre">stack()</span></code></a> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="id9">
<a class="reference internal image-reference" href="../_images/split_lena_3_3.png"><img alt="../_images/split_lena_3_3.png" src="../_images/split_lena_3_3.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Splitting example.</span></p>
</div>
</div>
<div class="section" id="changing-the-data-type">
<span id="signal-change-dtype"></span><h3>Changing the data type<a class="headerlink" href="#changing-the-data-type" title="Permalink to this headline">¶</a></h3>
<p>Even if the original data is recorded with a limited dynamic range, it is often
desirable to perform the analysis operations with a higher precision.
Conversely, if space is limited, storing in a shorter data type can decrease
the file size. The <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.change_dtype" title="hyperspy.signal.BaseSignal.change_dtype"><code class="xref py py-meth docutils literal"><span class="pre">change_dtype()</span></code></a> changes the data
type in place, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;EELS Signal1D Signal2D (high-loss).dm3&#39;</span><span class="p">)</span>
<span class="go">    Title: EELS Signal1D Signal2D (high-loss).dm3</span>
<span class="go">    Signal type: EELS</span>
<span class="go">    Data dimensions: (21, 42, 2048)</span>
<span class="go">    Data representation: spectrum</span>
<span class="go">    Data type: float32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">    Title: EELS Signal1D Signal2D (high-loss).dm3</span>
<span class="go">    Signal type: EELS</span>
<span class="go">    Data dimensions: (21, 42, 2048)</span>
<span class="go">    Data representation: spectrum</span>
<span class="go">    Data type: float64</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7: </span>Support for RGB signals.</p>
</div>
<p>In addition to all standard numpy dtypes, HyperSpy supports four extra
dtypes for RGB images: rgb8, rgba8, rgb16 and rgba16. The requirements for changing
from and to any rgbx dtype are more strict than for most other dtype
conversions. To change to a rgbx dtype the <cite>signal_dimension</cite> must be 1 and its size 3(4) 3(4) for rgb(rgba) dtypes and the
dtype must be uint8(uint16) for rgbx8(rgbx16).  After conversion
the <cite>signal_dimension</cite> becomes 2. The dtype
of images of dtype rgbx8(rgbx16) can only be changed to uint8(uint16) and
the <cite>signal_dimension</cite> becomes 1.</p>
<p>In the following example we create a 1D signal with signal size 3 and with
<cite>dtype</cite> <cite>&#8220;uint16&#8221;</cite> and change its dtype to <cite>&#8220;rgb16&#8221;</cite> for plotting.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rgb_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ly</span><span class="p">,</span> <span class="n">lx</span> <span class="o">=</span> <span class="n">rgb_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset_factor</span> <span class="o">=</span> <span class="mf">0.16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_factor</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ogrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">lx</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">ly</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgb_test</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">lx</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">lx</span><span class="o">*</span><span class="n">offset_factor</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">ly</span><span class="o">*</span><span class="n">offset_factor</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">lx</span> <span class="o">*</span> <span class="n">ly</span> <span class="o">/</span> <span class="n">size_factor</span> <span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgb_test</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">lx</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">lx</span><span class="o">*</span><span class="n">offset_factor</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">ly</span><span class="o">*</span><span class="n">offset_factor</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">lx</span> <span class="o">*</span> <span class="n">ly</span> <span class="o">/</span> <span class="n">size_factor</span> <span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgb_test</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">lx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">ly</span><span class="o">*</span><span class="n">offset_factor</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">lx</span> <span class="o">*</span> <span class="n">ly</span> <span class="o">/</span> <span class="n">size_factor</span> <span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgb_test</span> <span class="o">*=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">16</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">rgb_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="s2">&quot;uint16&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (1024, 1024|3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="s2">&quot;rgb16&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal2D, title: , dimensions: (|1024, 1024)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="id10">
<a class="reference internal image-reference" href="../_images/rgb_example.png"><img alt="../_images/rgb_example.png" src="../_images/rgb_example.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">RGB data type example.</span></p>
</div>
</div>
<div class="section" id="transposing-changing-signal-spaces">
<span id="signal-transpose"></span><h3>Transposing (changing signal spaces)<a class="headerlink" href="#transposing-changing-signal-spaces" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.1.</span></p>
</div>
<p><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.transpose" title="hyperspy.signal.BaseSignal.transpose"><code class="xref py py-meth docutils literal"><span class="pre">transpose()</span></code></a> method changes how the dataset
dimensions are interpreted (as signal or navigation axes). By default is
swaps the signal and navigation axes. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (5, 4|6)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">&lt;Signal2D, title: , dimensions: (6|4, 5)&gt;</span>
</pre></div>
</div>
<p>For <code class="xref py py-meth docutils literal"><span class="pre">T()</span></code> is a shortcut for the default behaviour:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>
<span class="go">&lt;Signal2D, title: , dimensions: (6|4, 5)&gt;</span>
</pre></div>
</div>
<p>The method accepts both explicit axes to keep in either space, or just a number
of axes required in one space (just one number can be specified, as the other
is defined as &#8220;all other axes&#8221;). When axes order is not explicitly defined,
they are &#8220;rolled&#8221; from one space to the other as if the <code class="docutils literal"><span class="pre">&lt;navigation</span> <span class="pre">axes</span> <span class="pre">|</span>
<span class="pre">signal</span> <span class="pre">axes</span> <span class="pre">&gt;</span></code> wrap a circle. The example below should help clarifying this.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># just create a signal with many distinct dimensions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (|9, 8, 7, 6, 5, 4, 3, 2, 1)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">signal_axes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># roll to leave 5 axes in signal space</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (4, 3, 2, 1|9, 8, 7, 6, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">navigation_axes</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># roll leave 3 axes in navigation space</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (3, 2, 1|9, 8, 7, 6, 5, 4)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 3 explicitly defined axes in signal space</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">signal_axes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (8, 6, 5, 4, 2, 1|9, 7, 3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># A mix of two lists, but specifying all axes explicitly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The order of axes is preserved in both lists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">navigation_axes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">signal_axes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (8, 7, 6, 5, 4, 1|9, 3, 2)&gt;</span>
</pre></div>
</div>
<p>A convenience functions <a class="reference internal" href="../api/hyperspy.misc.html#hyperspy.misc.utils.transpose" title="hyperspy.misc.utils.transpose"><code class="xref py py-func docutils literal"><span class="pre">transpose()</span></code></a> is available to operate on
many signals at once, for example enabling plotting any-dimension signals
trivially:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="c1"># 2D signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="c1"># 3D signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s4</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="c1"># 4D signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">plot_images</span><span class="p">(</span><span class="n">hs</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">signal_axes</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.transpose" title="hyperspy.signal.BaseSignal.transpose"><code class="xref py py-meth docutils literal"><span class="pre">transpose()</span></code></a> method accepts keyword argument
<code class="docutils literal"><span class="pre">optimize</span></code>, which is <code class="docutils literal"><span class="pre">False</span></code> by default, meaning modifying the output
signal data <strong>always modifies the original data</strong> i.e. the data is just a view
of the original data. If <code class="docutils literal"><span class="pre">True</span></code>, the method ensures the data in memory is
stored in the most efficient manner for iterating by making a copy of the data
if required, hence modifying the output signal data <strong>not always modifies the
original data</strong>.</p>
<p>The convenience methods <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.as_signal1D" title="hyperspy.signal.BaseSignal.as_signal1D"><code class="xref py py-meth docutils literal"><span class="pre">as_signal1D()</span></code></a> and
<a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.as_signal2D" title="hyperspy.signal.BaseSignal.as_signal2D"><code class="xref py py-meth docutils literal"><span class="pre">as_signal2D()</span></code></a> internally use
<a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.transpose" title="hyperspy.signal.BaseSignal.transpose"><code class="xref py py-meth docutils literal"><span class="pre">transpose()</span></code></a>, but always optimize the data
for iteration over the navigation axes if required. Hence, these methods do not
always return a view of the original data. If a copy of the data is required
use <cite>:py:meth:`~.signal.BaseSignal.deepcopy</cite> on the output of any of these
methods e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span>
<span class="go">&lt;Signal2D, title: , dimensions: (6|4, 5)&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="basic-statistical-analysis">
<h2>Basic statistical analysis<a class="headerlink" href="#basic-statistical-analysis" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.</span></p>
</div>
<p><a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.get_histogram" title="hyperspy.signal.BaseSignal.get_histogram"><code class="xref py py-meth docutils literal"><span class="pre">get_histogram()</span></code></a> computes the histogram and
conveniently returns it as signal instance. It provides methods to
calculate the bins. <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.print_summary_statistics" title="hyperspy.signal.BaseSignal.print_summary_statistics"><code class="xref py py-meth docutils literal"><span class="pre">print_summary_statistics()</span></code></a> prints
the five-number summary statistics of the data.</p>
<p>These two methods can be combined with
<a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.get_current_signal" title="hyperspy.signal.BaseSignal.get_current_signal"><code class="xref py py-meth docutils literal"><span class="pre">get_current_signal()</span></code></a> to compute the histogram or
print the summary statistics of the signal at the current coordinates, e.g:
.. code-block:: python</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">EELSSpectrum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">print_summary_statistics</span><span class="p">()</span>
<span class="go">Summary statistics</span>
<span class="go">------------------</span>
<span class="go">mean:       0.021</span>
<span class="go">std:        0.957</span>
<span class="go">min:        -3.991</span>
<span class="go">Q1: -0.608</span>
<span class="go">median:     0.013</span>
<span class="go">Q3: 0.652</span>
<span class="go">max:        2.751</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">get_current_signal</span><span class="p">()</span><span class="o">.</span><span class="n">print_summary_statistics</span><span class="p">()</span>
<span class="go">Summary statistics</span>
<span class="go">------------------</span>
<span class="go">mean:   -0.019</span>
<span class="go">std:    0.855</span>
<span class="go">min:    -2.803</span>
<span class="go">Q1: -0.451</span>
<span class="go">median: -0.038</span>
<span class="go">Q3: 0.484</span>
<span class="go">max:    1.992</span>
</pre></div>
</div>
<p>Histogram of different objects can be compared with the functions
<a class="reference internal" href="../api/hyperspy.drawing.html#hyperspy.drawing.utils.plot_histograms" title="hyperspy.drawing.utils.plot_histograms"><code class="xref py py-func docutils literal"><span class="pre">plot_histograms()</span></code></a> (see
<a class="reference internal" href="visualisation.html#plot-spectra"><span>visualisation</span></a> for the plotting options). For example,
with histograms of several random chi-square distributions:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,[</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">plot_histograms</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="id11">
<a class="reference internal image-reference" href="../_images/plot_histograms_chisquare.png"><img alt="../_images/plot_histograms_chisquare.png" src="../_images/plot_histograms_chisquare.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Comparing histograms.</span></p>
</div>
</div>
<div class="section" id="setting-the-noise-properties">
<span id="signal-noise-properties"></span><h2>Setting the noise properties<a class="headerlink" href="#setting-the-noise-properties" title="Permalink to this headline">¶</a></h2>
<p>Some data operations require the data variance. Those methods use the
<code class="docutils literal"><span class="pre">metadata.Signal.Noise_properties.variance</span></code> attribute if it exists. You can
set this attribute as in the following example where we set the variance to be
10:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Signal</span><span class="o">.</span><span class="n">set_item</span><span class="p">(</span><span class="s2">&quot;Noise_properties.variance&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>For heterocedastic noise the <code class="docutils literal"><span class="pre">variance</span></code> attribute must be a
<code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code>.  Poissonian noise is a common case  of
heterocedastic noise where the variance is equal to the expected value. The
<code class="xref py py-meth docutils literal"><span class="pre">estimate_poissonian_noise_variance()</span></code>
<code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code> method can help setting the variance of data with
semi-poissonian noise. With the default arguments, this method simply sets the
variance attribute to the given <code class="docutils literal"><span class="pre">expected_value</span></code>. However, more generally
(although then noise is not strictly poissonian), the variance may be proportional
to the expected value. Moreover, when the noise is a mixture of white
(gaussian) and poissonian noise, the variance is described by the following
linear model:</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/253a5ef181fafd515121a05c0026c74d23f6f8a5.png" alt="\mathrm{Var}[X] = (a * \mathrm{E}[X] + b) * c"/></p>
</div></div></blockquote>
<p>Where <cite>a</cite> is the <code class="docutils literal"><span class="pre">gain_factor</span></code>, <cite>b</cite> is the <code class="docutils literal"><span class="pre">gain_offset</span></code> (the Gaussian
noise variance) and <cite>c</cite> the <code class="docutils literal"><span class="pre">correlation_factor</span></code>. The correlation
factor accounts for correlation of adjacent signal elements that can
be modelled as a convolution with a Gaussian point spread function.
<a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal.estimate_poissonian_noise_variance" title="hyperspy.signal.BaseSignal.estimate_poissonian_noise_variance"><code class="xref py py-meth docutils literal"><span class="pre">estimate_poissonian_noise_variance()</span></code></a> can be used to set
the noise properties when the variance can be described by this linear model,
for example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_poissonian_noise</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span>
<span class="go">├── General</span>
<span class="go">│   └── title =</span>
<span class="go">└── Signal</span>
<span class="go">    ├── binned = False</span>
<span class="go">    └── signal_type =</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">estimate_poissonian_noise_variance</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span>
<span class="go">├── General</span>
<span class="go">│   └── title =</span>
<span class="go">└── Signal</span>
<span class="go">    ├── Noise_properties</span>
<span class="go">    │   ├── Variance_linear_model</span>
<span class="go">    │   │   ├── correlation_factor = 1</span>
<span class="go">    │   │   ├── gain_factor = 1</span>
<span class="go">    │   │   └── gain_offset = 0</span>
<span class="go">    │   └── variance = &lt;SpectrumSimulation, title: Variance of , dimensions: (|100)&gt;</span>
<span class="go">    ├── binned = False</span>
<span class="go">    └── signal_type =</span>
</pre></div>
</div>
</div>
<div class="section" id="speeding-up-operations">
<h2>Speeding up operations<a class="headerlink" href="#speeding-up-operations" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0.</span></p>
</div>
<div class="section" id="reusing-a-signal-for-output">
<h3>Reusing a Signal for output<a class="headerlink" href="#reusing-a-signal-for-output" title="Permalink to this headline">¶</a></h3>
<p>Many signal methods create and return a new signal. For fast operations, the
new signal creation time is non-negligible. Also, when the operation is
repeated many times, for example in a loop, the cumulative creation time can
become significant. Therefore, many operations on
<a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> accept an optional argument <cite>out</cite>. If an
existing signal is passed to <cite>out</cite>, the function output will be placed into
that signal, instead of being returned in a new signal.  The following example
shows how to use this feature to slice a <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a>. It is
important to know that the <a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> instance passed in
the <cite>out</cite> argument must be well-suited for the purpose. Often this means that
it must have the same axes and data shape as the
<a class="reference internal" href="../api/hyperspy.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal"><span class="pre">BaseSignal</span></code></a> that would normally be returned by the
operation.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_sum</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_sum</span><span class="o">.</span><span class="n">data</span>
<span class="go">array(45)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">s_sum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_sum</span><span class="o">.</span><span class="n">data</span>
<span class="go">array(10)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_roi</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_roi</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">s_roi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_roi</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|5)&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="interactive-operations">
<span id="interactive-label"></span><h2>Interactive operations<a class="headerlink" href="#interactive-operations" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0.</span></p>
</div>
<p>The function <a class="reference internal" href="../api/hyperspy.html#hyperspy.interactive.interactive" title="hyperspy.interactive.interactive"><code class="xref py py-func docutils literal"><span class="pre">interactive()</span></code></a> ease the task of defining
operations that are automatically updated when an event is triggered. By
default it recomputes the operation when data or the axes of the original
signal changes.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">10.</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssum</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssum</span><span class="o">.</span><span class="n">data</span>
<span class="go">array(45.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span> <span class="o">/=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">data_changed</span><span class="o">.</span><span class="n">trigger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssum</span><span class="o">.</span><span class="n">data</span>
<span class="go">4.5</span>
</pre></div>
</div>
<p>The interactive operations can be chained.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssum</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssum_mean</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="n">ssum</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssum_mean</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([ 30.,  33.,  36.,  39.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([[[ 0,  1,  2,  3],</span>
<span class="go">        [ 4,  5,  6,  7],</span>
<span class="go">        [ 8,  9, 10, 11]],</span>

<span class="go">       [[12, 13, 14, 15],</span>
<span class="go">        [16, 17, 18, 19],</span>
<span class="go">        [20, 21, 22, 23]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span> <span class="o">*=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">data_changed</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssum_mean</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([ 300.,  330.,  360.,  390.])</span>
</pre></div>
</div>
</div>
<div class="section" id="region-of-interest-roi">
<span id="roi-label"></span><h2>Region Of Interest (ROI)<a class="headerlink" href="#region-of-interest-roi" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0.</span></p>
</div>
<p>A number of different ROIs are available:</p>
<ul class="simple">
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.roi.Point1DROI" title="hyperspy.roi.Point1DROI"><code class="xref py py-class docutils literal"><span class="pre">Point1DROI</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.roi.Point2DROI" title="hyperspy.roi.Point2DROI"><code class="xref py py-class docutils literal"><span class="pre">Point2DROI</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.roi.SpanROI" title="hyperspy.roi.SpanROI"><code class="xref py py-class docutils literal"><span class="pre">SpanROI</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.roi.RectangularROI" title="hyperspy.roi.RectangularROI"><code class="xref py py-class docutils literal"><span class="pre">RectangularROI</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.roi.CircleROI" title="hyperspy.roi.CircleROI"><code class="xref py py-class docutils literal"><span class="pre">CircleROI</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.html#hyperspy.roi.Line2DROI" title="hyperspy.roi.Line2DROI"><code class="xref py py-class docutils literal"><span class="pre">Line2DROI</span></code></a></li>
</ul>
<p>Once created, a ROI can be used to return a part of any compatible signal:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">roi</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">roi</span><span class="o">.</span><span class="n">RectangularROI</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span> <span class="o">=</span> <span class="n">roi</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span>
<span class="go">&lt;Signal1D, title: , dimensions: (4, 3|10)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imr</span> <span class="o">=</span> <span class="n">roi</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imr</span>
<span class="go">&lt;Signal2D, title: , dimensions: (|4, 3)&gt;</span>
</pre></div>
</div>
<p>ROIs can also be used <a class="reference internal" href="#interactive-label"><span>interactively</span></a> with widgets. The
following examples shows how to interactively apply ROIs to an image. Note
that <em>it is necessary</em> to plot the signal onto which the widgets will be
added before calling <a class="reference internal" href="../api/hyperspy.html#hyperspy.roi.BaseInteractiveROI.interactive" title="hyperspy.roi.BaseInteractiveROI.interactive"><code class="xref py py-meth docutils literal"><span class="pre">interactive()</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rectangular_roi</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">roi</span><span class="o">.</span><span class="n">RectangularROI</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line_roi</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">roi</span><span class="o">.</span><span class="n">Line2DROI</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point_roi</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">roi</span><span class="o">.</span><span class="n">Point2DROI</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">roi2D</span> <span class="o">=</span> <span class="n">rectangular_roi</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">roi1D</span> <span class="o">=</span> <span class="n">line_roi</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">roi0D</span> <span class="o">=</span> <span class="n">point_roi</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/image_with_rois.png"><img alt="../_images/image_with_rois.png" src="../_images/image_with_rois.png" style="width: 500px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/roi1d.png"><img alt="../_images/roi1d.png" src="../_images/roi1d.png" style="width: 500px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/roi2d.png"><img alt="../_images/roi2d.png" src="../_images/roi2d.png" style="width: 500px;" /></a>
</div>
<p>Notably,
since ROIs are independent from the signals they sub-select, the widget can be
plotted on a different signal altogether.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">roi</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">roi</span><span class="o">.</span><span class="n">RectangularROI</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">77</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># plot signal to have where to display the widget</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imr</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">navigation_signal</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">roi</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>ROIs are implemented in terms of physical coordinates and not pixels, so with
proper calibration will always point to the same region.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/random_image_with_rect_roi.png"><img alt="../_images/random_image_with_rect_roi.png" src="../_images/random_image_with_rect_roi.png" style="width: 500px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/random_image_with_rect_roi_spectrum.png"><img alt="../_images/random_image_with_rect_roi_spectrum.png" src="../_images/random_image_with_rect_roi_spectrum.png" style="width: 500px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/roi2d.png"><img alt="../_images/roi2d.png" src="../_images/roi2d.png" style="width: 500px;" /></a>
</div>
<p>And of course, as all interactive operations, interactive ROIs are chainable.
The following example shows how to display interactively the histogram of a
rectangular ROI. Notice how we customise the default event connections in
order to increase responsiveness.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">roi</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">roi</span><span class="o">.</span><span class="n">RectangularROI</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im_roi</span> <span class="o">=</span> <span class="n">roi</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">roi_hist</span> <span class="o">=</span><span class="n">hs</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="n">im_roi</span><span class="o">.</span><span class="n">get_histogram</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">im_roi</span><span class="o">.</span><span class="n">axes_manager</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">any_axis_changed</span><span class="p">,</span> <span class="n">recompute_out_event</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">roi_hist</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/image_with_rect_roi.png"><img alt="../_images/image_with_rect_roi.png" src="../_images/image_with_rect_roi.png" style="width: 500px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/roi_hist.png"><img alt="../_images/roi_hist.png" src="../_images/roi_hist.png" style="width: 500px;" /></a>
</div>
</div>
<div class="section" id="handling-complex-data">
<span id="complex-data-label"></span><h2>Handling complex data<a class="headerlink" href="#handling-complex-data" title="Permalink to this headline">¶</a></h2>
<p>The HyperSpy <code class="xref py py-class docutils literal"><span class="pre">ComplexSignal</span></code> signal class and its subclasses
for 1-dimensional and 2-dimensional data allow the user to access complex properties like the
<cite>real</cite> and <cite>imag</cite> parts of the data or the <cite>amplitude</cite> (also known as the modulus) and <cite>phase</cite>
(also known as angle or argument) directly. Getting and setting those properties can be done
as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">real</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">real</span>      <span class="c1"># real is a new HyperSpy signal accessing the same data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">real</span> <span class="o">=</span> <span class="n">new_real</span>  <span class="c1"># new_real can be an array or signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imag</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">imag</span>      <span class="c1"># imag  is a new HyperSpy signal accessing the same data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">imag</span> <span class="o">=</span> <span class="n">new_imag</span>  <span class="c1"># new_imag can be an array or signal</span>
</pre></div>
</div>
<p>It is important to note that <cite>data</cite> passed to the constructor of a
<a class="reference internal" href="../api/hyperspy._signals.html#hyperspy._signals.complex_signal.ComplexSignal" title="hyperspy._signals.complex_signal.ComplexSignal"><code class="xref py py-class docutils literal"><span class="pre">ComplexSignal</span></code></a> (or to a subclass), which is not already
complex, will be converted to the numpy standard of <cite>np.complex</cite>/<cite>np.complex128</cite>. <cite>data</cite> which
is already complex will be passed as is.</p>
<p>To transform a real signal into a complex one use:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
</pre></div>
</div>
<p>Changing the <cite>dtype</cite> of a complex signal to something real is not clearly defined and thus not
directly possible. Use the <cite>real</cite>, <cite>imag</cite>, <cite>amplitude</cite> or <cite>phase</cite> properties instead to extract
the real data that is desired.</p>
<div class="section" id="calculate-the-angle-phase-argument">
<h3>Calculate the angle / phase / argument<a class="headerlink" href="#calculate-the-angle-phase-argument" title="Permalink to this headline">¶</a></h3>
<p>The <code class="xref py py-func docutils literal"><span class="pre">angle()</span></code> function can be used to calculate the
angle, which is equivalent to using the <cite>phase</cite> property if no argument is used. If the data is
real, the angle will be 0 for positive values and 2$pi$ for negative values. If the <cite>deg</cite>
parameter is set to <cite>True</cite>, the result will be given in degrees, otherwise in rad (default).
The underlying function is the <code class="xref py py-func docutils literal"><span class="pre">angle()</span></code> function.
<code class="xref py py-func docutils literal"><span class="pre">angle()</span></code> will return an appropriate HyperSpy signal.</p>
</div>
<div class="section" id="phase-unwrapping">
<h3>Phase unwrapping<a class="headerlink" href="#phase-unwrapping" title="Permalink to this headline">¶</a></h3>
<p>With the <code class="xref py py-func docutils literal"><span class="pre">unwrapped_phase()</span></code> method the complex phase
of a signal can be unwrapped and returned as a new signal. The underlying method is
<code class="xref py py-func docutils literal"><span class="pre">unwrap()</span></code>, which uses the algorithm described in:
Miguel Arevallilo Herraez, David R. Burton, Michael J. Lalor, and Munther A. Gdeisat,
“Fast two-dimensional phase-unwrapping algorithm based on sorting by reliability following
a noncontinuous path”, Journal Applied Optics, Vol. 41, No. 35, pp. 7437, 2002.
(doi: 10.1364/AO.41.007437).</p>
</div>
<div class="section" id="add-a-linear-phase-ramp">
<h3>Add a linear phase ramp<a class="headerlink" href="#add-a-linear-phase-ramp" title="Permalink to this headline">¶</a></h3>
<p>For 2-dimensional complex images, a linear phase ramp can be added to the signal via the
<code class="xref py py-func docutils literal"><span class="pre">add_phase_ramp()</span></code> method. The parameters
<cite>ramp_x</cite> and <cite>ramp_y</cite> dictate the slope of the ramp in <cite>x</cite>- and <cite>y</cite> direction, while the offset
is determined by the <cite>offset</cite> parameter. The fulcrum of the linear ramp is at the origin
and the slopes are given in units of the axis with the according scale taken into account.
Both are available via the <a class="reference internal" href="../api/hyperspy.html#hyperspy.axes.AxesManager" title="hyperspy.axes.AxesManager"><code class="xref py py-class docutils literal"><span class="pre">AxesManager</span></code></a> of the signal.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="signal1d.html" class="btn btn-neutral float-right" title="Signal1D Tools" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="getting_started.html" class="btn btn-neutral" title="Getting started" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2011-2016, The HyperSpy development team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.2+dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/copybutton.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>