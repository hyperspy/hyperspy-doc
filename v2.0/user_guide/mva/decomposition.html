
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../../_static/hyperspy.ico" rel="icon" type="image/x-icon">
    <title>Decomposition &#8212; HyperSpy 2.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom-styles.css?v=eff58afb" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script src="../../_static/documentation_options.js?v=60dbed4a"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=ccdb6887"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/mva/decomposition';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.14.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://hyperspy.org/hyperspy-doc/dev/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '2.0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Blind Source Separation" href="bss.html" />
    <link rel="prev" title="Machine learning" href="index.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-25260850-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>


  <div class="bd-header-announcement container-fluid bd-header-announcement">
    <div class="bd-header-announcement__content">HyperSpy API is changing in version 2.0, see the <a href='https://hyperspy.org/hyperspy-doc/current/changes.html'>release notes!</a></div>
  </div>

  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/hyperspy_logo.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../../_static/hyperspy_logo.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">HyperSpy</p>
  
</a></div>
    
      <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../auto_examples/index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../reference/index.html">
                        Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../help.html">
                        Get Help
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../changes.html">
                        Release Notes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../dev_guide/index.html">
                        Contribute
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://github.com/hyperspy/hyperspy-demos">
                    Tutorial
                  </a>
                </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/hyperspy/hyperspy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://gitter.im/hyperspy/hyperspy" title="Gitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-gitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Gitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://hyperspy.org" title="HyperSpy" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/hyperspy.ico" class="icon-link-image" alt="HyperSpy"/></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../auto_examples/index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../reference/index.html">
                        Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../help.html">
                        Get Help
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../changes.html">
                        Release Notes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../dev_guide/index.html">
                        Contribute
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://github.com/hyperspy/hyperspy-demos">
                    Tutorial
                  </a>
                </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/hyperspy/hyperspy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://gitter.im/hyperspy/hyperspy" title="Gitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-gitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Gitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://hyperspy.org" title="HyperSpy" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/hyperspy.ico" class="icon-link-image" alt="HyperSpy"/></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing HyperSpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic_usage.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io.html">Loading and saving data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fundamentals and Usage</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../signal/index.html">The Signal class</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../signal/signal_basics.html">Basics of signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signal/ragged.html">Ragged signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signal/binned_signals.html">Binned and unbinned signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signal/indexing.html">Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signal/generic_tools.html">Generic tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signal/basic_statistical_analysis.html">Basic statistical analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signal/setting_noise_properties.html">Setting the noise properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signal/speeding_up_operation.html">Speeding up operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signal/complex_datatype.html">Complex datatype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signal/gpu.html">GPU support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../axes.html">Axes handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../signal1d.html">Signal1D Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../signal2d.html">Signal2D Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualisation.html">Data visualization</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Machine learning</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="bss.html">Blind Source Separation</a></li>
<li class="toctree-l2"><a class="reference internal" href="clustering.html">Cluster analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualize_results.html">Visualizing results</a></li>
<li class="toctree-l2"><a class="reference internal" href="export_results.html">Export results</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../model/index.html">Model fitting</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../model/creating_model.html">Creating a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/model_components.html">Model components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/adding_components.html">Adding components to the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/indexing_model.html">Indexing the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/model_parameters.html">Getting and setting parameter values and attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/fitting_model.html">Fitting the model to the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/storing_models.html">Storing models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/fitting_big_data.html">Fitting big data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/SAMFire.html">Smart Adaptive Multi-dimensional Fitting (SAMFire)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../big_data.html">Working with big data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Usage</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../region_of_interest.html">Region Of Interest (ROI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../events.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interactive_operations.html">Interactive Operations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Machine learning</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Decomposition</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="decomposition">
<span id="mva-decomposition"></span><h1>Decomposition<a class="headerlink" href="#decomposition" title="Link to this heading">#</a></h1>
<p>Decomposition techniques are most commonly used as a means of noise
reduction (or <cite>denoising</cite>) and dimensionality reduction. To apply a
decomposition to your dataset, run the <a class="reference internal" href="../../reference/api.signals/BaseSignal.html#hyperspy.api.signals.BaseSignal.decomposition" title="hyperspy.api.signals.BaseSignal.decomposition"><code class="xref py py-meth docutils literal notranslate"><span class="pre">decomposition()</span></code></a>
method, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span>
<span class="go">Decomposition info:</span>
<span class="go">   normalize_poissonian_noise=False</span>
<span class="go">   algorithm=SVD</span>
<span class="go">   output_dimension=None</span>
<span class="go">   centre=None</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load data from a file, then decompose</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my_file.hspy&quot;</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span> 
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The signal <code class="docutils literal notranslate"><span class="pre">s</span></code> must be multi-dimensional, <em>i.e.</em>
<code class="docutils literal notranslate"><span class="pre">s.axes_manager.navigation_size</span> <span class="pre">&gt;</span> <span class="pre">1</span></code></p>
</div>
<p>One of the most popular uses of <a class="reference internal" href="../../reference/api.signals/BaseSignal.html#hyperspy.api.signals.BaseSignal.decomposition" title="hyperspy.api.signals.BaseSignal.decomposition"><code class="xref py py-meth docutils literal notranslate"><span class="pre">decomposition()</span></code></a>
is data denoising. This is achieved by using a limited set of components
to make a model of the original dataset, omitting the less significant components that
ideally contain only noise.</p>
<p>To reconstruct your denoised or reduced model, run the
<a class="reference internal" href="../../reference/api.signals/BaseSignal.html#hyperspy.api.signals.BaseSignal.get_decomposition_model" title="hyperspy.api.signals.BaseSignal.get_decomposition_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_decomposition_model()</span></code></a> method. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use all components to reconstruct the model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_decomposition_model</span><span class="p">()</span> 

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use first 3 components to reconstruct the model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_decomposition_model</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> 

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use components [0, 2] to reconstruct the model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_decomposition_model</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> 
</pre></div>
</div>
<p>Sometimes, it is useful to examine the residuals between your original data and
the decomposition model. You can easily calculate and display the residuals,
since <a class="reference internal" href="../../reference/api.signals/BaseSignal.html#hyperspy.api.signals.BaseSignal.get_decomposition_model" title="hyperspy.api.signals.BaseSignal.get_decomposition_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_decomposition_model()</span></code></a> returns a new
object, which in the example above we have called <code class="docutils literal notranslate"><span class="pre">sc</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">sc</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> 
</pre></div>
</div>
<p>You can perform operations on this new object <code class="docutils literal notranslate"><span class="pre">sc</span></code> later.
It is a copy of the original <code class="docutils literal notranslate"><span class="pre">s</span></code> object, except that the data has
been replaced by the model constructed using the chosen components.</p>
<p>If you provide the <code class="docutils literal notranslate"><span class="pre">output_dimension</span></code> argument, which takes an integer value,
the decomposition algorithm attempts to find the best approximation for the
dataset <span class="math notranslate nohighlight">\(X\)</span> with only a limited set of factors <span class="math notranslate nohighlight">\(A\)</span> and loadings <span class="math notranslate nohighlight">\(B\)</span>,
such that <span class="math notranslate nohighlight">\(X \approx A B^T\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">output_dimension</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> 
</pre></div>
</div>
<p>Some of the algorithms described below require <code class="docutils literal notranslate"><span class="pre">output_dimension</span></code> to be provided.</p>
<section id="available-algorithms">
<h2>Available algorithms<a class="headerlink" href="#available-algorithms" title="Link to this heading">#</a></h2>
<p>HyperSpy implements a number of decomposition algorithms via the <code class="docutils literal notranslate"><span class="pre">algorithm</span></code> argument.
The table below lists the algorithms that are currently available, and includes
links to the appropriate documentation for more information on each one.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Choosing which algorithm to use is likely to depend heavily on the nature of your
dataset and the type of analysis you are trying to perform. We discuss some of the
reasons for choosing one algorithm over another below, but would encourage you to
do your own research as well. The <a class="reference external" href="https://scikit-learn.org/stable/modules/decomposition.html">scikit-learn documentation</a> is a
very good starting point.</p>
</div>
<span id="decomposition-table"></span><table class="table" id="id1">
<caption><span class="caption-text">Available decomposition algorithms in HyperSpy</span><a class="headerlink" href="#id1" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Algorithm</p></th>
<th class="head"><p>Method</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>“SVD” (default)</p></td>
<td><p><a class="reference internal" href="../../reference/base_classes/machine_learning.html#hyperspy.learn.svd_pca.svd_pca" title="hyperspy.learn.svd_pca.svd_pca"><code class="xref py py-func docutils literal notranslate"><span class="pre">svd_pca()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>“MLPCA”</p></td>
<td><p><a class="reference internal" href="../../reference/base_classes/machine_learning.html#hyperspy.learn.mlpca.mlpca" title="hyperspy.learn.mlpca.mlpca"><code class="xref py py-func docutils literal notranslate"><span class="pre">mlpca()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>“sklearn_pca”</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html#sklearn.decomposition.PCA" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.decomposition.PCA</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>“NMF”</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.NMF.html#sklearn.decomposition.NMF" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.decomposition.NMF</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>“sparse_pca”</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.SparsePCA.html#sklearn.decomposition.SparsePCA" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.decomposition.SparsePCA</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>“mini_batch_sparse_pca”</p></td>
<td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.MiniBatchSparsePCA.html#sklearn.decomposition.MiniBatchSparsePCA" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.decomposition.MiniBatchSparsePCA</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>“RPCA”</p></td>
<td><p><a class="reference internal" href="../../reference/base_classes/machine_learning.html#hyperspy.learn.rpca.rpca_godec" title="hyperspy.learn.rpca.rpca_godec"><code class="xref py py-func docutils literal notranslate"><span class="pre">rpca_godec()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>“ORPCA”</p></td>
<td><p><a class="reference internal" href="../../reference/base_classes/machine_learning.html#hyperspy.learn.rpca.ORPCA" title="hyperspy.learn.rpca.ORPCA"><code class="xref py py-class docutils literal notranslate"><span class="pre">ORPCA</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>“ORNMF”</p></td>
<td><p><a class="reference internal" href="../../reference/base_classes/machine_learning.html#hyperspy.learn.ornmf.ORNMF" title="hyperspy.learn.ornmf.ORNMF"><code class="xref py py-class docutils literal notranslate"><span class="pre">ORNMF</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>custom object</p></td>
<td><p>An object implementing  <code class="docutils literal notranslate"><span class="pre">fit()</span></code> and  <code class="docutils literal notranslate"><span class="pre">transform()</span></code> methods</p></td>
</tr>
</tbody>
</table>
</section>
<section id="singular-value-decomposition-svd">
<span id="mva-svd"></span><h2>Singular value decomposition (SVD)<a class="headerlink" href="#singular-value-decomposition-svd" title="Link to this heading">#</a></h2>
<p>The default algorithm in HyperSpy is <code class="docutils literal notranslate"><span class="pre">&quot;SVD&quot;</span></code>, which uses an approach called
“singular value decomposition” to decompose the data in the form
<span class="math notranslate nohighlight">\(X = U \Sigma V^T\)</span>. The factors are given by <span class="math notranslate nohighlight">\(U \Sigma\)</span>, and the
loadings are given by <span class="math notranslate nohighlight">\(V^T\)</span>. For more information, please read the method
documentation for <a class="reference internal" href="../../reference/base_classes/machine_learning.html#hyperspy.learn.svd_pca.svd_pca" title="hyperspy.learn.svd_pca.svd_pca"><code class="xref py py-func docutils literal notranslate"><span class="pre">svd_pca()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span>
<span class="go"> Decomposition info:</span>
<span class="go">   normalize_poissonian_noise=False</span>
<span class="go">   algorithm=SVD</span>
<span class="go">   output_dimension=None</span>
<span class="go">   centre=None</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In some fields, including electron microscopy, this approach of applying an SVD
directly to the data <span class="math notranslate nohighlight">\(X\)</span> is often called PCA <a class="reference internal" href="#mva-pca"><span class="std std-ref">(see below)</span></a>.</p>
<p>However, in the classical definition of PCA, the SVD should be applied to data that has
first been “centered” by subtracting the mean, i.e. <span class="math notranslate nohighlight">\(\mathrm{SVD}(X - \bar X)\)</span>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&quot;SVD&quot;</span></code> algorithm in HyperSpy <strong>does not</strong> apply this
centering step by default. As a result, you may observe differences between
the output of the <code class="docutils literal notranslate"><span class="pre">&quot;SVD&quot;</span></code> algorithm and, for example,
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html#sklearn.decomposition.PCA" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.decomposition.PCA</span></code></a>, which <strong>does</strong> apply centering.</p>
</div>
</section>
<section id="principal-component-analysis-pca">
<span id="mva-pca"></span><h2>Principal component analysis (PCA)<a class="headerlink" href="#principal-component-analysis-pca" title="Link to this heading">#</a></h2>
<p>One of the most popular decomposition methods is <a class="reference external" href="https://en.wikipedia.org/wiki/Principal_component_analysis">principal component analysis</a> (PCA).
To perform PCA on your dataset, run the <a class="reference internal" href="../../reference/api.signals/BaseSignal.html#hyperspy.api.signals.BaseSignal.decomposition" title="hyperspy.api.signals.BaseSignal.decomposition"><code class="xref py py-meth docutils literal notranslate"><span class="pre">decomposition()</span></code></a>
method with any of following arguments.</p>
<p>If you have <a class="reference external" href="https://scikit-learn.org/">scikit-learn</a> installed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;sklearn_pca&quot;</span><span class="p">)</span>
<span class="go"> Decomposition info:</span>
<span class="go">   normalize_poissonian_noise=False</span>
<span class="go">   algorithm=sklearn_pca</span>
<span class="go">   output_dimension=None</span>
<span class="go">   centre=None</span>
<span class="go"> scikit-learn estimator:</span>
<span class="go"> PCA()</span>
</pre></div>
</div>
<p>You can also turn on centering with the default <code class="docutils literal notranslate"><span class="pre">&quot;SVD&quot;</span></code> algorithm via
the <code class="docutils literal notranslate"><span class="pre">&quot;centre&quot;</span></code> argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Subtract the mean along the navigation axis</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;SVD&quot;</span><span class="p">,</span> <span class="n">centre</span><span class="o">=</span><span class="s2">&quot;navigation&quot;</span><span class="p">)</span>
 <span class="n">Decomposition</span> <span class="n">info</span><span class="p">:</span>
   <span class="n">normalize_poissonian_noise</span><span class="o">=</span><span class="kc">False</span>
   <span class="n">algorithm</span><span class="o">=</span><span class="n">SVD</span>
   <span class="n">output_dimension</span><span class="o">=</span><span class="kc">None</span>
   <span class="n">centre</span><span class="o">=</span><span class="n">navigation</span>

<span class="c1"># Subtract the mean along the signal axis</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;SVD&quot;</span><span class="p">,</span> <span class="n">centre</span><span class="o">=</span><span class="s2">&quot;signal&quot;</span><span class="p">)</span>
 <span class="n">Decomposition</span> <span class="n">info</span><span class="p">:</span>
   <span class="n">normalize_poissonian_noise</span><span class="o">=</span><span class="kc">False</span>
   <span class="n">algorithm</span><span class="o">=</span><span class="n">SVD</span>
   <span class="n">output_dimension</span><span class="o">=</span><span class="kc">None</span>
   <span class="n">centre</span><span class="o">=</span><span class="n">signal</span>
</pre></div>
</div>
<p>You can also use <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html#sklearn.decomposition.PCA" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.decomposition.PCA</span></code></a> directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">PCA</span><span class="p">())</span>
<span class="go"> Decomposition info:</span>
<span class="go">   normalize_poissonian_noise=False</span>
<span class="go">   algorithm=PCA()</span>
<span class="go">   output_dimension=None</span>
<span class="go">   centre=None</span>
<span class="go"> scikit-learn estimator:</span>
<span class="go"> PCA()</span>
</pre></div>
</div>
</section>
<section id="poissonian-noise">
<span id="poissonian-noise-label"></span><h2>Poissonian noise<a class="headerlink" href="#poissonian-noise" title="Link to this heading">#</a></h2>
<p>Most of the standard decomposition algorithms assume that the noise of the data
follows a Gaussian distribution (also known as “homoskedastic noise”).
In cases where your data is instead corrupted by Poisson noise, HyperSpy
can “normalize” the data by performing a scaling operation, which can greatly
enhance the result. More details about the normalization procedure can be
found in <a class="reference internal" href="../bibliography.html#keenan2004"><span class="std std-ref">[Keenan2004]</span></a>.</p>
<p>To apply Poissonian noise normalization to your data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">normalize_poissonian_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Because it is the first argument we could have simply written:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Poisson noise normalization cannot be used in combination with data
centering using the <code class="docutils literal notranslate"><span class="pre">'centre'</span></code> argument. Attempting to do so will
raise an error.</p>
</div>
</section>
<section id="maximum-likelihood-principal-component-analysis-mlpca">
<span id="mva-mlpca"></span><h2>Maximum likelihood principal component analysis (MLPCA)<a class="headerlink" href="#maximum-likelihood-principal-component-analysis-mlpca" title="Link to this heading">#</a></h2>
<p>Instead of applying Poisson noise normalization to your data, you can instead
use an approach known as Maximum Likelihood PCA (MLPCA), which provides a more
robust statistical treatment of non-Gaussian “heteroskedastic noise”.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;MLPCA&quot;</span><span class="p">)</span> 
</pre></div>
</div>
<p>For more information, please read the method documentation for <a class="reference internal" href="../../reference/base_classes/machine_learning.html#hyperspy.learn.mlpca.mlpca" title="hyperspy.learn.mlpca.mlpca"><code class="xref py py-func docutils literal notranslate"><span class="pre">mlpca()</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must set the <code class="docutils literal notranslate"><span class="pre">output_dimension</span></code> when using MLPCA.</p>
</div>
</section>
<section id="robust-principal-component-analysis-rpca">
<span id="mva-rpca"></span><h2>Robust principal component analysis (RPCA)<a class="headerlink" href="#robust-principal-component-analysis-rpca" title="Link to this heading">#</a></h2>
<p>PCA is known to be very sensitive to the presence of outliers in data. These
outliers can be the result of missing or dead pixels, X-ray spikes, or very
low count data. If one assumes a dataset, <span class="math notranslate nohighlight">\(X\)</span>, to consist of a low-rank
component <span class="math notranslate nohighlight">\(L\)</span> corrupted by a sparse error component <span class="math notranslate nohighlight">\(S\)</span>, such that
<span class="math notranslate nohighlight">\(X=L+S\)</span>, then Robust PCA (RPCA) can be used to recover the low-rank
component for subsequent processing <a class="reference internal" href="../bibliography.html#candes2011"><span class="std std-ref">[Candes2011]</span></a>.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../../_images/rpca_schematic.png"><img alt="../../_images/rpca_schematic.png" src="../../_images/rpca_schematic.png" style="width: 425px;" /></a>
<figcaption>
<p><span class="caption-text">Schematic diagram of the robust PCA problem, which combines a low-rank matrix
with sparse errors. Robust PCA aims to decompose the matrix back into these two
components.</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must set the <code class="docutils literal notranslate"><span class="pre">output_dimension</span></code> when using Robust PCA.</p>
</div>
<p>The default RPCA algorithm is GoDec <a class="reference internal" href="../bibliography.html#zhou2011"><span class="std std-ref">[Zhou2011]</span></a>. In HyperSpy
it returns the factors and loadings of <span class="math notranslate nohighlight">\(L\)</span>. RPCA solvers work by using
regularization, in a similar manner to lasso or ridge regression, to enforce
the low-rank constraint on the data. The low-rank regularization parameter,
<code class="docutils literal notranslate"><span class="pre">lambda1</span></code>, defaults to <code class="docutils literal notranslate"><span class="pre">1/sqrt(n_features)</span></code>, but it is strongly recommended
that you explore the behaviour of different values.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;RPCA&quot;</span><span class="p">,</span> <span class="n">output_dimension</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lambda1</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go"> Decomposition info:</span>
<span class="go">   normalize_poissonian_noise=False</span>
<span class="go">   algorithm=RPCA</span>
<span class="go">   output_dimension=3</span>
<span class="go">   centre=None</span>
</pre></div>
</div>
<p>HyperSpy also implements an <em>online</em> algorithm for RPCA developed by Feng et
al. <a class="reference internal" href="../bibliography.html#feng2013"><span class="std std-ref">[Feng2013]</span></a>. This minimizes memory usage, making it
suitable for large datasets, and can often be faster than the default
algorithm.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;ORPCA&quot;</span><span class="p">,</span> <span class="n">output_dimension</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> 
</pre></div>
</div>
<p>The online RPCA implementation sets several default parameters that are
usually suitable for most datasets, including the regularization parameter
highlighted above. Again, it is strongly recommended that you explore the
behaviour of these parameters. To further improve the convergence, you can
“train” the algorithm with the first few samples of your dataset. For example,
the following code will train ORPCA using the first 32 samples of the data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;ORPCA&quot;</span><span class="p">,</span> <span class="n">output_dimension</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">training_samples</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span> 
</pre></div>
</div>
<p>Finally, online RPCA includes two alternatives methods to the default
block-coordinate descent solver, which can again improve both the convergence
and speed of the algorithm. These are particularly useful for very large datasets.</p>
<p>The methods are based on stochastic gradient descent (SGD), and take an
additional parameter to set the learning rate. The learning rate dictates
the size of the steps taken by the gradient descent algorithm, and setting
it too large can lead to oscillations that prevent the algorithm from
finding the correct minima. Usually a value between 1 and 2 works well:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;ORPCA&quot;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">output_dimension</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;SGD&quot;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">subspace_learning_rate</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span> 
</pre></div>
</div>
<p>You can also use Momentum Stochastic Gradient Descent (MomentumSGD),
which typically improves the convergence properties of stochastic gradient
descent. This takes the further parameter <code class="docutils literal notranslate"><span class="pre">subspace_momentum</span></code>, which should
be a fraction between 0 and 1.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;ORPCA&quot;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">output_dimension</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;MomentumSGD&quot;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">subspace_learning_rate</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">subspace_momentum</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> 
</pre></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">&quot;SGD&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;MomentumSGD&quot;</span></code> methods enables the subspace,
i.e. the underlying low-rank component, to be tracked as it changes
with each sample update. The default method instead assumes a fixed,
static subspace.</p>
</section>
<section id="non-negative-matrix-factorization-nmf">
<span id="mva-nmf"></span><h2>Non-negative matrix factorization (NMF)<a class="headerlink" href="#non-negative-matrix-factorization-nmf" title="Link to this heading">#</a></h2>
<p>Another popular decomposition method is non-negative matrix factorization
(NMF), which can be accessed in HyperSpy with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;NMF&quot;</span><span class="p">)</span> 
</pre></div>
</div>
<p>Unlike PCA, NMF forces the components to be strictly non-negative, which can
aid the physical interpretation of components for count data such as images,
EELS or EDS. For an example of NMF in EELS processing, see
<a class="reference internal" href="../bibliography.html#nicoletti2013"><span class="std std-ref">[Nicoletti2013]</span></a>.</p>
<p>NMF takes the optional argument <code class="docutils literal notranslate"><span class="pre">output_dimension</span></code>, which determines the number
of components to keep. Setting this to a small number is recommended to keep
the computation time small. Often it is useful to run a PCA decomposition first
and use the <a class="reference internal" href="visualize_results.html#mva-scree-plot"><span class="std std-ref">scree plot</span></a> to determine a suitable value
for <code class="docutils literal notranslate"><span class="pre">output_dimension</span></code>.</p>
</section>
<section id="robust-non-negative-matrix-factorization-rnmf">
<span id="mva-rnmf"></span><h2>Robust non-negative matrix factorization (RNMF)<a class="headerlink" href="#robust-non-negative-matrix-factorization-rnmf" title="Link to this heading">#</a></h2>
<p>In a similar manner to the online, robust methods that complement PCA
<a class="reference internal" href="#mva-rpca"><span class="std std-ref">above</span></a>, HyperSpy includes an online robust NMF method.
This is based on the OPGD (Online Proximal Gradient Descent) algorithm
of <a class="reference internal" href="../bibliography.html#zhao2016"><span class="std std-ref">[Zhao2016]</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must set the <code class="docutils literal notranslate"><span class="pre">output_dimension</span></code> when using Robust NMF.</p>
</div>
<p>As before, you can control the regularization applied via the parameter “lambda1”:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;ORNMF&quot;</span><span class="p">,</span> <span class="n">output_dimension</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lambda1</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> 
</pre></div>
</div>
<p>The MomentumSGD method  is useful for scenarios where the subspace, i.e. the
underlying low-rank component, is changing over time.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;ORNMF&quot;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">output_dimension</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;MomentumSGD&quot;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">subspace_learning_rate</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">subspace_momentum</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> 
</pre></div>
</div>
<p>Both the default and MomentumSGD solvers assume an <em>l2</em>-norm minimization problem,
which can still be sensitive to <em>very</em> heavily corrupted data. A more robust
alternative is available, although it is typically much slower.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;ORNMF&quot;</span><span class="p">,</span> <span class="n">output_dimension</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;RobustPGD&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</section>
<section id="custom-decomposition-algorithms">
<span id="mva-custom-decomposition"></span><h2>Custom decomposition algorithms<a class="headerlink" href="#custom-decomposition-algorithms" title="Link to this heading">#</a></h2>
<p>HyperSpy supports passing a custom decomposition algorithm, provided it follows the form of a
<a class="reference external" href="https://scikit-learn.org/stable/developers/develop.html">scikit-learn estimator</a>.
Any object that implements <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> methods is acceptable, including
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.pipeline.Pipeline</span></code></a> and <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.model_selection.GridSearchCV</span></code></a>.
You can access the fitted estimator by passing <code class="docutils literal notranslate"><span class="pre">return_info=True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Passing a custom decomposition algorithm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s2">&quot;scaler&quot;</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s2">&quot;PCA&quot;</span><span class="p">,</span> <span class="n">PCA</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">pipe</span><span class="p">,</span> <span class="n">return_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go"> Decomposition info:</span>
<span class="go">   normalize_poissonian_noise=False</span>
<span class="go">   algorithm=Pipeline(steps=[(&#39;scaler&#39;, MinMaxScaler()), (&#39;PCA&#39;, PCA())])</span>
<span class="go">   output_dimension=None</span>
<span class="go">   centre=None</span>
<span class="go"> scikit-learn estimator:</span>
<span class="go"> Pipeline(steps=[(&#39;scaler&#39;, MinMaxScaler()), (&#39;PCA&#39;, PCA())])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span>
<span class="go">Pipeline(steps=[(&#39;scaler&#39;, MinMaxScaler()), (&#39;PCA&#39;, PCA())])</span>
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Machine learning</p>
      </div>
    </a>
    <a class="right-next"
       href="bss.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Blind Source Separation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#available-algorithms">Available algorithms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#singular-value-decomposition-svd">Singular value decomposition (SVD)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-component-analysis-pca">Principal component analysis (PCA)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#poissonian-noise">Poissonian noise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-likelihood-principal-component-analysis-mlpca">Maximum likelihood principal component analysis (MLPCA)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#robust-principal-component-analysis-rpca">Robust principal component analysis (RPCA)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-negative-matrix-factorization-nmf">Non-negative matrix factorization (NMF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#robust-non-negative-matrix-factorization-rnmf">Robust non-negative matrix factorization (RNMF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-decomposition-algorithms">Custom decomposition algorithms</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/user_guide/mva/decomposition.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2011-2023, The HyperSpy development team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>