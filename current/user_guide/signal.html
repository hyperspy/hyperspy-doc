<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Signal class &mdash; HyperSpy 1.7.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/hyperspy.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/toggleprompt.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Axes handling" href="axes.html" />
    <link rel="prev" title="Getting started" href="getting_started.html" />
 
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-25260850-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> HyperSpy
            <img src="../_static/hyperspy_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.7.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing HyperSpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Signal class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-signal-class-and-its-subclasses">The Signal class and its subclasses</a></li>
<li class="toctree-l2"><a class="reference internal" href="#signal-initialization">Signal initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-navigation-and-signal-dimensions">The navigation and signal dimensions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#transforming-between-signal-subclasses">Transforming between signal subclasses</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ragged-array">Ragged array</a></li>
<li class="toctree-l2"><a class="reference internal" href="#binned-and-unbinned-signals">Binned and unbinned signals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#integration-of-binned-signals">Integration of binned signals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#generic-tools">Generic tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mathematical-operations">Mathematical operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#indexing">Indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#signal-operations">Signal operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iterating-over-the-navigation-axes">Iterating over the navigation axes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iterating-external-functions-with-the-map-method">Iterating external functions with the map method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cropping">Cropping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rebinning">Rebinning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#squeezing">Squeezing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#folding-and-unfolding">Folding and unfolding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#splitting-and-stacking">Splitting and stacking</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fast-fourier-transform-fft">Fast Fourier Transform (FFT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inverse-fast-fourier-transform-ifft">Inverse Fast Fourier Transform (iFFT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changing-the-data-type">Changing the data type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transposing-changing-signal-spaces">Transposing (changing signal spaces)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#applying-apodization-window">Applying apodization window</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#basic-statistical-analysis">Basic statistical analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-the-noise-properties">Setting the noise properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#speeding-up-operations">Speeding up operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reusing-a-signal-for-output">Reusing a Signal for output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#handling-complex-data">Handling complex data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#calculate-the-angle-phase-argument">Calculate the angle / phase / argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="#phase-unwrapping">Phase unwrapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculate-and-display-argand-diagram">Calculate and display Argand diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-a-linear-phase-ramp">Add a linear phase ramp</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gpu-support">GPU support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="axes.html">Axes handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive_operations_ROIs.html">Interactive Operations and Region of Interest (ROI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="signal1d.html">Signal1D Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="signal2d.html">Signal2D Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualisation.html">Data visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="mva.html">Machine learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Model fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="eels.html">Electron Energy Loss Spectroscopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="eds.html">Energy-Dispersive X-ray Spectrometry (EDS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="dielectric_function.html">Dielectric function tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="electron_holography.html">Electron Holography</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">Loading and saving data</a></li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="big_data.html">Working with big data</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata_structure.html">Metadata structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/git.html">Using Git and GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/testing.html">Running and writing tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/writing_docs.html">Writing documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/coding_style.html">Coding style</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/lazy_computations.html">Tips for writing methods that work on lazy signals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/speeding_up_code.html">Speeding up code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/writing_extensions.html">Writing packages that extend HyperSpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/useful_information.html">Useful information</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">hyperspy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Credits and citation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing HyperSpy</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HyperSpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>The Signal class</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user_guide/signal.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="the-signal-class">
<h1>The Signal class<a class="headerlink" href="#the-signal-class" title="Permalink to this headline"></a></h1>
<section id="the-signal-class-and-its-subclasses">
<h2>The Signal class and its subclasses<a class="headerlink" href="#the-signal-class-and-its-subclasses" title="Permalink to this headline"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This subsection can be a bit confusing for beginners.
Do not worry if you do not understand it all.</p>
</div>
<p>HyperSpy stores the data in the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> class, that is
the object that you get when e.g. you load a single file using
<a class="reference internal" href="../api/hyperspy.io.html#hyperspy.io.load" title="hyperspy.io.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a>. Most of the data analysis functions are also contained in
this class or its specialized subclasses. The <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a>
class contains general functionality that is available to all the subclasses.
The subclasses provide functionality that is normally specific to a particular
type of data, e.g. the <a class="reference internal" href="../api/hyperspy._signals.signal1d.html#hyperspy._signals.signal1d.Signal1D" title="hyperspy._signals.signal1d.Signal1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal1D</span></code></a> class provides
common functionality to deal with one-dimensional (e.g. spectral) data and
<code class="xref py py-class docutils literal notranslate"><span class="pre">EELSSpectrum</span></code> (which is a subclass of
<a class="reference internal" href="../api/hyperspy._signals.signal1d.html#hyperspy._signals.signal1d.Signal1D" title="hyperspy._signals.signal1d.Signal1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal1D</span></code></a>) adds extra functionality to the
<a class="reference internal" href="../api/hyperspy._signals.signal1d.html#hyperspy._signals.signal1d.Signal1D" title="hyperspy._signals.signal1d.Signal1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal1D</span></code></a> class for electron energy-loss
spectroscopy data analysis.</p>
<p>The <a class="reference internal" href="#signal-subclasses-table-label"><span class="std std-ref">table below</span></a> summarises all the
specialised <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> subclasses currently distributed
with HyperSpy.</p>
<p>The <a class="reference internal" href="../api/hyperspy.signals.html#module-hyperspy.signals" title="hyperspy.signals"><code class="xref py py-mod docutils literal notranslate"><span class="pre">signals</span></code></a> module, which contains all available signal subclasses,
is imported in the user namespace when loading HyperSpy. In the following
example we create a Signal2D instance from a 2D numpy array:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span>
<span class="go">&lt;Signal2D, title: , dimensions: (|64, 64)&gt;</span>
</pre></div>
</div>
<p>The different signals store other objects in what are called attributes. For
examples, the data is stored in a numpy array in the
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.data" title="hyperspy.signal.BaseSignal.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> attribute, the original parameters in the
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.original_metadata" title="hyperspy.signal.BaseSignal.original_metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">original_metadata</span></code></a> attribute, the mapped parameters
in the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.metadata" title="hyperspy.signal.BaseSignal.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metadata</span></code></a> attribute and the axes
information (including calibration) can be accessed (and modified) in the
<a class="reference internal" href="../api/hyperspy.axes.html#hyperspy.axes.AxesManager" title="hyperspy.axes.AxesManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">AxesManager</span></code></a> attribute.</p>
</section>
<section id="signal-initialization">
<span id="id1"></span><h2>Signal initialization<a class="headerlink" href="#signal-initialization" title="Permalink to this headline"></a></h2>
<p>Many of the values in the <a class="reference internal" href="../api/hyperspy.axes.html#hyperspy.axes.AxesManager" title="hyperspy.axes.AxesManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">AxesManager</span></code></a> can be
set when making the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dict0</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;Axis0&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;offset&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;Axis1&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;offset&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">dict0</span><span class="p">,</span> <span class="n">dict1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span>
<span class="go">&lt;Axes manager, axes: (|20, 10)&gt;</span>
<span class="go">            Name |   size |  index |  offset |   scale |  units</span>
<span class="go">================ | ====== | ====== | ======= | ======= | ======</span>
<span class="go">---------------- | ------ | ------ | ------- | ------- | ------</span>
<span class="go">           Axis1 |     20 |        |       2 |     0.1 |      B</span>
<span class="go">           Axis0 |     10 |        |       1 |     0.2 |      A</span>
</pre></div>
</div>
<p>This also applies to the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.metadata" title="hyperspy.signal.BaseSignal.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metadata</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metadata_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;General&#39;</span><span class="p">:{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;A BaseSignal&#39;</span><span class="p">}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metadata_dict</span><span class="p">[</span><span class="s1">&#39;General&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A BaseSignal title&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span>
<span class="go">├── General</span>
<span class="go">│   ├── name = A BaseSignal</span>
<span class="go">│   └── title = A BaseSignal title</span>
<span class="go">└── Signal</span>
<span class="go">    └── signal_type =</span>
</pre></div>
</div>
<p>Instead of using a list of <em>axes dictionaries</em> <code class="docutils literal notranslate"><span class="pre">[dict0,</span> <span class="pre">dict1]</span></code> during signal
initialization, you can also pass a list of <em>axes objects</em>: <code class="docutils literal notranslate"><span class="pre">[axis0,</span> <span class="pre">axis1]</span></code>.</p>
</section>
<section id="the-navigation-and-signal-dimensions">
<h2>The navigation and signal dimensions<a class="headerlink" href="#the-navigation-and-signal-dimensions" title="Permalink to this headline"></a></h2>
<p>HyperSpy can deal with data of arbitrary dimensions. Each dimension is
internally classified as either “navigation” or “signal” and the way this
classification is done determines the behaviour of the signal.</p>
<p>The concept is probably best understood with an example: let’s imagine a three
dimensional dataset e.g. a numpy array with dimensions <cite>(10, 20, 30)</cite>. This
dataset could be an spectrum image acquired by scanning over a sample in two
dimensions. As in this case the signal is one-dimensional we use a
<a class="reference internal" href="../api/hyperspy._signals.signal1d.html#hyperspy._signals.signal1d.Signal1D" title="hyperspy._signals.signal1d.Signal1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal1D</span></code></a> subclass for this data e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (20, 10|30)&gt;</span>
</pre></div>
</div>
<p>In HyperSpy’s terminology, the <em>signal dimension</em> of this dataset is 30 and
the navigation dimensions (20, 10). Notice the separator <cite>|</cite> between the
navigation and signal dimensions.</p>
<p>However, the same dataset could also be interpreted as an image
stack instead.  Actually it could has been acquired by capturing two
dimensional images at different wavelengths. Then it would be natural to
identify the two spatial dimensions as the signal dimensions and the wavelength
dimension as the navigation dimension. To view the data in this way we could
have used a <a class="reference internal" href="../api/hyperspy._signals.signal2d.html#hyperspy._signals.signal2d.Signal2D" title="hyperspy._signals.signal2d.Signal2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal2D</span></code></a> instead e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span>
<span class="go">&lt;Signal2D, title: , dimensions: (10|30, 20)&gt;</span>
</pre></div>
</div>
<p>Indeed, for data analysis purposes,
one may like to operate with an image stack as if it was a set of spectra or
viceversa. One can easily switch between these two alternative ways of
classifying the dimensions of a three-dimensional dataset by
<a class="reference internal" href="#transforming-signal-label"><span class="std std-ref">transforming between BaseSignal subclasses</span></a>.</p>
<p>The same dataset could be seen as a three-dimensional signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">td</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">td</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (|30, 20, 10)&gt;</span>
</pre></div>
</div>
<p>Notice that with use <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> because there is
no specialised subclass for three-dimensional data. Also note that by default
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> interprets all dimensions as signal dimensions.
We could also configure it to operate on the dataset as a three-dimensional
array of scalars by changing the default <em>view</em> of
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> by taking the transpose of it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scalar</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scalar</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (30, 20, 10|)&gt;</span>
</pre></div>
</div>
<p>For more examples of manipulating signal axes in the “signal-navigation” space
can be found in <a class="reference internal" href="#signal-transpose"><span class="std std-ref">Transposing (changing signal spaces)</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although each dimension can be arbitrarily classified as “navigation
dimension” or “signal dimension”, for most common tasks there is no need to
modify HyperSpy’s default choice.</p>
</div>
<section id="transforming-between-signal-subclasses">
<span id="transforming-signal-label"></span><h3>Transforming between signal subclasses<a class="headerlink" href="#transforming-between-signal-subclasses" title="Permalink to this headline"></a></h3>
<p>The different subclasses are characterized by the <cite>signal_type</cite> metadata attribute,
the data <cite>dtype</cite> and the signal dimension. See the table and diagram below.
<cite>signal_type</cite> describes the nature of the signal. It can be any string, normally the
acronym associated with a particular signal. In certain cases HyperSpy provides
features that are only available for a particular signal type through
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> subclasses. The <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> method
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.set_signal_type" title="hyperspy.signal.BaseSignal.set_signal_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_signal_type()</span></code></a> changes the signal_type in place, which
may result in a <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> subclass transformation.</p>
<p>Furthermore, the <cite>dtype</cite> of the signal data also affects the subclass assignment. There are
e.g. specialised signal subclasses to handle complex data (see the following diagram).</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../_images/HyperSpySignalOverview.png"><img alt="../_images/HyperSpySignalOverview.png" src="../_images/HyperSpySignalOverview.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-text">Diagram showing the inheritance structure of the different subclasses</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<span id="signal-subclasses-table-label"></span><table class="docutils align-default" id="id4">
<caption><span class="caption-text">BaseSignal subclass <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.metadata" title="hyperspy.signal.BaseSignal.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metadata</span></code></a> attributes.</span><a class="headerlink" href="#id4" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 59%" />
<col style="width: 15%" />
<col style="width: 19%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>BaseSignal subclass</p></th>
<th class="head"><p>signal_dimension</p></th>
<th class="head"><p>signal_type</p></th>
<th class="head"><p>dtype</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a></p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>real</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/hyperspy._signals.signal1d.html#hyperspy._signals.signal1d.Signal1D" title="hyperspy._signals.signal1d.Signal1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal1D</span></code></a></p></td>
<td><p>1</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>real</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">EELSSpectrum</span></code></p></td>
<td><p>1</p></td>
<td><p>EELS</p></td>
<td><p>real</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">EDSSEMSpectrum</span></code></p></td>
<td><p>1</p></td>
<td><p>EDS_SEM</p></td>
<td><p>real</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">EDSTEM</span></code></p></td>
<td><p>1</p></td>
<td><p>EDS_TEM</p></td>
<td><p>real</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/hyperspy._signals.signal2d.html#hyperspy._signals.signal2d.Signal2D" title="hyperspy._signals.signal2d.Signal2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal2D</span></code></a></p></td>
<td><p>2</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>real</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/hyperspy._signals.hologram_image.html#hyperspy._signals.hologram_image.HologramImage" title="hyperspy._signals.hologram_image.HologramImage"><code class="xref py py-class docutils literal notranslate"><span class="pre">HologramImage</span></code></a></p></td>
<td><p>2</p></td>
<td><p>hologram</p></td>
<td><p>real</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/hyperspy._signals.dielectric_function.html#hyperspy._signals.dielectric_function.DielectricFunction" title="hyperspy._signals.dielectric_function.DielectricFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">DielectricFunction</span></code></a></p></td>
<td><p>1</p></td>
<td><p>DielectricFunction</p></td>
<td><p>complex</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/hyperspy._signals.complex_signal.html#hyperspy._signals.complex_signal.ComplexSignal" title="hyperspy._signals.complex_signal.ComplexSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">ComplexSignal</span></code></a></p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>complex</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/hyperspy._signals.complex_signal1d.html#hyperspy._signals.complex_signal1d.ComplexSignal1D" title="hyperspy._signals.complex_signal1d.ComplexSignal1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">ComplexSignal1D</span></code></a></p></td>
<td><p>1</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>complex</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Complex2D</span></code></p></td>
<td><p>2</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>complex</p></td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.0: </span><code class="docutils literal notranslate"><span class="pre">Simulation</span></code>, <code class="docutils literal notranslate"><span class="pre">SpectrumSimulation</span></code> and <code class="docutils literal notranslate"><span class="pre">ImageSimulation</span></code>
classes removed.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.5: </span>External packages can register extra <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a>
subclasses.</p>
</div>
<p>Note that, if you have <a class="reference internal" href="intro.html#hyperspy-extensions-label"><span class="std std-ref">packages that extend HyperSpy</span></a> installed in your system, there may
be more specialised signals available to you. To print all available specialised
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> subclasses installed in your system call the
<a class="reference internal" href="../api/hyperspy.utils.html#hyperspy.utils.print_known_signal_types" title="hyperspy.utils.print_known_signal_types"><code class="xref py py-func docutils literal notranslate"><span class="pre">print_known_signal_types()</span></code></a>
function as in the following example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">print_known_signal_types</span><span class="p">()</span>
<span class="go">+--------------------+---------------------+--------------------+----------+</span>
<span class="go">|    signal_type     |       aliases       |     class name     | package  |</span>
<span class="go">+--------------------+---------------------+--------------------+----------+</span>
<span class="go">| DielectricFunction | dielectric function | DielectricFunction | hyperspy |</span>
<span class="go">|      EDS_SEM       |                     |   EDSSEMSpectrum   | hyperspy |</span>
<span class="go">|      EDS_TEM       |                     |   EDSTEMSpectrum   | hyperspy |</span>
<span class="go">|        EELS        |       TEM EELS      |    EELSSpectrum    | hyperspy |</span>
<span class="go">|      hologram      |                     |   HologramImage    | hyperspy |</span>
<span class="go">|      MySignal      |                     |      MySignal      | hspy_ext |</span>
<span class="go">+--------------------+---------------------+--------------------+----------+</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>From version 2.0 HyperSpy will no longer ship
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> subclasses that are specific to a
particular type of data (i.e. with non-empty <code class="docutils literal notranslate"><span class="pre">signal_type</span></code>). All those
signals currently distributed with HyperSpy will be moved to new
packages.</p>
</div>
<p>The following example shows how to transform between different subclasses.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">100</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (20, 10|100)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span>
<span class="go">├── signal_type =</span>
<span class="go">└── title =</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">to_signal2D</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span>
<span class="go">&lt;Signal2D, title: , dimensions: (100|20, 10)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span><span class="o">.</span><span class="n">metadata</span>
<span class="go">├── signal_type =</span>
<span class="go">└── title =</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_signal_type</span><span class="p">(</span><span class="s2">&quot;EELS&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;EELSSpectrum, title: , dimensions: (20, 10|100)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="s2">&quot;complex&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;ComplexSignal1D, title: , dimensions: (20, 10|100)&gt;</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="ragged-array">
<span id="signal-ragged"></span><h2>Ragged array<a class="headerlink" href="#ragged-array" title="Permalink to this headline"></a></h2>
<p>A ragged array (also called jagged array) is an array created with
sequences-of-sequences, where the nested sequences don’t have the same length.
For example, a numpy ragged array can be created as follow:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span>
<span class="go">array([list([1, 2, 3]), list([1])], dtype=object)</span>
</pre></div>
</div>
</div></blockquote>
<p>Note that the array shape is (2, ):</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, )</span>
</pre></div>
</div>
</div></blockquote>
<p>Numpy ragged array must have python <code class="docutils literal notranslate"><span class="pre">object</span></code> type to allow the variable length of
the nested sequences - here <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code> and <code class="docutils literal notranslate"><span class="pre">[1]</span></code>. As explained in
<a class="reference external" href="https://numpy.org/neps/nep-0034-infer-dtype-is-object.html">NEP-34</a>,
<code class="docutils literal notranslate"><span class="pre">dtype=object</span></code> needs to be specified when creating the array to avoid ambiguity
about the shape of the array.</p>
<p>HyperSpy supports the use of ragged array with the following conditions:</p>
<ul class="simple">
<li><p>The signal must be explicitly defined as being <code class="docutils literal notranslate"><span class="pre">ragged</span></code>, either when creating
the signal or by changing the ragged attribute of the signal</p></li>
<li><p>The signal dimension is the variable length dimension of the array</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">isig</span></code> syntax is not supported</p></li>
<li><p>Signal with ragged array can’t be transposed</p></li>
<li><p>Signal with ragged array can’t be plotted</p></li>
</ul>
<p>To create a hyperspy signal of a numpy ragged array:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">ragged</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (2|ragged)&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">ragged</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span>
<span class="go">&lt;Axes manager, axes: (2|ragged)&gt;</span>
<span class="go">            Name |   size |  index |  offset |   scale |  units</span>
<span class="go">================ | ====== | ====== | ======= | ======= | ======</span>
<span class="go">     &lt;undefined&gt; |      2 |      0 |       0 |       1 | &lt;undefined&gt;</span>
<span class="go">---------------- | ------ | ------ | ------- | ------- | ------</span>
<span class="go">     Ragged axis |               Variable length</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When possible, numpy will cast sequences-of-sequences to “non-ragged” array:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span>
<span class="go">array([[1, 2],</span>
<span class="go">       [1, 2]], dtype=object)</span>
</pre></div>
</div>
</div></blockquote>
<p>Unlike in the previous example, here the array is not ragged, because
the length of the nested sequences are equal (2) and numpy will create
an array of shape (2, 2) instead of (2, ) as in the previous example of
ragged array</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<p>In addition to the use of the keyword <code class="docutils literal notranslate"><span class="pre">ragged</span></code> when creating an hyperspy
signal, the <code class="docutils literal notranslate"><span class="pre">ragged</span></code> attribute can also be set to specify whether the signal
contains a ragged array or not.</p>
<p>In the following example, an hyperspy signal is created without specifying that
the array is ragged. In this case, the signal dimension is 2, which <em>can be</em>
misleading, because each item contains a list of numbers. To provide a unambiguous
representation of the fact that the signal contains a ragged array, the
<code class="docutils literal notranslate"><span class="pre">ragged</span></code> attribute can be set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. By doing so, the signal space will
be described as “ragged” and the navigation shape will become the same as the
shape of the ragged array:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (|2)&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">ragged</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (2|ragged)&gt;</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="binned-and-unbinned-signals">
<span id="signal-binned"></span><h2>Binned and unbinned signals<a class="headerlink" href="#binned-and-unbinned-signals" title="Permalink to this headline"></a></h2>
<p>Signals that are a histogram of a probability density function (pdf) should
have the <code class="docutils literal notranslate"><span class="pre">is_binned</span></code> attribute of the signal axis set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. The reason
is that some methods operate differently on signals that are <em>binned</em>. An
example of <em>binned</em> signals are EDS spectra, where the multichannel analyzer
integrates the signal counts in every channel (=bin).
Note that for 2D signals each signal axis has an <code class="docutils literal notranslate"><span class="pre">is_binned</span></code>
attribute that can be set independently. For example, for the first signal
axis: <code class="docutils literal notranslate"><span class="pre">signal.axes_manager.signal_axes[0].is_binned</span></code>.</p>
<p>The default value of the <code class="docutils literal notranslate"><span class="pre">is_binned</span></code> attribute is shown in the
following table:</p>
<table class="docutils align-default" id="id5">
<caption><span class="caption-text">Binned default values for the different subclasses.</span><a class="headerlink" href="#id5" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 89%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>BaseSignal subclass</p></th>
<th class="head"><p>binned</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a></p></td>
<td><p>False</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/hyperspy._signals.signal1d.html#hyperspy._signals.signal1d.Signal1D" title="hyperspy._signals.signal1d.Signal1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal1D</span></code></a></p></td>
<td><p>False</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">EELSSpectrum</span></code></p></td>
<td><p>True</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">EDSSEMSpectrum</span></code></p></td>
<td><p>True</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">EDSTEMSpectrum</span></code></p></td>
<td><p>True</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/hyperspy._signals.signal2d.html#hyperspy._signals.signal2d.Signal2D" title="hyperspy._signals.signal2d.Signal2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal2D</span></code></a></p></td>
<td><p>False</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/hyperspy._signals.complex_signal.html#hyperspy._signals.complex_signal.ComplexSignal" title="hyperspy._signals.complex_signal.ComplexSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">ComplexSignal</span></code></a></p></td>
<td><p>False</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/hyperspy._signals.complex_signal1d.html#hyperspy._signals.complex_signal1d.ComplexSignal1D" title="hyperspy._signals.complex_signal1d.ComplexSignal1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">ComplexSignal1D</span></code></a></p></td>
<td><p>False</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/hyperspy._signals.complex_signal2d.html#hyperspy._signals.complex_signal2d.ComplexSignal2D" title="hyperspy._signals.complex_signal2d.ComplexSignal2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">ComplexSignal2D</span></code></a></p></td>
<td><p>False</p></td>
</tr>
</tbody>
</table>
<p>To change the default value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_binned</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.7: </span>The <code class="docutils literal notranslate"><span class="pre">binned</span></code> attribute from the metadata has been
replaced by the axis attributes <code class="docutils literal notranslate"><span class="pre">is_binned</span></code>.</p>
</div>
<section id="integration-of-binned-signals">
<h3>Integration of binned signals<a class="headerlink" href="#integration-of-binned-signals" title="Permalink to this headline"></a></h3>
<p>For binned axes, the detector already provides the per-channel integration of
the signal. Therefore, in this case, <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.integrate1D" title="hyperspy.signal.BaseSignal.integrate1D"><code class="xref py py-meth docutils literal notranslate"><span class="pre">integrate1D()</span></code></a>
performs a simple summation along the given axis. In contrast, for unbinned
axes, <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.integrate1D" title="hyperspy.signal.BaseSignal.integrate1D"><code class="xref py py-meth docutils literal notranslate"><span class="pre">integrate1D()</span></code></a> calls the
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.integrate_simpson" title="hyperspy.signal.BaseSignal.integrate_simpson"><code class="xref py py-meth docutils literal notranslate"><span class="pre">integrate_simpson()</span></code></a> method.</p>
</section>
</section>
<section id="generic-tools">
<h2>Generic tools<a class="headerlink" href="#generic-tools" title="Permalink to this headline"></a></h2>
<p>Below we briefly introduce some of the most commonly used tools (methods). For
more details about a particular method click on its name. For a detailed list
of all the methods available see the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> documentation.</p>
<p>The methods of this section are available to all the signals. In other chapters
methods that are only available in specialized
subclasses.</p>
<section id="mathematical-operations">
<h3>Mathematical operations<a class="headerlink" href="#mathematical-operations" title="Permalink to this headline"></a></h3>
<p>A number of mathematical operations are available
in <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a>. Most of them are just wrapped numpy
functions.</p>
<p>The methods that perform mathematical operation over one or more axis at a
time are:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.sum" title="hyperspy.signal.BaseSignal.sum"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sum()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.max" title="hyperspy.signal.BaseSignal.max"><code class="xref py py-meth docutils literal notranslate"><span class="pre">max()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.min" title="hyperspy.signal.BaseSignal.min"><code class="xref py py-meth docutils literal notranslate"><span class="pre">min()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.mean" title="hyperspy.signal.BaseSignal.mean"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mean()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.std" title="hyperspy.signal.BaseSignal.std"><code class="xref py py-meth docutils literal notranslate"><span class="pre">std()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.var" title="hyperspy.signal.BaseSignal.var"><code class="xref py py-meth docutils literal notranslate"><span class="pre">var()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.nansum" title="hyperspy.signal.BaseSignal.nansum"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nansum()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.nanmax" title="hyperspy.signal.BaseSignal.nanmax"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nanmax()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.nanmin" title="hyperspy.signal.BaseSignal.nanmin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nanmin()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.nanmean" title="hyperspy.signal.BaseSignal.nanmean"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nanmean()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.nanstd" title="hyperspy.signal.BaseSignal.nanstd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nanstd()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.nanvar" title="hyperspy.signal.BaseSignal.nanvar"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nanvar()</span></code></a></p></li>
</ul>
<p>Note that by default all this methods perform the operation over <em>all</em>
navigation axes.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;E&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (|6, 4, 2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># by default perform operation over all navigation axes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (|6, 4, 2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># can also pass axes individually</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="go">&lt;Signal2D, title: , dimensions: (|4, 2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or a tuple of axes to operate on, with duplicates, by index or directly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (|1)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Scalar axis, size: 1&gt;</span>
</pre></div>
</div>
<p>The following methods operate only on one axis at a time:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.diff" title="hyperspy.signal.BaseSignal.diff"><code class="xref py py-meth docutils literal notranslate"><span class="pre">diff()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.derivative" title="hyperspy.signal.BaseSignal.derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">derivative()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.integrate_simpson" title="hyperspy.signal.BaseSignal.integrate_simpson"><code class="xref py py-meth docutils literal notranslate"><span class="pre">integrate_simpson()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.integrate1D" title="hyperspy.signal.BaseSignal.integrate1D"><code class="xref py py-meth docutils literal notranslate"><span class="pre">integrate1D()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.indexmin" title="hyperspy.signal.BaseSignal.indexmin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">indexmin()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.indexmax" title="hyperspy.signal.BaseSignal.indexmax"><code class="xref py py-meth docutils literal notranslate"><span class="pre">indexmax()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.valuemin" title="hyperspy.signal.BaseSignal.valuemin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">valuemin()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.valuemax" title="hyperspy.signal.BaseSignal.valuemax"><code class="xref py py-meth docutils literal notranslate"><span class="pre">valuemax()</span></code></a></p></li>
</ul>
<p id="ufunc-label">All numpy ufunc can operate on <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a>
instances, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">General</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: A, dimensions: (|2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">&lt;Signal1D, title: exp(A), dimensions: (|2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([ 1.        ,  2.71828183])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">&lt;Signal1D, title: power(A, 2), dimensions: (|2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">&lt;Signal1D, title: add(A, A), dimensions: (|2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="go">&lt;Signal1D, title: add(Untitled Signal 1, Untitled Signal 2), dimensions: (|2)&gt;</span>
</pre></div>
</div>
<p>Notice that the title is automatically updated. When the signal has no title
a new title is automatically generated:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="go">&lt;Signal1D, title: add(Untitled Signal 1, Untitled Signal 2), dimensions: (|2)&gt;</span>
</pre></div>
</div>
<p>Functions (other than unfucs) that operate on numpy arrays can also operate
on <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> instances, however they return a numpy
array instead of a <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> instance e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">array([ 0.,  0.])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For numerical <strong>differentiation</strong> and <strong>integration</strong>, use the proper
methods <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.derivative" title="hyperspy.signal.BaseSignal.derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">derivative()</span></code></a> and
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.integrate1D" title="hyperspy.signal.BaseSignal.integrate1D"><code class="xref py py-meth docutils literal notranslate"><span class="pre">integrate1D()</span></code></a>. In certain cases, particularly
when operating on a non-uniform axis, the approximations using the
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.diff" title="hyperspy.signal.BaseSignal.diff"><code class="xref py py-meth docutils literal notranslate"><span class="pre">diff()</span></code></a> and <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.sum" title="hyperspy.signal.BaseSignal.sum"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sum()</span></code></a>
methods will lead to erroneous results.</p>
</div>
</section>
<section id="indexing">
<span id="signal-indexing"></span><h3>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline"></a></h3>
<p>Indexing a <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a>  provides a powerful, convenient and
Pythonic way to access and modify its data. In HyperSpy indexing is achieved
using <code class="docutils literal notranslate"><span class="pre">isig</span></code> and <code class="docutils literal notranslate"><span class="pre">inav</span></code>, which allow the navigation and signal dimensions
to be indexed independently. The idea is essentially to specify a subset of the
data based on its position in the array and it is therefore essential to know
the convention adopted for specifying that position, which is described here.</p>
<p>Those new to Python may find indexing a somewhat esoteric concept but once
mastered it is one of the most powerful features of Python based code and
greatly simplifies many common tasks. HyperSpy’s Signal indexing is similar
to numpy array indexing and those new to Python are encouraged to read the
associated <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/arrays.indexing.html">numpy documentation on the subject</a>.</p>
<p>Key features of indexing in HyperSpy are as follows (note that some of these
features differ from numpy):</p>
<ul class="simple">
<li><p>HyperSpy indexing does:</p>
<ul>
<li><p>Allow independent indexing of signal and navigation dimensions</p></li>
<li><p>Support indexing with decimal numbers.</p></li>
<li><p>Support indexing with units.</p></li>
<li><p>Support indexing with relative coordinates i.e. ‘rel0.5’</p></li>
<li><p>Use the image order for indexing i.e. [x, y, z,…] (HyperSpy) vs
[…,z,y,x] (numpy)</p></li>
</ul>
</li>
<li><p>HyperSpy indexing does not:</p>
<ul>
<li><p>Support indexing using arrays.</p></li>
<li><p>Allow the addition of new axes using the newaxis object.</p></li>
</ul>
</li>
</ul>
<p>The examples below illustrate a range of common indexing tasks.</p>
<p>First consider indexing a single spectrum, which has only one signal dimension
(and no navigation dimensions) so we use <code class="docutils literal notranslate"><span class="pre">isig</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|10)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|1)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3, 4])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|6)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|6)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([5, 7, 9])</span>
</pre></div>
</div>
<p>Unlike numpy, HyperSpy supports indexing using decimal numbers or strings
(containing a decimal number and units), in which case
HyperSpy indexes using the axis scales instead of the indices. Additionally,
one can index using relative coordinates, for example ‘rel0.5’ to index the
middle of the axis.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|10)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span>
<span class="go">array([ 0. ,  0.5,  1. ,  1.5,  2. ,  2.5,  3. ,  3.5,  4. ,  4.5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mf">0.5</span><span class="p">:</span><span class="mf">4.</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([1, 2, 3, 4, 5, 6, 7])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mf">0.5</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mf">0.5</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([1, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;µm&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[:</span><span class="s1">&#39;2000 nm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[:</span><span class="s1">&#39;rel0.5&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3])</span>
</pre></div>
</div>
<p>Importantly the original <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> and its “indexed self”
share their data and, therefore, modifying the value of the data in one
modifies the same value in the other. Note also that in the example below
s.data is used to access the data as a numpy array directly and this array is
then indexed using numpy indexing.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (10,)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 2, 4, 6, 8])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([10, 10, 10, 10, 10])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([10,  1, 10,  3, 10,  5, 10,  7, 10,  9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 0, 0, 0, 0])</span>
</pre></div>
</div>
<p>Of course it is also possible to use the same syntax to index multidimensional
data treating navigation axes using <code class="docutils literal notranslate"><span class="pre">inav</span></code> and signal axes using <code class="docutils literal notranslate"><span class="pre">isig</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (3, 2|4)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([[[ 0,  1,  2,  3],</span>
<span class="go">    [ 4,  5,  6,  7],</span>
<span class="go">    [ 8,  9, 10, 11]],</span>

<span class="go">   [[12, 13, 14, 15],</span>
<span class="go">    [16, 17, 18, 19],</span>
<span class="go">    [20, 21, 22, 23]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="o">.</span><span class="n">signal_axes</span>
<span class="go">(&lt;t axis, size: 4&gt;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="o">.</span><span class="n">navigation_axes</span>
<span class="go">(&lt;x axis, size: 3, index: 0&gt;, &lt;y axis, size: 2, index: 0&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axes_manager</span>
<span class="go">&lt;Axes manager, axes: (|4)&gt;</span>
<span class="go">            Name |   size |  index |  offset |   scale |  units</span>
<span class="go">================ | ====== | ====== | ======= | ======= | ======</span>
<span class="go">---------------- | ------ | ------ | ------- | ------- | ------</span>
<span class="go">               t |      4 |        |       0 |       1 | &lt;undefined&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isig</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([3, 2, 1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (3, 2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axes_manager</span>
<span class="go">&lt;Axes manager, axes: (3, 2|)&gt;</span>
<span class="go">            Name |   size |  index |  offset |   scale |  units</span>
<span class="go">================ | ====== | ====== | ======= | ======= | ======</span>
<span class="go">               x |      3 |      0 |       0 |       1 | &lt;undefined&gt;</span>
<span class="go">               y |      2 |      0 |       0 |       1 | &lt;undefined&gt;</span>
<span class="go">---------------- | ------ | ------ | ------- | ------- | ------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([[ 0,  4,  8],</span>
<span class="go">   [12, 16, 20]])</span>
</pre></div>
</div>
<p>Independent indexation of the signal and navigation dimensions is demonstrated
further in the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (3, 2|4)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([[[ 0,  1,  2,  3],</span>
<span class="go">    [ 4,  5,  6,  7],</span>
<span class="go">    [ 8,  9, 10, 11]],</span>

<span class="go">   [[12, 13, 14, 15],</span>
<span class="go">    [16, 17, 18, 19],</span>
<span class="go">    [20, 21, 22, 23]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="o">.</span><span class="n">signal_axes</span>
<span class="go">(&lt;t axis, size: 4&gt;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">axes_manager</span><span class="o">.</span><span class="n">navigation_axes</span>
<span class="go">(&lt;x axis, size: 3, index: 0&gt;, &lt;y axis, size: 2, index: 0&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axes_manager</span>
<span class="go">&lt;Axes manager, axes: (|4)&gt;</span>
<span class="go">            Name |   size |  index |  offset |   scale |  units</span>
<span class="go">================ | ====== | ====== | ======= | ======= | ======</span>
<span class="go">---------------- | ------ | ------ | ------- | ------- | ------</span>
<span class="go">               t |      4 |        |       0 |       1 | &lt;undefined&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (2, 3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axes_manager</span>
<span class="go">&lt;Axes manager, axes: (3, 2|)&gt;</span>
<span class="go">            Name |   size |  index |  offset |   scale |  units</span>
<span class="go">================ | ====== | ====== | ======= | ======= | ======</span>
<span class="go">               x |      3 |      0 |       0 |       1 | &lt;undefined&gt;</span>
<span class="go">               y |      2 |      0 |       0 |       1 | &lt;undefined&gt;</span>
<span class="go">---------------- | ------ | ------ | ------- | ------- | ------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([[ 0,  4,  8],</span>
<span class="go">   [12, 16, 20]])</span>
</pre></div>
</div>
<p>The same syntax can be used to set the data values in signal and navigation
dimensions respectively:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (3, 2|4)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([[[ 0,  1,  2,  3],</span>
<span class="go">    [ 4,  5,  6,  7],</span>
<span class="go">    [ 8,  9, 10, 11]],</span>

<span class="go">   [[12, 13, 14, 15],</span>
<span class="go">    [16, 17, 18, 19],</span>
<span class="go">    [20, 21, 22, 23]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([0, 1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([1, 1, 1, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inav</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([16, 17, 18, 19])</span>
</pre></div>
</div>
</section>
<section id="signal-operations">
<span id="id2"></span><h3>Signal operations<a class="headerlink" href="#signal-operations" title="Permalink to this headline"></a></h3>
<p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> supports all the Python binary arithmetic
operations (+, -, *, //, %, divmod(), pow(), **, &lt;&lt;, &gt;&gt;, &amp;, ^, |),
augmented binary assignments (+=, -=, *=, /=, //=, %=, **=, &lt;&lt;=, &gt;&gt;=, &amp;=,
^=, |=), unary operations (-, +, abs() and ~) and rich comparisons operations
(&lt;, &lt;=, ==, x!=y, &lt;&gt;, &gt;, &gt;=).</p>
<p>These operations are performed element-wise. When the dimensions of the signals
are not equal <a class="reference external" href="http://docs.scipy.org/doc/numpy/user/basics.broadcasting.html">numpy broadcasting rules apply</a> independently
for the navigation and signal axes.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Hyperspy does not check if the calibration of the signals matches.</p>
</div>
<p>In the following example <cite>s2</cite> has only one navigation axis while <cite>s</cite> has two.
However, because the size of their first navigation axis is the same, their
dimensions are compatible and <cite>s2</cite> is
broadcasted to match <cite>s</cite>’s dimensions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2, 3|4, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2|4, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">+</span> <span class="n">s2</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2, 3|4, 5)&gt;</span>
</pre></div>
</div>
<p>In the following example the dimensions are not compatible and an exception
is raised.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2, 3|4, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span>
<span class="go">&lt;Signal2D, title: , dimensions: (3|4, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">+</span> <span class="n">s2</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;ipython-input-55-044bb11a0bd9&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
    <span class="n">s</span> <span class="o">+</span> <span class="n">s2</span>
  File <span class="nb">&quot;&lt;string&gt;&quot;</span>, line <span class="m">2</span>, in <span class="n">__add__</span>
  File <span class="nb">&quot;/home/fjd29/Python/hyperspy/hyperspy/signal.py&quot;</span>, line <span class="m">2686</span>, in <span class="n">_binary_operator_ruler</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">exception_message</span><span class="p">)</span>
<span class="gr">ValueError</span>: <span class="n">Invalid dimensions for this operation</span>
</pre></div>
</div>
<p>Broadcasting operates exactly in the same way for the signal axes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2, 3|4, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span>
<span class="go">&lt;Signal1D, title: , dimensions: (2, 3|4)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">+</span> <span class="n">s2</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2, 3|4, 5)&gt;</span>
</pre></div>
</div>
<p>In-place operators also support broadcasting, but only when broadcasting would
not change the left most signal dimensions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">+=</span> <span class="n">s2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal2D, title: , dimensions: (2, 3|4, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">+=</span> <span class="n">s</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;ipython-input-64-fdb9d3a69771&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
    <span class="n">s2</span> <span class="o">+=</span> <span class="n">s</span>
  File <span class="nb">&quot;&lt;string&gt;&quot;</span>, line <span class="m">2</span>, in <span class="n">__iadd__</span>
  File <span class="nb">&quot;/home/fjd29/Python/hyperspy/hyperspy/signal.py&quot;</span>, line <span class="m">2737</span>, in <span class="n">_binary_operator_ruler</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="n">op_name</span><span class="p">)(</span><span class="n">odata</span><span class="p">)</span>
<span class="gr">ValueError</span>: <span class="n">non-broadcastable output operand with shape (3,2,1,4) doesn\&#39;t match the broadcast shape (3,2,5,4)</span>
</pre></div>
</div>
</section>
<section id="iterating-over-the-navigation-axes">
<span id="signal-iterator"></span><h3>Iterating over the navigation axes<a class="headerlink" href="#iterating-over-the-navigation-axes" title="Permalink to this headline"></a></h3>
<p>BaseSignal instances are iterables over the navigation axes. For example, the
following code creates a stack of 10 images and saves them in separate “png”
files by iterating over the signal instance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">single_image</span> <span class="ow">in</span> <span class="n">image_stack</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">single_image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;image </span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="o">.</span><span class="n">indices</span><span class="p">))</span>
<span class="go">The &quot;image (0, 0).png&quot; file was created.</span>
<span class="go">The &quot;image (1, 0).png&quot; file was created.</span>
<span class="go">The &quot;image (2, 0).png&quot; file was created.</span>
<span class="go">The &quot;image (3, 0).png&quot; file was created.</span>
<span class="go">The &quot;image (4, 0).png&quot; file was created.</span>
<span class="go">The &quot;image (0, 1).png&quot; file was created.</span>
<span class="go">The &quot;image (1, 1).png&quot; file was created.</span>
<span class="go">The &quot;image (2, 1).png&quot; file was created.</span>
<span class="go">The &quot;image (3, 1).png&quot; file was created.</span>
<span class="go">The &quot;image (4, 1).png&quot; file was created.</span>
</pre></div>
</div>
<p>The data of the signal instance that is returned at each iteration is a view of
the original data, a property that we can use to perform operations on the
data.  For example, the following code rotates the image at each coordinate  by
a given angle and uses the <a class="reference internal" href="../api/hyperspy.misc.utils.html#hyperspy.misc.utils.stack" title="hyperspy.misc.utils.stack"><code class="xref py py-func docutils literal notranslate"><span class="pre">stack()</span></code></a> function in combination
with <a class="reference external" href="http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions">list comprehensions</a>
to make a horizontal “collage” of the image stack:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()]</span><span class="o">*</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">image</span><span class="p">,</span> <span class="n">angle</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">image_stack</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">180</span><span class="p">)):</span>
<span class="gp">... </span>   <span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">reshape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># clip data to integer range:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">image_stack</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collage</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">image</span> <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">image_stack</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collage</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalebar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id6">
<a class="reference internal image-reference" href="../_images/rotate_ascent.png"><img alt="../_images/rotate_ascent.png" src="../_images/rotate_ascent.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-text">Rotation of images by iteration.</span><a class="headerlink" href="#id6" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="iterating-external-functions-with-the-map-method">
<span id="map-label"></span><h3>Iterating external functions with the map method<a class="headerlink" href="#iterating-external-functions-with-the-map-method" title="Permalink to this headline"></a></h3>
<p>Performing an operation on the data at each coordinate, as in the previous example,
using an external function can be more easily accomplished using the
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.map" title="hyperspy.signal.BaseSignal.map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">map()</span></code></a> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()]</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">angle</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">reshape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># clip data to integer range</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">image_stack</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collage</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">image</span> <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">image_stack</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collage</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id7">
<a class="reference internal image-reference" href="../_images/rotate_ascent_apply_simple.png"><img alt="../_images/rotate_ascent_apply_simple.png" src="../_images/rotate_ascent_apply_simple.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-text">Rotation of images by the same amount using <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.map" title="hyperspy.signal.BaseSignal.map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">map()</span></code></a>.</span><a class="headerlink" href="#id7" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.map" title="hyperspy.signal.BaseSignal.map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">map()</span></code></a> method can also take variable
arguments as in the following example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()]</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">135</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">angle</span><span class="o">=</span><span class="n">angles</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">reshape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id8">
<a class="reference internal image-reference" href="../_images/rotate_ascent_apply_ndkwargs.png"><img alt="../_images/rotate_ascent_apply_ndkwargs.png" src="../_images/rotate_ascent_apply_ndkwargs.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-text">Rotation of images using <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.map" title="hyperspy.signal.BaseSignal.map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">map()</span></code></a> with different
arguments for each image in the stack.</span><a class="headerlink" href="#id8" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.0: </span><code class="docutils literal notranslate"><span class="pre">inplace</span></code> keyword and non-preserved output shapes</p>
</div>
<p>If all function calls do not return identically-shaped results, only navigation
information is preserved, and the final result is an array where
each element corresponds to the result of the function (or arbitrary object
type). These are <a class="reference internal" href="#signal-ragged"><span class="std std-ref">ragged arrays</span></a> and has the dtype <cite>object</cite>.
As such, most HyperSpy functions cannot operate on such signals, and the
data should be accessed directly.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">inplace</span></code> keyword (by default <code class="docutils literal notranslate"><span class="pre">True</span></code>) of the
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.map" title="hyperspy.signal.BaseSignal.map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">map()</span></code></a> method allows either overwriting the current
data (default, <code class="docutils literal notranslate"><span class="pre">True</span></code>) or storing it to a new signal (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_stack</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()]</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">135</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">image_stack</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">angle</span><span class="o">=</span><span class="n">angles</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">ragged</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">reshape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">100%|████████████████████████████████████████████| 4/4 [00:00&lt;00:00, 18.42it/s]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (4|)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;O&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(512, 512)</span>
<span class="go">(724, 724)</span>
<span class="go">(512, 512)</span>
<span class="go">(724, 724)</span>
</pre></div>
</div>
<p id="parallel-map-label">The execution can be sped up by passing <code class="docutils literal notranslate"><span class="pre">parallel</span></code> keyword to the
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.map" title="hyperspy.signal.BaseSignal.map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">map()</span></code></a> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">slow_func</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">data</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (20|2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">slow_func</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">100%|██████████████████████████████████████| 20/20 [00:20&lt;00:00,  1.00s/it]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># some operations will be done in parallel:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">slow_func</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">100%|██████████████████████████████████████| 20/20 [00:02&lt;00:00,  6.73it/s]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>HyperSpy implements <em>thread-based</em> parallelism for the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.map" title="hyperspy.signal.BaseSignal.map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">map()</span></code></a>
method. You can control the number of threads that are created by passing an integer value
to the <code class="docutils literal notranslate"><span class="pre">max_workers</span></code> keyword argument. By default, it will use <code class="docutils literal notranslate"><span class="pre">min(32,</span> <span class="pre">os.cpu_count())</span></code>.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.4: </span>Iterating over signal using a parameter with no navigation dimension.</p>
</div>
<p>In this case, the parameter is cyclically iterated over the navigation
dimension of the input signal. In the example below, signal s is
multiplied by a cosine parameter d, which is repeated over the
navigation dimension of s.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">512</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">:</span> <span class="n">A</span> <span class="o">*</span> <span class="n">B</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">100%|██████████| 10/10 [00:00&lt;00:00, 2573.19it/s]</span>
</pre></div>
</div>
<div class="versionadded" id="lazy-output-map-label">
<p><span class="versionmodified added">New in version 1.7: </span>Get result as lazy signal</p>
</div>
<p>Especially when working with very large datasets, it can be useful to
not do the computation immediately. For example if it would make you run
out of memory. In that case, the <cite>lazy_output</cite> parameter can be used.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">gaussian_filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_out</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">gaussian_filter</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lazy_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&lt;LazySignal2D, title: , dimensions: (4, 4|128, 128)&gt;</span>
</pre></div>
</div>
<p><cite>s_out</cite> can then be saved to a hard drive, to avoid it being loaded into memory.
Alternatively, it can be computed and loaded into memory using <cite>s_out.compute()</cite></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s_out</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;gaussian_filter_file.hspy&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Another advantage of using <cite>lazy_output=True</cite> is the ability to “chain” operations,
by running <cite>map</cite> on the output from a previous <cite>map</cite> operation.
For example, first running a Gaussian filter, followed by peak finding. This can
improve the computation time, and reduce the memory need.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s_out</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lazy_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skimage.feature</span> <span class="kn">import</span> <span class="n">blob_dog</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_out1</span> <span class="o">=</span> <span class="n">s_out</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">blob_dog</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ragged</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lazy_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_out1</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (4, 4|ragged)&gt;</span>
</pre></div>
</div>
<p>This is especially relevant for very large datasets, where memory use can be a
limiting factor.</p>
</section>
<section id="cropping">
<h3>Cropping<a class="headerlink" href="#cropping" title="Permalink to this headline"></a></h3>
<p>Cropping can be performed in a very compact and powerful way using
<a class="reference internal" href="#signal-indexing"><span class="std std-ref">Indexing</span></a> . In addition it can be performed using the following
method or GUIs if cropping <a class="reference internal" href="signal1d.html#signal1d-crop"><span class="std std-ref">signal1D</span></a> or <a class="reference internal" href="signal2d.html#signal2d-crop"><span class="std std-ref">signal2D</span></a>. There is also a general <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.crop" title="hyperspy.signal.BaseSignal.crop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">crop()</span></code></a>
method that operates <em>in place</em>.</p>
</section>
<section id="rebinning">
<span id="rebin-label"></span><h3>Rebinning<a class="headerlink" href="#rebinning" title="Permalink to this headline"></a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3: </span><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.rebin" title="hyperspy.signal.BaseSignal.rebin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rebin()</span></code></a> generalized to remove the constrain
of the <code class="docutils literal notranslate"><span class="pre">new_shape</span></code> needing to be a divisor of <code class="docutils literal notranslate"><span class="pre">data.shape</span></code>.</p>
</div>
<p>The <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.rebin" title="hyperspy.signal.BaseSignal.rebin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rebin()</span></code></a> methods supports rebinning the data to
arbitrary new shapes as long as the number of dimensions stays the same.
However, internally, it uses two different algorithms to perform the task. Only
when the new shape dimensions are divisors of the old shape’s, the operation
supports <a class="reference internal" href="big_data.html#big-data-label"><span class="std std-ref">lazy-evaluation</span></a> and is usually faster.
Otherwise, the operation requires linear interpolation.</p>
<p>For example, the following two equivalent rebinning operations can be  performed
lazily:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_SEM_Spectrum</span><span class="p">()</span><span class="o">.</span><span class="n">as_lazy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">&lt;LazyEDSSEMSpectrum, title: EDS SEM Spectrum, dimensions: (|1024)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">&lt;LazyEDSSEMSpectrum, title: EDS SEM Spectrum, dimensions: (|512)&gt;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_SEM_Spectrum</span><span class="p">()</span><span class="o">.</span><span class="n">as_lazy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">new_shape</span><span class="o">=</span><span class="p">[</span><span class="mi">512</span><span class="p">]))</span>
<span class="go">&lt;LazyEDSSEMSpectrum, title: EDS SEM Spectrum, dimensions: (|512)&gt;</span>
</pre></div>
</div>
<p>On the other hand, the following rebinning operation requires interpolation and
cannot be performed lazily:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">EDSTEMSpectrum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spectrum</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span>
<span class="go">&lt;EDSTEMSpectrum, title: , dimensions: (4, 4|10)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Sum = &#39;</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">Sum =  164.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test2</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">new_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="c1"># Equivalent to the above</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="go">&lt;EDSTEMSpectrum, title: , dimensions: (8, 8|2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">test2</span><span class="p">)</span>
<span class="go">&lt;EDSTEMSpectrum, title: , dimensions: (8, 8|2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sum =&#39;</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">Sum = 164.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sum =&#39;</span><span class="p">,</span> <span class="n">test2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">Sum = 164.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spectrum</span><span class="o">.</span><span class="n">as_lazy</span><span class="p">()</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;ipython-input-26-49bca19ebf34&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
    <span class="n">spectrum</span><span class="o">.</span><span class="n">as_lazy</span><span class="p">()</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
  File <span class="nb">&quot;/home/fjd29/Python/hyperspy3/hyperspy/_signals/eds.py&quot;</span>, line <span class="m">184</span>, in <span class="n">rebin</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">new_shape</span><span class="o">=</span><span class="n">new_shape</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">crop</span><span class="o">=</span><span class="n">crop</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">)</span>
  File <span class="nb">&quot;/home/fjd29/Python/hyperspy3/hyperspy/_signals/lazy.py&quot;</span>, line <span class="m">246</span>, in <span class="n">rebin</span>
    <span class="s2">&quot;Lazy rebin requires scale to be integer and divisor of the &quot;</span>
<span class="gr">NotImplementedError</span>: <span class="n">Lazy rebin requires scale to be integer and divisor of the original signal shape</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dtype</span></code>  argument can be used to specify the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of the returned
signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">&lt;Signal1D, title: , dimensions: (5, 2|10)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="go">uint8</span>

<span class="go"># Use dtype=np.unit16 to specify a dtype</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="go">uint16</span>

<span class="go"># Use dtype=&quot;same&quot; to keep the same dtype</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s3</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="go">uint8</span>

<span class="go"># By default `dtype=None`, the dtype is determined by the behaviour of</span>
<span class="go"># numpy.sum, in this case, unsigned integer of the same precision as the</span>
<span class="go"># platform interger</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s4</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s4</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="go">uint64</span>
</pre></div>
</div>
</section>
<section id="squeezing">
<span id="squeeze-label"></span><h3>Squeezing<a class="headerlink" href="#squeezing" title="Permalink to this headline"></a></h3>
<p>The <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.squeeze" title="hyperspy.signal.BaseSignal.squeeze"><code class="xref py py-meth docutils literal notranslate"><span class="pre">squeeze()</span></code></a> method removes any zero-dimensional
axes, i.e. axes of <code class="docutils literal notranslate"><span class="pre">size=1</span></code>, and the attributed data dimensions from a signal.
The method returns a reduced copy of the signal and does not operate in place.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)))</span>
<span class="go">&lt;Signal2D, title: , dimensions: (6, 1, 1, 2|8, 8)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal2D, title: , dimensions: (6, 2|8, 8)&gt;</span>
</pre></div>
</div>
<p>Squeezing can be particularly useful after a rebinning operation that leaves
one dimension with <code class="docutils literal notranslate"><span class="pre">shape=1</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">new_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="go">&lt;Signal2D, title: , dimensions: (5, 1, 5|5, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">rebin</span><span class="p">(</span><span class="n">new_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="go">&lt;Signal2D, title: , dimensions: (5, 5|5, 5)&gt;</span>
</pre></div>
</div>
</section>
<section id="folding-and-unfolding">
<h3>Folding and unfolding<a class="headerlink" href="#folding-and-unfolding" title="Permalink to this headline"></a></h3>
<p>When dealing with multidimensional datasets it is sometimes useful to transform
the data into a two dimensional dataset. This can be accomplished using the
following two methods:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.fold" title="hyperspy.signal.BaseSignal.fold"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fold()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.unfold" title="hyperspy.signal.BaseSignal.unfold"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unfold()</span></code></a></p></li>
</ul>
<p>It is also possible to unfold only the navigation or only the signal space:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.unfold_navigation_space" title="hyperspy.signal.BaseSignal.unfold_navigation_space"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unfold_navigation_space()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.unfold_signal_space" title="hyperspy.signal.BaseSignal.unfold_signal_space"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unfold_signal_space()</span></code></a></p></li>
</ul>
</section>
<section id="splitting-and-stacking">
<span id="signal-stack-split"></span><h3>Splitting and stacking<a class="headerlink" href="#splitting-and-stacking" title="Permalink to this headline"></a></h3>
<p>Several objects can be stacked together over an existing axis or over a
new axis using the <a class="reference internal" href="../api/hyperspy.misc.utils.html#hyperspy.misc.utils.stack" title="hyperspy.misc.utils.stack"><code class="xref py py-func docutils literal notranslate"><span class="pre">stack()</span></code></a> function, if they share axis
with same dimension.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">hs</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">image</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id9">
<a class="reference internal image-reference" href="../_images/stack_ascent_3_3.png"><img alt="../_images/stack_ascent_3_3.png" src="../_images/stack_ascent_3_3.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-text">Stacking example.</span><a class="headerlink" href="#id9" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When stacking signals with large amount of
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.original_metadata" title="hyperspy.signal.BaseSignal.original_metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">original_metadata</span></code></a>, these metadata will be
stacked and this can lead to very large amount of metadata which can in
turn slow down processing. The <code class="docutils literal notranslate"><span class="pre">stack_original_metadata</span></code> argument can be
used to disable stacking <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.original_metadata" title="hyperspy.signal.BaseSignal.original_metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">original_metadata</span></code></a>.</p>
</div>
<p>An object can be split into several objects
with the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.split" title="hyperspy.signal.BaseSignal.split"><code class="xref py py-meth docutils literal notranslate"><span class="pre">split()</span></code></a> method. This function can be used
to reverse the <a class="reference internal" href="../api/hyperspy.misc.utils.html#hyperspy.misc.utils.stack" title="hyperspy.misc.utils.stack"><code class="xref py py-func docutils literal notranslate"><span class="pre">stack()</span></code></a> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id10">
<a class="reference internal image-reference" href="../_images/split_ascent_3_3.png"><img alt="../_images/split_ascent_3_3.png" src="../_images/split_ascent_3_3.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-text">Splitting example.</span><a class="headerlink" href="#id10" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="fast-fourier-transform-fft">
<span id="signal-fft"></span><h3>Fast Fourier Transform (FFT)<a class="headerlink" href="#fast-fourier-transform-fft" title="Permalink to this headline"></a></h3>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Fast_Fourier_transform">fast Fourier transform</a>
of a signal can be computed using the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.fft" title="hyperspy.signal.BaseSignal.fft"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fft()</span></code></a> method. By default,
the FFT is calculated with the origin at (0, 0), which will be displayed at the
bottom left and not in the centre of the FFT. Conveniently, the <code class="docutils literal notranslate"><span class="pre">shift</span></code> argument of the
the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.fft" title="hyperspy.signal.BaseSignal.fft"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fft()</span></code></a> method can be used to center the output of the FFT.
In the following example, the FFT of a hologram is computed using <code class="docutils literal notranslate"><span class="pre">shift=True</span></code> and its
output signal is displayed, which shows that the FFT results in a complex signal with a
real and an imaginary parts:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">reference_hologram</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fft_shifted</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fft_shifted</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/FFT_vacuum_reference_hologram.png"><img alt="../_images/FFT_vacuum_reference_hologram.png" src="../_images/FFT_vacuum_reference_hologram.png" style="width: 800px;" /></a>
</figure>
<p>The strong features in the real and imaginary parts correspond to the lattice fringes of the
hologram.</p>
<p>For visual inspection of the FFT it is convenient to display its power spectrum
(i.e. the square of the absolute value of the FFT) rather than FFT itself as it is done
in the example above by using the <code class="docutils literal notranslate"><span class="pre">power_spectum</span></code> argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">reference_hologram</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fft</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">power_spectum</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> since it is the first argument of the
<a class="reference internal" href="../api/hyperspy._signals.complex_signal.html#hyperspy._signals.complex_signal.ComplexSignal.plot" title="hyperspy._signals.complex_signal.ComplexSignal.plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot()</span></code></a> method for complex signal.
When <code class="docutils literal notranslate"><span class="pre">power_spectrum=True</span></code>, the plot will be displayed on a log scale by default.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/FFT_vacuum_reference_hologram_power_spectrum.png"><img alt="../_images/FFT_vacuum_reference_hologram_power_spectrum.png" src="../_images/FFT_vacuum_reference_hologram_power_spectrum.png" style="width: 400px;" /></a>
</figure>
<p>The visualisation can be further improved by setting the minimum value to display to the 30-th
percentile; this can be done by using <code class="docutils literal notranslate"><span class="pre">vmin=&quot;30th&quot;</span></code> in the plot function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">reference_hologram</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fft</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="s2">&quot;30th&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/FFT_vacuum_reference_hologram_power_spectrum_vmin30th.png"><img alt="../_images/FFT_vacuum_reference_hologram_power_spectrum_vmin30th.png" src="../_images/FFT_vacuum_reference_hologram_power_spectrum_vmin30th.png" style="width: 400px;" /></a>
</figure>
<p>The streaks visible in the FFT come from the edge of the image and can be removed by
applying an <a class="reference external" href="https://en.wikipedia.org/wiki/Apodization">apodization</a> function to the original
signal before the computation of the FFT. This can be done using the <code class="docutils literal notranslate"><span class="pre">apodization</span></code> argument of
the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.fft" title="hyperspy.signal.BaseSignal.fft"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fft()</span></code></a> method and it is usually used for visualising FFT patterns
rather than for quantitative analyses. By default, the so-called <code class="docutils literal notranslate"><span class="pre">hann</span></code> windows is
used but different type of windows such as the <code class="docutils literal notranslate"><span class="pre">hamming</span></code> and <code class="docutils literal notranslate"><span class="pre">tukey</span></code> windows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">reference_hologram</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fft</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fft_apodized</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">apodization</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fft_apodized</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="s2">&quot;30th&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/FFT_vacuum_reference_hologram_power_spectrum_vmin30th-apodization.png"><img alt="../_images/FFT_vacuum_reference_hologram_power_spectrum_vmin30th-apodization.png" src="../_images/FFT_vacuum_reference_hologram_power_spectrum_vmin30th-apodization.png" style="width: 400px;" /></a>
</figure>
</section>
<section id="inverse-fast-fourier-transform-ifft">
<h3>Inverse Fast Fourier Transform (iFFT)<a class="headerlink" href="#inverse-fast-fourier-transform-ifft" title="Permalink to this headline"></a></h3>
<p>Inverse fast Fourier transform can be calculated from a complex signal by using the
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.ifft" title="hyperspy.signal.BaseSignal.ifft"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ifft()</span></code></a> method. Similarly to the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.fft" title="hyperspy.signal.BaseSignal.fft"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fft()</span></code></a> method,
the <code class="docutils literal notranslate"><span class="pre">shift</span></code> argument can be provided to shift the origin of the iFFT when necessary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im_ifft</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="changing-the-data-type">
<span id="signal-change-dtype"></span><h3>Changing the data type<a class="headerlink" href="#changing-the-data-type" title="Permalink to this headline"></a></h3>
<p>Even if the original data is recorded with a limited dynamic range, it is often
desirable to perform the analysis operations with a higher precision.
Conversely, if space is limited, storing in a shorter data type can decrease
the file size. The <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.change_dtype" title="hyperspy.signal.BaseSignal.change_dtype"><code class="xref py py-meth docutils literal notranslate"><span class="pre">change_dtype()</span></code></a> changes the data
type in place, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;EELS Signal1D Signal2D (high-loss).dm3&#39;</span><span class="p">)</span>
<span class="go">    Title: EELS Signal1D Signal2D (high-loss).dm3</span>
<span class="go">    Signal type: EELS</span>
<span class="go">    Data dimensions: (21, 42, 2048)</span>
<span class="go">    Data representation: spectrum</span>
<span class="go">    Data type: float32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">    Title: EELS Signal1D Signal2D (high-loss).dm3</span>
<span class="go">    Signal type: EELS</span>
<span class="go">    Data dimensions: (21, 42, 2048)</span>
<span class="go">    Data representation: spectrum</span>
<span class="go">    Data type: float64</span>
</pre></div>
</div>
<p>In addition to all standard numpy dtypes, HyperSpy supports four extra dtypes
for RGB images <strong>for visualization purposes only</strong>: <code class="docutils literal notranslate"><span class="pre">rgb8</span></code>, <code class="docutils literal notranslate"><span class="pre">rgba8</span></code>,
<code class="docutils literal notranslate"><span class="pre">rgb16</span></code> and <code class="docutils literal notranslate"><span class="pre">rgba16</span></code>. This includes of course multi-dimensional RGB images.</p>
<p>The requirements for changing from and to any <code class="docutils literal notranslate"><span class="pre">rgbx</span></code> dtype are more strict
than for most other dtype conversions. To change to a <code class="docutils literal notranslate"><span class="pre">rgbx</span></code> dtype the
<code class="docutils literal notranslate"><span class="pre">signal_dimension</span></code> must be 1 and its size 3 (4) 3(4) for <code class="docutils literal notranslate"><span class="pre">rgb</span></code> (or
<code class="docutils literal notranslate"><span class="pre">rgba</span></code>) dtypes and the dtype must be <code class="docutils literal notranslate"><span class="pre">uint8</span></code> (<code class="docutils literal notranslate"><span class="pre">uint16</span></code>) for
<code class="docutils literal notranslate"><span class="pre">rgbx8</span></code> (<code class="docutils literal notranslate"><span class="pre">rgbx16</span></code>). After conversion the <code class="docutils literal notranslate"><span class="pre">signal_dimension</span></code> becomes 2.</p>
<p>Most operations on signals with RGB dtypes will fail. For processing simply
change their dtype to <code class="docutils literal notranslate"><span class="pre">uint8</span></code> (<code class="docutils literal notranslate"><span class="pre">uint16</span></code>).The dtype of images of
dtype <code class="docutils literal notranslate"><span class="pre">rgbx8</span></code> (<code class="docutils literal notranslate"><span class="pre">rgbx16</span></code>) can only be changed to <code class="docutils literal notranslate"><span class="pre">uint8</span></code> (<code class="docutils literal notranslate"><span class="pre">uint16</span></code>) and
the <code class="docutils literal notranslate"><span class="pre">signal_dimension</span></code> becomes 1.</p>
<p>In the following example we create a 1D signal with signal size 3 and with
dtype <code class="docutils literal notranslate"><span class="pre">uint16</span></code> and change its dtype to <code class="docutils literal notranslate"><span class="pre">rgb16</span></code> for plotting.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rgb_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ly</span><span class="p">,</span> <span class="n">lx</span> <span class="o">=</span> <span class="n">rgb_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">offset_factor</span> <span class="o">=</span> <span class="mf">0.16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_factor</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ogrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">lx</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">ly</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgb_test</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">lx</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">lx</span><span class="o">*</span><span class="n">offset_factor</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> \
<span class="gp">... </span>                  <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">ly</span><span class="o">*</span><span class="n">offset_factor</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">&lt;</span> \
<span class="gp">... </span>                  <span class="n">lx</span> <span class="o">*</span> <span class="n">ly</span> <span class="o">/</span> <span class="n">size_factor</span> <span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgb_test</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">lx</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">lx</span><span class="o">*</span><span class="n">offset_factor</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> \
<span class="gp">... </span>                  <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">ly</span><span class="o">*</span><span class="n">offset_factor</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">&lt;</span> \
<span class="gp">... </span>                  <span class="n">lx</span> <span class="o">*</span> <span class="n">ly</span> <span class="o">/</span> <span class="n">size_factor</span> <span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgb_test</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">lx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> \
<span class="gp">... </span>                  <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">ly</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">ly</span><span class="o">*</span><span class="n">offset_factor</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> \
<span class="gp">... </span>                  <span class="o">&lt;</span> <span class="n">lx</span> <span class="o">*</span> <span class="n">ly</span> <span class="o">/</span> <span class="n">size_factor</span> <span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgb_test</span> <span class="o">*=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">16</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">rgb_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="s2">&quot;uint16&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (1024, 1024|3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="s2">&quot;rgb16&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal2D, title: , dimensions: (|1024, 1024)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id11">
<a class="reference internal image-reference" href="../_images/rgb_example.png"><img alt="../_images/rgb_example.png" src="../_images/rgb_example.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-text">RGB data type example.</span><a class="headerlink" href="#id11" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="transposing-changing-signal-spaces">
<span id="signal-transpose"></span><h3>Transposing (changing signal spaces)<a class="headerlink" href="#transposing-changing-signal-spaces" title="Permalink to this headline"></a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.1.</span></p>
</div>
<p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.transpose" title="hyperspy.signal.BaseSignal.transpose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transpose()</span></code></a> method changes how the dataset
dimensions are interpreted (as signal or navigation axes). By default is
swaps the signal and navigation axes. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: , dimensions: (5, 4|6)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">&lt;Signal2D, title: , dimensions: (6|4, 5)&gt;</span>
</pre></div>
</div>
<p>For <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.T" title="hyperspy.signal.BaseSignal.T"><code class="xref py py-meth docutils literal notranslate"><span class="pre">T()</span></code></a> is a shortcut for the default behaviour:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>
<span class="go">&lt;Signal2D, title: , dimensions: (6|4, 5)&gt;</span>
</pre></div>
</div>
<p>The method accepts both explicit axes to keep in either space, or just a number
of axes required in one space (just one number can be specified, as the other
is defined as “all other axes”). When axes order is not explicitly defined,
they are “rolled” from one space to the other as if the <code class="docutils literal notranslate"><span class="pre">&lt;navigation</span> <span class="pre">axes</span> <span class="pre">|</span>
<span class="pre">signal</span> <span class="pre">axes</span> <span class="pre">&gt;</span></code> wrap a circle. The example below should help clarifying this.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># just create a signal with many distinct dimensions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (|9, 8, 7, 6, 5, 4, 3, 2, 1)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">signal_axes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># roll to leave 5 axes in signal space</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (4, 3, 2, 1|9, 8, 7, 6, 5)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">navigation_axes</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># roll leave 3 axes in navigation space</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (3, 2, 1|9, 8, 7, 6, 5, 4)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 3 explicitly defined axes in signal space</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">signal_axes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (8, 6, 5, 4, 2, 1|9, 7, 3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># A mix of two lists, but specifying all axes explicitly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The order of axes is preserved in both lists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">navigation_axes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">signal_axes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (8, 7, 6, 5, 4, 1|9, 3, 2)&gt;</span>
</pre></div>
</div>
<p>A convenience functions <a class="reference internal" href="../api/hyperspy.misc.utils.html#hyperspy.misc.utils.transpose" title="hyperspy.misc.utils.transpose"><code class="xref py py-func docutils literal notranslate"><span class="pre">transpose()</span></code></a> is available to operate on
many signals at once, for example enabling plotting any-dimension signals
trivially:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="c1"># 2D signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="c1"># 3D signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s4</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="c1"># 4D signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">plot_images</span><span class="p">(</span><span class="n">hs</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">signal_axes</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p id="signal-transpose-optimize">The <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.transpose" title="hyperspy.signal.BaseSignal.transpose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transpose()</span></code></a> method accepts keyword argument
<code class="docutils literal notranslate"><span class="pre">optimize</span></code>, which is <code class="docutils literal notranslate"><span class="pre">False</span></code> by default, meaning modifying the output
signal data <strong>always modifies the original data</strong> i.e. the data is just a view
of the original data. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the method ensures the data in memory is
stored in the most efficient manner for iterating by making a copy of the data
if required, hence modifying the output signal data <strong>not always modifies the
original data</strong>.</p>
<p>The convenience methods <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.as_signal1D" title="hyperspy.signal.BaseSignal.as_signal1D"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_signal1D()</span></code></a> and
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.as_signal2D" title="hyperspy.signal.BaseSignal.as_signal2D"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_signal2D()</span></code></a> internally use
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.transpose" title="hyperspy.signal.BaseSignal.transpose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transpose()</span></code></a>, but always optimize the data
for iteration over the navigation axes if required. Hence, these methods do not
always return a view of the original data. If a copy of the data is required
use
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.deepcopy" title="hyperspy.signal.BaseSignal.deepcopy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">deepcopy()</span></code></a> on the output of any of these
methods e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span>
<span class="go">&lt;Signal2D, title: , dimensions: (6|4, 5)&gt;</span>
</pre></div>
</div>
</section>
<section id="applying-apodization-window">
<h3>Applying apodization window<a class="headerlink" href="#applying-apodization-window" title="Permalink to this headline"></a></h3>
<p>Apodization window (also known as apodization function) can be applied to a signal
using <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.apply_apodization" title="hyperspy.signal.BaseSignal.apply_apodization"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply_apodization()</span></code></a> method. By default standard
Hann window is used:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sa</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">apply_apodization</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sa</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">General</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Hann window&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sa</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/hann_window.png"><img alt="../_images/hann_window.png" src="../_images/hann_window.png" style="width: 400px;" /></a>
</figure>
<p>Higher order Hann window can be used in order to keep larger fraction of intensity of original signal.
This can be done providing an integer number for the order of the window through
keyword argument <code class="docutils literal notranslate"><span class="pre">hann_order</span></code>. (The last one works only together with default value of <code class="docutils literal notranslate"><span class="pre">window</span></code> argument
or with <code class="docutils literal notranslate"><span class="pre">window='hann'</span></code>.)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">reference_hologram</span><span class="p">()</span><span class="o">.</span><span class="n">isig</span><span class="p">[:</span><span class="mi">200</span><span class="p">,</span> <span class="p">:</span><span class="mi">200</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ima</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">apply_apodization</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="n">hann_order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">plot_images</span><span class="p">([</span><span class="n">im</span><span class="p">,</span> <span class="n">ima</span><span class="p">],</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/hann_3d_order_ref_holo.png"><img alt="../_images/hann_3d_order_ref_holo.png" src="../_images/hann_3d_order_ref_holo.png" style="width: 800px;" /></a>
</figure>
<p>In addition to Hann window also Hamming or Tukey windows can be applied using <code class="docutils literal notranslate"><span class="pre">window</span></code> attribute
selecting <code class="docutils literal notranslate"><span class="pre">'hamming'</span></code> or <code class="docutils literal notranslate"><span class="pre">'tukey'</span></code> respectively.</p>
<p>The shape of Tukey window can be adjusted using parameter alpha
provided through <code class="docutils literal notranslate"><span class="pre">tukey_alpha</span></code> keyword argument (only used when <code class="docutils literal notranslate"><span class="pre">window='tukey'</span></code>).
The parameter represents the fraction of the window inside the cosine tapered region,
i.e. smaller is alpha larger is the middle flat region where the original signal
is preserved. If alpha is one, the Tukey window is equivalent to a Hann window.
(Default value is 0.5)</p>
<p>Apodization can be applied in place by setting keyword argument <code class="docutils literal notranslate"><span class="pre">inplace</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
In this case method will not return anything.</p>
</section>
</section>
<section id="basic-statistical-analysis">
<h2>Basic statistical analysis<a class="headerlink" href="#basic-statistical-analysis" title="Permalink to this headline"></a></h2>
<p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.get_histogram" title="hyperspy.signal.BaseSignal.get_histogram"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_histogram()</span></code></a> computes the histogram and
conveniently returns it as signal instance. It provides methods to
calculate the bins. <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.print_summary_statistics" title="hyperspy.signal.BaseSignal.print_summary_statistics"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print_summary_statistics()</span></code></a>
prints the five-number summary statistics of the data.</p>
<p>These two methods can be combined with
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.get_current_signal" title="hyperspy.signal.BaseSignal.get_current_signal"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_current_signal()</span></code></a> to compute the histogram or
print the summary statistics of the signal at the current coordinates, e.g:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">EELSSpectrum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">print_summary_statistics</span><span class="p">()</span>
<span class="go">Summary statistics</span>
<span class="go">------------------</span>
<span class="go">mean:       0.021</span>
<span class="go">std:        0.957</span>
<span class="go">min:        -3.991</span>
<span class="go">Q1: -0.608</span>
<span class="go">median:     0.013</span>
<span class="go">Q3: 0.652</span>
<span class="go">max:        2.751</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">get_current_signal</span><span class="p">()</span><span class="o">.</span><span class="n">print_summary_statistics</span><span class="p">()</span>
<span class="go">Summary statistics</span>
<span class="go">------------------</span>
<span class="go">mean:   -0.019</span>
<span class="go">std:    0.855</span>
<span class="go">min:    -2.803</span>
<span class="go">Q1: -0.451</span>
<span class="go">median: -0.038</span>
<span class="go">Q3: 0.484</span>
<span class="go">max:    1.992</span>
</pre></div>
</div>
<p>Histogram of different objects can be compared with the functions
<a class="reference internal" href="../api/hyperspy.drawing.utils.html#hyperspy.drawing.utils.plot_histograms" title="hyperspy.drawing.utils.plot_histograms"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_histograms()</span></code></a> (see
<a class="reference internal" href="visualisation.html#plot-spectra"><span class="std std-ref">visualisation</span></a> for the plotting options). For example,
with histograms of several random chi-square distributions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,[</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span> <span class="k">for</span>
<span class="gp">... </span>                           <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">plot_histograms</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id12">
<a class="reference internal image-reference" href="../_images/plot_histograms_chisquare.png"><img alt="../_images/plot_histograms_chisquare.png" src="../_images/plot_histograms_chisquare.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-text">Comparing histograms.</span><a class="headerlink" href="#id12" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="setting-the-noise-properties">
<span id="signal-noise-properties"></span><h2>Setting the noise properties<a class="headerlink" href="#setting-the-noise-properties" title="Permalink to this headline"></a></h2>
<p>Some data operations require the data variance. Those methods use the
<code class="docutils literal notranslate"><span class="pre">metadata.Signal.Noise_properties.variance</span></code> attribute if it exists. You can
set this attribute as in the following example where we set the variance to be
10:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Signal</span><span class="o">.</span><span class="n">set_item</span><span class="p">(</span><span class="s2">&quot;Noise_properties.variance&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also use the functions <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.set_noise_variance" title="hyperspy.signal.BaseSignal.set_noise_variance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_noise_variance()</span></code></a>
and <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.get_noise_variance" title="hyperspy.signal.BaseSignal.get_noise_variance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_noise_variance()</span></code></a> for convenience:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_noise_variance</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">get_noise_variance</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
<p>For heteroscedastic noise the <code class="docutils literal notranslate"><span class="pre">variance</span></code> attribute must be a
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a>.  Poissonian noise is a common case  of
heteroscedastic noise where the variance is equal to the expected value. The
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.estimate_poissonian_noise_variance" title="hyperspy.signal.BaseSignal.estimate_poissonian_noise_variance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate_poissonian_noise_variance()</span></code></a>
method can help setting the variance of data with
semi-Poissonian noise. With the default arguments, this method simply sets the
variance attribute to the given <code class="docutils literal notranslate"><span class="pre">expected_value</span></code>. However, more generally
(although the noise is not strictly Poissonian), the variance may be
proportional to the expected value. Moreover, when the noise is a mixture of
white (Gaussian) and Poissonian noise, the variance is described by the
following linear model:</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/b64bd31fca2efe14aec8958276ccb62823b7164a.png" alt="\mathrm{Var}[X] = (a * \mathrm{E}[X] + b) * c"/></p>
</div></div></blockquote>
<p>Where <cite>a</cite> is the <code class="docutils literal notranslate"><span class="pre">gain_factor</span></code>, <cite>b</cite> is the <code class="docutils literal notranslate"><span class="pre">gain_offset</span></code> (the Gaussian
noise variance) and <cite>c</cite> the <code class="docutils literal notranslate"><span class="pre">correlation_factor</span></code>. The correlation
factor accounts for correlation of adjacent signal elements that can
be modelled as a convolution with a Gaussian point spread function.
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.estimate_poissonian_noise_variance" title="hyperspy.signal.BaseSignal.estimate_poissonian_noise_variance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate_poissonian_noise_variance()</span></code></a> can be used to
set the noise properties when the variance can be described by this linear
model, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_poissonian_noise</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span>
<span class="go">├── General</span>
<span class="go">│   └── title =</span>
<span class="go">└── Signal</span>
<span class="go">    └── signal_type =</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">estimate_poissonian_noise_variance</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span>
<span class="go">├── General</span>
<span class="go">│   └── title =</span>
<span class="go">└── Signal</span>
<span class="go">    ├── Noise_properties</span>
<span class="go">    │   ├── Variance_linear_model</span>
<span class="go">    │   │   ├── correlation_factor = 1</span>
<span class="go">    │   │   ├── gain_factor = 1</span>
<span class="go">    │   │   └── gain_offset = 0</span>
<span class="go">    │   └── variance = &lt;SpectrumSimulation, title: Variance of , dimensions: (|100)&gt;</span>
<span class="go">    └── signal_type =</span>
</pre></div>
</div>
</section>
<section id="speeding-up-operations">
<h2>Speeding up operations<a class="headerlink" href="#speeding-up-operations" title="Permalink to this headline"></a></h2>
<section id="reusing-a-signal-for-output">
<h3>Reusing a Signal for output<a class="headerlink" href="#reusing-a-signal-for-output" title="Permalink to this headline"></a></h3>
<p>Many signal methods create and return a new signal. For fast operations, the
new signal creation time is non-negligible. Also, when the operation is
repeated many times, for example in a loop, the cumulative creation time can
become significant. Therefore, many operations on
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> accept an optional argument <cite>out</cite>. If an
existing signal is passed to <cite>out</cite>, the function output will be placed into
that signal, instead of being returned in a new signal.  The following example
shows how to use this feature to slice a <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a>. It is
important to know that the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> instance passed in
the <cite>out</cite> argument must be well-suited for the purpose. Often this means that
it must have the same axes and data shape as the
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> that would normally be returned by the
operation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_sum</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_sum</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([45])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">s_sum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_sum</span><span class="o">.</span><span class="n">data</span>
<span class="go">array([10])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_roi</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_roi</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|3)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isig</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">s_roi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_roi</span>
<span class="go">&lt;Signal1D, title: , dimensions: (|5)&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="handling-complex-data">
<span id="complex-data-label"></span><h2>Handling complex data<a class="headerlink" href="#handling-complex-data" title="Permalink to this headline"></a></h2>
<p>The HyperSpy <a class="reference internal" href="../api/hyperspy._signals.complex_signal.html#hyperspy._signals.complex_signal.ComplexSignal" title="hyperspy._signals.complex_signal.ComplexSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">ComplexSignal</span></code></a> signal class
and its subclasses for 1-dimensional and 2-dimensional data allow the user to
access complex properties like the <code class="docutils literal notranslate"><span class="pre">real</span></code> and <code class="docutils literal notranslate"><span class="pre">imag</span></code> parts of the data or the
<code class="docutils literal notranslate"><span class="pre">amplitude</span></code> (also known as the modulus) and <code class="docutils literal notranslate"><span class="pre">phase</span></code> (also known as angle or
argument) directly. Getting and setting those properties can be done as
follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">real</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">real</span>      <span class="c1"># real is a new HS signal accessing the same data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">real</span> <span class="o">=</span> <span class="n">new_real</span>  <span class="c1"># new_real can be an array or signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imag</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">imag</span>      <span class="c1"># imag  is a new HS signal accessing the same data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">imag</span> <span class="o">=</span> <span class="n">new_imag</span>  <span class="c1"># new_imag can be an array or signal</span>
</pre></div>
</div>
<p>It is important to note that <cite>data</cite> passed to the constructor of a
<a class="reference internal" href="../api/hyperspy._signals.complex_signal.html#hyperspy._signals.complex_signal.ComplexSignal" title="hyperspy._signals.complex_signal.ComplexSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">ComplexSignal</span></code></a> (or to a subclass), which
is not already complex, will be converted to the numpy standard of
<cite>np.complex</cite>/<cite>np.complex128</cite>. <cite>data</cite> which is already complex will be passed
as is.</p>
<p>To transform a real signal into a complex one use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
</pre></div>
</div>
<p>Changing the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of a complex signal to something real is not clearly
defined and thus not directly possible. Use the <code class="docutils literal notranslate"><span class="pre">real</span></code>, <code class="docutils literal notranslate"><span class="pre">imag</span></code>,
<code class="docutils literal notranslate"><span class="pre">amplitude</span></code> or <code class="docutils literal notranslate"><span class="pre">phase</span></code> properties instead to extract the real data that is
desired.</p>
<section id="calculate-the-angle-phase-argument">
<h3>Calculate the angle / phase / argument<a class="headerlink" href="#calculate-the-angle-phase-argument" title="Permalink to this headline"></a></h3>
<p>The <a class="reference internal" href="../api/hyperspy._signals.complex_signal.html#hyperspy._signals.complex_signal.ComplexSignal.angle" title="hyperspy._signals.complex_signal.ComplexSignal.angle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">angle()</span></code></a> function
can be used to calculate the angle, which is equivalent to using the <code class="docutils literal notranslate"><span class="pre">phase</span></code>
property if no argument is used. If the data is real, the angle will be 0 for
positive values and 2$pi$ for negative values. If the <cite>deg</cite> parameter is set
to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the result will be given in degrees, otherwise in rad (default).
The underlying function is the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.angle.html#numpy.angle" title="(in NumPy v1.22)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.angle()</span></code></a> function.
<a class="reference internal" href="../api/hyperspy._signals.complex_signal.html#hyperspy._signals.complex_signal.ComplexSignal.angle" title="hyperspy._signals.complex_signal.ComplexSignal.angle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">angle()</span></code></a> will return
an appropriate HyperSpy signal.</p>
</section>
<section id="phase-unwrapping">
<h3>Phase unwrapping<a class="headerlink" href="#phase-unwrapping" title="Permalink to this headline"></a></h3>
<p>With the <a class="reference internal" href="../api/hyperspy._signals.complex_signal.html#hyperspy._signals.complex_signal.ComplexSignal.unwrapped_phase" title="hyperspy._signals.complex_signal.ComplexSignal.unwrapped_phase"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unwrapped_phase()</span></code></a>
method the complex phase of a signal can be unwrapped and returned as a new signal.
The underlying method is <a class="reference external" href="https://scikit-image.org/docs/stable/api/skimage.restoration.html#skimage.restoration.unwrap_phase" title="(in skimage v0.19.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">skimage.restoration.unwrap_phase()</span></code></a>, which
uses the algorithm described in <a class="reference internal" href="bibliography.html#herraez"><span class="std std-ref">[Herraez]</span></a>.</p>
</section>
<section id="calculate-and-display-argand-diagram">
<span id="complex-argand"></span><h3>Calculate and display Argand diagram<a class="headerlink" href="#calculate-and-display-argand-diagram" title="Permalink to this headline"></a></h3>
<p>Sometimes it is convenient to visualize a complex signal as a plot of its
imaginary part versus real one. In this case so called Argand diagrams can
be calculated using <code class="xref py py-meth docutils literal notranslate"><span class="pre">argand_diagram()</span></code>
method, which returns the plot as a <a class="reference internal" href="../api/hyperspy._signals.signal2d.html#hyperspy._signals.signal2d.Signal2D" title="hyperspy._signals.signal2d.Signal2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal2D</span></code></a>.
Optional arguments <code class="docutils literal notranslate"><span class="pre">size</span></code> and <code class="docutils literal notranslate"><span class="pre">display_range</span></code> can be used to change the
size (and therefore resolution) of the plot and to change the range for the
display of the plot respectively. The last one is especially useful in order to
zoom into specific regions of the plot or to limit the plot in case of noisy
data points.</p>
<p>An example of calculation of Aragand diagram is <a class="reference internal" href="electron_holography.html#holo-argand-example"><span class="std std-ref">shown for electron
holography data</span></a>.</p>
</section>
<section id="add-a-linear-phase-ramp">
<h3>Add a linear phase ramp<a class="headerlink" href="#add-a-linear-phase-ramp" title="Permalink to this headline"></a></h3>
<p>For 2-dimensional complex images, a linear phase ramp can be added to the
signal via the
<a class="reference internal" href="../api/hyperspy._signals.complex_signal2d.html#hyperspy._signals.complex_signal2d.ComplexSignal2D.add_phase_ramp" title="hyperspy._signals.complex_signal2d.ComplexSignal2D.add_phase_ramp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_phase_ramp()</span></code></a> method.
The parameters <code class="docutils literal notranslate"><span class="pre">ramp_x</span></code> and <code class="docutils literal notranslate"><span class="pre">ramp_y</span></code> dictate the slope of the ramp in <cite>x</cite>-
and <cite>y</cite> direction, while the offset is determined by the <code class="docutils literal notranslate"><span class="pre">offset</span></code> parameter.
The fulcrum of the linear ramp is at the origin and the slopes are given in
units of the axis with the according scale taken into account. Both are
available via the <a class="reference internal" href="../api/hyperspy.axes.html#hyperspy.axes.AxesManager" title="hyperspy.axes.AxesManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">AxesManager</span></code></a> of the signal.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.7.</span></p>
</div>
</section>
</section>
<section id="gpu-support">
<span id="gpu-processing"></span><h2>GPU support<a class="headerlink" href="#gpu-support" title="Permalink to this headline"></a></h2>
<p>GPU processing is supported thanks to the numpy dispatch mechanism of array functions
- read <a class="reference external" href="https://numpy.org/neps/nep-0018-array-function-protocol.html">NEP-18</a>
and <a class="reference external" href="https://numpy.org/neps/nep-0035-array-creation-dispatch-with-array-function.html">NEP-35</a>
for more information. It means that most HyperSpy functions will work on a GPU
if the data is a <a class="reference external" href="https://docs.cupy.dev/en/stable/reference/generated/cupy.ndarray.html#cupy.ndarray" title="(in CuPy v10.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cupy.ndarray</span></code></a> and the required functions are
implemented in <code class="docutils literal notranslate"><span class="pre">cupy</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>GPU processing with hyperspy requires numpy&gt;=1.20 and dask&gt;=2021.3.0, to be
able to use NEP-18 and NEP-35.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cupy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a cupy array (on GPU device)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="gp">... </span><span class="n">cupy</span><span class="o">.</span><span class="n">_core</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">ndarray</span>
</pre></div>
</div>
<p>Two convenience methods are available to transfer data between the host and
the (GPU) device memory:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.to_host" title="hyperspy.signal.BaseSignal.to_host"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_host()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.to_device" title="hyperspy.signal.BaseSignal.to_device"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_device()</span></code></a></p></li>
</ul>
<p>For lazy processing, see the <a class="reference internal" href="big_data.html#big-data-gpu"><span class="std std-ref">corresponding section</span></a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="getting_started.html" class="btn btn-neutral float-left" title="Getting started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="axes.html" class="btn btn-neutral float-right" title="Axes handling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011-2022, The HyperSpy development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>