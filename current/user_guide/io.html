<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Loading and saving data &mdash; HyperSpy 1.7.5 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/hyperspy.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/toggleprompt.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Events" href="events.html" />
    <link rel="prev" title="Electron Holography" href="electron_holography.html" />
 
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-25260850-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            HyperSpy
              <img src="../_static/hyperspy_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.7.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing HyperSpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="signal.html">The Signal class</a></li>
<li class="toctree-l1"><a class="reference internal" href="axes.html">Axes handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive_operations_ROIs.html">Interactive Operations and Region of Interest (ROI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="signal1d.html">Signal1D Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="signal2d.html">Signal2D Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualisation.html">Data visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="mva.html">Machine learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Model fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="eels.html">Electron Energy Loss Spectroscopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="eds.html">Energy-Dispersive X-ray Spectrometry (EDS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="dielectric_function.html">Dielectric function tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="electron_holography.html">Electron Holography</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Loading and saving data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#loading-files-the-load-function">Loading files: the load function</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#loading-multiple-files">Loading multiple files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#saving-data-to-files">Saving data to files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#supported-formats">Supported formats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hspy-hyperspy-s-hdf5-specification">HSpy - HyperSpy’s HDF5 Specification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#extra-saving-arguments">Extra saving arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#zspy-hyperspy-s-zarr-specification">ZSpy - HyperSpy’s Zarr Specification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">Extra saving arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#netcdf">NetCDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mrc">MRC</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mrcz">MRCZ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">Extra saving arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-usage">Example Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#emsa-msa">EMSA/MSA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">Extra saving arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ripple">Ripple</a></li>
<li class="toctree-l3"><a class="reference internal" href="#images">Images</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">Extra saving arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tiff">TIFF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#extra-loading-arguments">Extra loading arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Extra saving arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gatan-digital-micrograph">Gatan Digital Micrograph</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id7">Extra loading arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#edax-team-genesis-spd-and-spc">EDAX TEAM/Genesis SPD and SPC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#extra-loading-arguments-for-spd-file">Extra loading arguments for SPD file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#extra-loading-arguments-for-spd-and-spc-files">Extra loading arguments for SPD and SPC files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fei-tia-ser-and-emi">FEI TIA SER and EMI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">Extra loading arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#semper-unf-binary-format">SEMPER UNF binary format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#blockfile">Blockfile</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">Extra saving arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#denssolutions-formats">DENSsolutions formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#denssolutions-impulse-logfile">DENSsolutions Impulse logfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="#denssolutions-digiheater-logfile">DENSsolutions DigiHeater logfile</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bruker-s-formats">Bruker’s formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bruker-composite-file">Bruker composite file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spx-format">SPX format</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#emd">EMD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#emd-ncem">EMD (NCEM)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#emd-velox">EMD (Velox)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#protochips-log">Protochips log</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usid">USID</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#background">Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reading">Reading</a></li>
<li class="toctree-l4"><a class="reference internal" href="#writing">Writing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nexus">Nexus</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id16">Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#differences-with-respect-to-hspy">Differences with respect to hspy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18">Reading</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id20">Writing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#inspecting">Inspecting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sur-and-pro-format">SUR and PRO format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#empad-format">EMPAD format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#phenom-elid-format">Phenom ELID format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jeol-asw-format">JEOL ASW format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id23">Extra loading arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tvips-format">TVIPS format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id24">Extra loading arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id25">Extra saving arguments</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reading-data-generated-by-hyperspy-using-other-software-packages">Reading data generated by HyperSpy using other software packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#importrpl-digital-micrograph-plugin">ImportRPL Digital Micrograph plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdf5-reader-plugin-for-digital-micrograph">HDF5 reader plugin for Digital Micrograph</a></li>
<li class="toctree-l3"><a class="reference internal" href="#readhyperspyh5-matlab-plugin">readHyperSpyH5 MATLAB Plugin</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="big_data.html">Working with big data</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata_structure.html">Metadata structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/git.html">Using Git and GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/testing.html">Running and writing tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/writing_docs.html">Writing documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/coding_style.html">Coding style</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/lazy_computations.html">Tips for writing methods that work on lazy signals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/speeding_up_code.html">Speeding up code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/writing_extensions.html">Writing packages that extend HyperSpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/useful_information.html">Useful information</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">hyperspy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Credits and citation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing HyperSpy</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HyperSpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Loading and saving data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user_guide/io.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="loading-and-saving-data">
<span id="io"></span><h1><a class="toc-backref" href="#id27" role="doc-backlink">Loading and saving data</a><a class="headerlink" href="#loading-and-saving-data" title="Permalink to this heading"></a></h1>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#loading-and-saving-data" id="id27">Loading and saving data</a></p>
<ul>
<li><p><a class="reference internal" href="#loading-files-the-load-function" id="id28">Loading files: the load function</a></p>
<ul>
<li><p><a class="reference internal" href="#loading-multiple-files" id="id29">Loading multiple files</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#saving-data-to-files" id="id30">Saving data to files</a></p></li>
<li><p><a class="reference internal" href="#supported-formats" id="id31">Supported formats</a></p>
<ul>
<li><p><a class="reference internal" href="#hspy-hyperspy-s-hdf5-specification" id="id32">HSpy - HyperSpy’s HDF5 Specification</a></p></li>
<li><p><a class="reference internal" href="#zspy-hyperspy-s-zarr-specification" id="id33">ZSpy - HyperSpy’s Zarr Specification</a></p></li>
<li><p><a class="reference internal" href="#netcdf" id="id34">NetCDF</a></p></li>
<li><p><a class="reference internal" href="#mrc" id="id35">MRC</a></p></li>
<li><p><a class="reference internal" href="#mrcz" id="id36">MRCZ</a></p></li>
<li><p><a class="reference internal" href="#emsa-msa" id="id37">EMSA/MSA</a></p></li>
<li><p><a class="reference internal" href="#ripple" id="id38">Ripple</a></p></li>
<li><p><a class="reference internal" href="#images" id="id39">Images</a></p></li>
<li><p><a class="reference internal" href="#tiff" id="id40">TIFF</a></p></li>
<li><p><a class="reference internal" href="#gatan-digital-micrograph" id="id41">Gatan Digital Micrograph</a></p></li>
<li><p><a class="reference internal" href="#edax-team-genesis-spd-and-spc" id="id42">EDAX TEAM/Genesis SPD and SPC</a></p></li>
<li><p><a class="reference internal" href="#fei-tia-ser-and-emi" id="id43">FEI TIA SER and EMI</a></p></li>
<li><p><a class="reference internal" href="#semper-unf-binary-format" id="id44">SEMPER UNF binary format</a></p></li>
<li><p><a class="reference internal" href="#blockfile" id="id45">Blockfile</a></p></li>
<li><p><a class="reference internal" href="#denssolutions-formats" id="id46">DENSsolutions formats</a></p></li>
<li><p><a class="reference internal" href="#bruker-s-formats" id="id47">Bruker’s formats</a></p></li>
<li><p><a class="reference internal" href="#emd" id="id48">EMD</a></p></li>
<li><p><a class="reference internal" href="#protochips-log" id="id49">Protochips log</a></p></li>
<li><p><a class="reference internal" href="#usid" id="id50">USID</a></p></li>
<li><p><a class="reference internal" href="#nexus" id="id51">Nexus</a></p></li>
<li><p><a class="reference internal" href="#sur-and-pro-format" id="id52">SUR and PRO format</a></p></li>
<li><p><a class="reference internal" href="#empad-format" id="id53">EMPAD format</a></p></li>
<li><p><a class="reference internal" href="#phenom-elid-format" id="id54">Phenom ELID format</a></p></li>
<li><p><a class="reference internal" href="#jeol-asw-format" id="id55">JEOL ASW format</a></p></li>
<li><p><a class="reference internal" href="#tvips-format" id="id56">TVIPS format</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#reading-data-generated-by-hyperspy-using-other-software-packages" id="id57">Reading data generated by HyperSpy using other software packages</a></p>
<ul>
<li><p><a class="reference internal" href="#importrpl-digital-micrograph-plugin" id="id58">ImportRPL Digital Micrograph plugin</a></p></li>
<li><p><a class="reference internal" href="#hdf5-reader-plugin-for-digital-micrograph" id="id59">HDF5 reader plugin for Digital Micrograph</a></p></li>
<li><p><a class="reference internal" href="#readhyperspyh5-matlab-plugin" id="id60">readHyperSpyH5 MATLAB Plugin</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="loading-files-the-load-function">
<span id="loading-files"></span><h2><a class="toc-backref" href="#id28" role="doc-backlink">Loading files: the load function</a><a class="headerlink" href="#loading-files-the-load-function" title="Permalink to this heading"></a></h2>
<p>HyperSpy can read and write to multiple formats (see <a class="reference internal" href="#supported-formats"><span class="std std-ref">Supported formats</span></a>).
To load data use the <a class="reference internal" href="../api/hyperspy.io.html#hyperspy.io.load" title="hyperspy.io.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a> command. For example, to load the
image spam.jpg you can type:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;spam.jpg&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If loading was successful, the variable <code class="docutils literal notranslate"><span class="pre">s</span></code> contains a HyperSpy signal or any
type of signal defined in on of the <a class="reference internal" href="intro.html#hyperspy-extensions-label"><span class="std std-ref">HyperSpy extensions</span></a>
- see available <a class="reference internal" href="signal.html#transforming-signal-label"><span class="std std-ref">signal subclasses</span></a> for more
information. To list the signal types available on your local installation use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">print_known_signal_types</span><span class="p">()</span>
</pre></div>
</div>
<p>HyperSpy will try to guess the most likely data type for the corresponding
file. However, you can force it to read the data as a particular data type by
providing the <code class="docutils literal notranslate"><span class="pre">signal_type</span></code> keyword, which has to correspond to one of the
available subclasses of signal, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;filename&quot;</span><span class="p">,</span> <span class="n">signal_type</span><span class="o">=</span><span class="s2">&quot;EELS&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If the loaded file contains several datasets, the <a class="reference internal" href="../api/hyperspy.io.html#hyperspy.io.load" title="hyperspy.io.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a>
functions will return a list of the corresponding signals:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;spameggsandham.hspy&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">[&lt;Signal1D, title: spam, dimensions: (32,32|1024)&gt;,</span>
<span class="go">&lt;Signal1D, title: eggs, dimensions: (32,32|1024)&gt;,</span>
<span class="go">&lt;Signal1D, title: ham, dimensions: (32,32|1024)&gt;]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note for python programmers: the data is stored in a numpy array
in the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.data" title="hyperspy.signal.BaseSignal.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a> attribute, but you will not
normally need to access it there.</p>
</div>
<p>HyperSpy will attempt to infer the appropriate file reader to use based on
the file extension (for example. <code class="docutils literal notranslate"><span class="pre">.hspy</span></code>, <code class="docutils literal notranslate"><span class="pre">.emd</span></code> and so on). You can
override this using the <code class="docutils literal notranslate"><span class="pre">reader</span></code> keyword:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load a .hspy file with an unknown extension</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;filename.some_extension&quot;</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="s2">&quot;hspy&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Some file formats store some extra information about the data (metadata) and
HyperSpy reads most of them and stores them in the
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.original_metadata" title="hyperspy.signal.BaseSignal.original_metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">original_metadata</span></code></a> attribute. Also, depending on
the file format, a part of this information will be mapped by HyperSpy to the
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.metadata" title="hyperspy.signal.BaseSignal.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metadata</span></code></a> attribute, where it can be used by
e.g. routines operating on the signal. See <a class="reference internal" href="metadata_structure.html#metadata-structure"><span class="std std-ref">metadata structure</span></a> for details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Extensive metadata can slow down loading and processing, and
loading the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.original_metadata" title="hyperspy.signal.BaseSignal.original_metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">original_metadata</span></code></a> can be disabled
using the <code class="docutils literal notranslate"><span class="pre">load_original_metadata</span></code> argument of the <a class="reference internal" href="../api/hyperspy.io.html#hyperspy.io.load" title="hyperspy.io.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a>
function; in this case, the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.metadata" title="hyperspy.signal.BaseSignal.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metadata</span></code></a> will
still be populated.</p>
</div>
<p>To print the content of the attributes simply use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">original_metadata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.original_metadata" title="hyperspy.signal.BaseSignal.original_metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">original_metadata</span></code></a> and
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.metadata" title="hyperspy.signal.BaseSignal.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metadata</span></code></a> can be exported to text files
using the <a class="reference internal" href="../api/hyperspy.misc.utils.html#hyperspy.misc.utils.DictionaryTreeBrowser.export" title="hyperspy.misc.utils.DictionaryTreeBrowser.export"><code class="xref py py-meth docutils literal notranslate"><span class="pre">export()</span></code></a> method, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">original_metadata</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;parameters&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="deprecated" id="load-to-memory-label">
<p><span class="versionmodified deprecated">Deprecated since version 1.2: </span><code class="docutils literal notranslate"><span class="pre">memmap_dir</span></code> and <code class="docutils literal notranslate"><span class="pre">load_to_memory</span></code> <a class="reference internal" href="../api/hyperspy.io.html#hyperspy.io.load" title="hyperspy.io.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a> keyword
arguments. Use <code class="docutils literal notranslate"><span class="pre">lazy</span></code> instead of <code class="docutils literal notranslate"><span class="pre">load_to_memory</span></code>. <code class="docutils literal notranslate"><span class="pre">lazy</span></code> makes
<code class="docutils literal notranslate"><span class="pre">memmap_dir</span></code> unnecessary.</p>
</div>
<p>Almost all file readers support <cite>lazy</cite> loading, which means accessing the data
without loading it to memory (see <a class="reference internal" href="#supported-formats"><span class="std std-ref">Supported formats</span></a> for a list). This
feature can be useful when analysing large files. To use this feature set
<code class="docutils literal notranslate"><span class="pre">lazy</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;filename.hspy&quot;</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>More details on lazy evaluation support in <a class="reference internal" href="big_data.html#big-data-label"><span class="std std-ref">Working with big data</span></a>.</p>
<p>The units of the navigation and signal axes can be converted automatically
during loading using the <code class="docutils literal notranslate"><span class="pre">convert_units</span></code> parameter. If <cite>True</cite>, the
<code class="docutils literal notranslate"><span class="pre">convert_to_units</span></code> method of the <code class="docutils literal notranslate"><span class="pre">axes_manager</span></code> will be used for the conversion
and if set to <cite>False</cite>, the units will not be converted (default).</p>
<section id="loading-multiple-files">
<span id="load-multiple-label"></span><h3><a class="toc-backref" href="#id29" role="doc-backlink">Loading multiple files</a><a class="headerlink" href="#loading-multiple-files" title="Permalink to this heading"></a></h3>
<p>Rather than loading files individually, several files can be loaded with a
single command. This can be done by passing a list of filenames to the load
functions, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="s2">&quot;file1.hspy&quot;</span><span class="p">,</span> <span class="s2">&quot;file2.hspy&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>or by using <a class="reference external" href="https://docs.python.org/library/glob.html">shell-style wildcards</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;file*.hspy&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, regular expression type character classes can be used such as
<code class="docutils literal notranslate"><span class="pre">[a-z]</span></code> for lowercase letters or <code class="docutils literal notranslate"><span class="pre">[0-9]</span></code> for one digit integers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;file[0-9].hspy&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Wildcards are implemented using <code class="docutils literal notranslate"><span class="pre">glob.glob()</span></code>, which treats <code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">[</span></code>
and <code class="docutils literal notranslate"><span class="pre">]</span></code> as special characters for pattern matching. If your filename or
path contains square brackets, you may want to set
<code class="docutils literal notranslate"><span class="pre">escape_square_brackets=True</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Say there are two files like this:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># /home/data/afile[1x1].hspy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># /home/data/afile[1x2].hspy</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/home/data/afile[*].hspy&quot;</span><span class="p">,</span> <span class="n">escape_square_brackets</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>HyperSpy also supports <code class="docutils literal notranslate"><span class="pre">`pathlib.Path</span></code> &lt;<a class="reference external" href="https://docs.python.org/3/library/pathlib.html">https://docs.python.org/3/library/pathlib.html</a>&gt;`_
objects, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">hyperspy.api</span> <span class="k">as</span> <span class="nn">hs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use pathlib.Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/path/to/a/file.hspy&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use pathlib.Path.glob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/path/to/some/files/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.hspy&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p>By default HyperSpy will return a list of all the files loaded. Alternatively,
by setting <code class="docutils literal notranslate"><span class="pre">stack=True</span></code>, HyperSpy can be instructed to stack the data - given
that the files contain data with exactly the same
dimensions. If this is not the case, an error is raised. If each file contains
multiple (N) signals, N stacks will be created. Here, the number of signals
per file must also match, or an error will be raised.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ls</span>
<span class="go">CL1.raw  CL1.rpl  CL2.raw  CL2.rpl  CL3.raw  CL3.rpl  CL4.raw  CL4.rpl</span>
<span class="go">LL3.raw  LL3.rpl  shift_map-SI3.npy  hdf5/</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;*.rpl&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">[&lt;EELSSpectrum, title: CL1, dimensions: (64, 64, 1024)&gt;,</span>
<span class="go">&lt;EELSSpectrum, title: CL2, dimensions: (64, 64, 1024)&gt;,</span>
<span class="go">&lt;EELSSpectrum, title: CL3, dimensions: (64, 64, 1024)&gt;,</span>
<span class="go">&lt;EELSSpectrum, title: CL4, dimensions: (64, 64, 1024)&gt;,</span>
<span class="go">&lt;EELSSpectrum, title: LL3, dimensions: (64, 64, 1024)&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;*.rpl&#39;</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;EELSSpectrum, title: mva, dimensions: (5, 64, 64, 1024)&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="saving-data-to-files">
<span id="saving-files"></span><h2><a class="toc-backref" href="#id30" role="doc-backlink">Saving data to files</a><a class="headerlink" href="#saving-data-to-files" title="Permalink to this heading"></a></h2>
<p>To save data to a file use the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.save" title="hyperspy.signal.BaseSignal.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a> method. The
first argument is the filename and the format is defined by the filename
extension. If the filename does not contain the extension, the default format
(<a class="reference internal" href="#hspy-format"><span class="std std-ref">HSpy - HyperSpy’s HDF5 Specification</span></a>) is used. For example, if the <code class="xref py py-const docutils literal notranslate"><span class="pre">s</span></code> variable
contains the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal" title="hyperspy.signal.BaseSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSignal</span></code></a> that you want to write to a file,
the following will write the data to a file called <code class="file docutils literal notranslate"><span class="pre">spectrum.hspy</span></code> in the
default <a class="reference internal" href="#hspy-format"><span class="std std-ref">HSpy - HyperSpy’s HDF5 Specification</span></a> format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to save to the <a class="reference internal" href="#ripple-format"><span class="std std-ref">ripple format</span></a> instead, write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;spectrum.rpl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Some formats take extra arguments. See the relevant subsections of
<a class="reference internal" href="#supported-formats"><span class="std std-ref">Supported formats</span></a> for more information.</p>
</section>
<section id="supported-formats">
<span id="id1"></span><h2><a class="toc-backref" href="#id31" role="doc-backlink">Supported formats</a><a class="headerlink" href="#supported-formats" title="Permalink to this heading"></a></h2>
<p>Here is a summary of the different formats that are currently supported by
HyperSpy. The “lazy” column specifies if lazy evaluation is supported.</p>
<table class="docutils align-default" id="id26">
<caption><span class="caption-text">Supported file formats</span><a class="headerlink" href="#id26" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Format</p></th>
<th class="head"><p>Read</p></th>
<th class="head"><p>Write</p></th>
<th class="head"><p>lazy</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Gatan’s dm3</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>Gatan’s dm4</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>FEI’s emi and ser</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>hspy</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>zspy</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>Image: e.g. jpg, png, tif, …</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>TIFF</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>MRC</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>MRCZ</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>EMSA/MSA</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>NetCDF</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>Ripple</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>SEMPER unf</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>Blockfile</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>DENSsolutions’ Impulse log</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>DENSsolutions’ Digiheater log</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>Bruker’s bcf</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>Bruker’s spx</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>EMD (NCEM)</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>EMD (Velox)</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>Protochips log</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>EDAX spc and spd</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>h5USID h5</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>Phenom elid</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>DigitalSurf’s sur and pro</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>Nexus nxs</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>EMPAD xml</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>JEOL asw, map, img, pts, eds</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>TVIPS .tvips</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
</tbody>
</table>
<section id="hspy-hyperspy-s-hdf5-specification">
<span id="hspy-format"></span><h3><a class="toc-backref" href="#id32" role="doc-backlink">HSpy - HyperSpy’s HDF5 Specification</a><a class="headerlink" href="#hspy-hyperspy-s-hdf5-specification" title="Permalink to this heading"></a></h3>
<p>This is the default format and it is the only one that guarantees that no
information will be lost in the writing process and that supports saving data
of arbitrary dimensions. It is based on the <a class="reference external" href="http://www.hdfgroup.org/HDF5/">HDF5 open standard</a>. The HDF5 file format is supported by <a class="reference external" href="http://www.hdfgroup.org/products/hdf5_tools/SWSummarybyName.htm">many
applications</a>.
Part of the specification is documented in <a class="reference internal" href="metadata_structure.html#metadata-structure"><span class="std std-ref">Metadata structure</span></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2: </span>Enable saving HSpy files with the <code class="docutils literal notranslate"><span class="pre">.hspy</span></code> extension. Previously only the
<code class="docutils literal notranslate"><span class="pre">.hdf5</span></code> extension was recognised.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.3: </span>The default extension for the HyperSpy HDF5 specification is now <code class="docutils literal notranslate"><span class="pre">.hspy</span></code>.
The option to change the default is no longer present in <code class="docutils literal notranslate"><span class="pre">preferences</span></code>.</p>
</div>
<p>Only loading of HDF5 files following the HyperSpy specification are supported.
Usually their extension is <code class="docutils literal notranslate"><span class="pre">.hspy</span></code> extension, but older versions of HyperSpy
would save them with the <code class="docutils literal notranslate"><span class="pre">.hdf5</span></code> extension. Both extensions are recognised
by HyperSpy since version 1.2. However, HyperSpy versions older than 1.2
won’t recognise the <code class="docutils literal notranslate"><span class="pre">.hspy</span></code> extension. To
workaround the issue when using old HyperSpy installations simply change the
extension manually to <code class="docutils literal notranslate"><span class="pre">.hdf5</span></code> or
save directly the file using this extension by explicitly adding it to the
filename e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;test.hdf5&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>When saving to <code class="docutils literal notranslate"><span class="pre">hspy</span></code>, all supported objects in the signal’s
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.metadata" title="hyperspy.signal.BaseSignal.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metadata</span></code></a> is stored. This includes lists, tuples and signals.
Please note that in order to increase saving efficiency and speed, if possible,
the inner-most structures are converted to numpy arrays when saved. This
procedure homogenizes any types of the objects inside, most notably casting
numbers as strings if any other strings are present:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># before saving:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">somelist</span>
<span class="go">[1, 2.0, &#39;a name&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># after saving:</span>
<span class="go">[&#39;1&#39;, &#39;2.0&#39;, &#39;a name&#39;]</span>
</pre></div>
</div>
<p>The change of type is done using numpy “safe” rules, so no information is lost,
as numbers are represented to full machine precision.</p>
<p>This feature is particularly useful when using
<a class="reference internal" href="../api/hyperspy._signals.eds.html#hyperspy._signals.eds.EDSSpectrum.get_lines_intensity" title="hyperspy._signals.eds.EDSSpectrum.get_lines_intensity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_lines_intensity()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_SEM_Spectrum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Sample</span><span class="o">.</span><span class="n">intensities</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_lines_intensity</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;EDS_spectrum.hspy&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s_new</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;EDS_spectrum.hspy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_new</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Sample</span><span class="o">.</span><span class="n">intensities</span>
<span class="go">[&lt;BaseSignal, title: X-ray line intensity of EDS SEM Signal1D: Al_Ka at 1.49 keV, dimensions: (|)&gt;,</span>
<span class="go"> &lt;BaseSignal, title: X-ray line intensity of EDS SEM Signal1D: C_Ka at 0.28 keV, dimensions: (|)&gt;,</span>
<span class="go"> &lt;BaseSignal, title: X-ray line intensity of EDS SEM Signal1D: Cu_La at 0.93 keV, dimensions: (|)&gt;,</span>
<span class="go"> &lt;BaseSignal, title: X-ray line intensity of EDS SEM Signal1D: Mn_La at 0.63 keV, dimensions: (|)&gt;,</span>
<span class="go"> &lt;BaseSignal, title: X-ray line intensity of EDS SEM Signal1D: Zr_La at 2.04 keV, dimensions: (|)&gt;]</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.1: </span><code class="docutils literal notranslate"><span class="pre">chunks</span></code> keyword argument</p>
</div>
<p>The hyperspy HDF5 format supports chunking the data into smaller pieces to make it possible to load only part
of a dataset at a time. By default, the data is saved in chunks that are optimised to contain at least one
full signal.  It is possible to
customise the chunk shape using the <code class="docutils literal notranslate"><span class="pre">chunks</span></code> keyword.
For example, to save the data with <code class="docutils literal notranslate"><span class="pre">(20,</span> <span class="pre">20,</span> <span class="pre">256)</span></code> chunks instead of the default <code class="docutils literal notranslate"><span class="pre">(7,</span> <span class="pre">7,</span> <span class="pre">2048)</span></code> chunks
for this signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2048</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test_chunks&quot;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
</pre></div>
</div>
<p>Note that currently it is not possible to pass different customised chunk shapes to all signals and
arrays contained in a signal and its metadata. Therefore, the value of <code class="docutils literal notranslate"><span class="pre">chunks</span></code> provided on saving
will be applied to all arrays contained in the signal.</p>
<p>By passing <code class="docutils literal notranslate"><span class="pre">True</span></code> to <code class="docutils literal notranslate"><span class="pre">chunks</span></code> the chunk shape is guessed using <code class="docutils literal notranslate"><span class="pre">h5py</span></code>’s <code class="docutils literal notranslate"><span class="pre">guess_chunk</span></code> function
what, for large signal spaces usually leads to smaller chunks as <code class="docutils literal notranslate"><span class="pre">guess_chunk</span></code> does not impose the
constrain of storing at least one signal per chunks. For example, for the signal in the example above
passing <code class="docutils literal notranslate"><span class="pre">chunks=True</span></code> results in <code class="docutils literal notranslate"><span class="pre">(7,</span> <span class="pre">7,</span> <span class="pre">256)</span></code> chunks.</p>
<p>Choosing the correct chunk-size can significantly affect the speed of reading, writing and performance of many HyperSpy algorithms.
See the <a class="reference internal" href="big_data.html#big-data-chunking"><span class="std std-ref">chunking section</span></a> for more information.</p>
<section id="extra-saving-arguments">
<h4>Extra saving arguments<a class="headerlink" href="#extra-saving-arguments" title="Permalink to this heading"></a></h4>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">compression</span></code>: One of <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">'gzip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'szip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'lzf'</span></code> (default is <code class="docutils literal notranslate"><span class="pre">'gzip'</span></code>).
<code class="docutils literal notranslate"><span class="pre">'szip'</span></code> may be unavailable as it depends on the HDF5 installation including it.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>HyperSpy uses h5py for reading and writing HDF5 files and, therefore, it
supports all <a class="reference external" href="https://docs.h5py.org/en/stable/high/dataset.html#dataset-compression">compression filters supported by h5py</a>.
The default is <code class="docutils literal notranslate"><span class="pre">'gzip'</span></code>. It is possible to enable other compression filters
such as <code class="docutils literal notranslate"><span class="pre">blosc</span></code> by installing e.g. <a class="reference external" href="https://github.com/silx-kit/hdf5plugin">hdf5plugin</a>.
However, be aware that loading those files will require installing the package
providing the compression filter. If not available an error will be raised.</p>
<p>Compression can significantly increase the saving speed. If file size is not
an issue, it can be disabled by setting <code class="docutils literal notranslate"><span class="pre">compression=None</span></code>. Notice that only
<code class="docutils literal notranslate"><span class="pre">compression=None</span></code> and <code class="docutils literal notranslate"><span class="pre">compression='gzip'</span></code> are available in all platforms,
see the <a class="reference external" href="https://docs.h5py.org/en/stable/faq.html#what-compression-processing-filters-are-supported">h5py documentation</a>
for more details. Therefore, if you choose any other compression filter for
saving a file, be aware that it may not be possible to load it in some platforms.</p>
</div>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">chunks</span></code>: tuple of integer or None. Define the chunking used for saving
the dataset. If None, calculates chunks for the signal, with preferably at
least one chunk per signal space.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">close_file</span></code>: if <code class="docutils literal notranslate"><span class="pre">False</span></code>, doesn’t close the file after writing. The file
should not be closed if the data need to be accessed lazily after saving.
Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write_dataset</span></code>: if <code class="docutils literal notranslate"><span class="pre">False</span></code>, doesn’t write the dataset when writing the file.
This can be useful to overwrite signal attributes only (for example <code class="docutils literal notranslate"><span class="pre">axes_manager</span></code>)
without having to write the whole dataset, which can take time. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</section>
</section>
<section id="zspy-hyperspy-s-zarr-specification">
<span id="zspy-format"></span><h3><a class="toc-backref" href="#id33" role="doc-backlink">ZSpy - HyperSpy’s Zarr Specification</a><a class="headerlink" href="#zspy-hyperspy-s-zarr-specification" title="Permalink to this heading"></a></h3>
<p>Similarly to the <a class="reference internal" href="#hspy-format"><span class="std std-ref">hspy format</span></a>, the zspy format guarantees that no
information will be lost in the writing process and that supports saving data
of arbitrary dimensions. It is based on the <a class="reference external" href="https://zarr.readthedocs.io/en/stable/index.html">Zarr project</a>. Which exists as a drop in
replacement for hdf5 with the intention to fix some of the speed and scaling
issues with the hdf5 format and is therefore suitable for saving <a class="reference internal" href="big_data.html#big-data-saving"><span class="std std-ref">big data</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">BaseSignal</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;test.zspy&#39;</span><span class="p">)</span> <span class="c1"># will save in nested directory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;test.zspy&#39;</span><span class="p">)</span> <span class="c1"># loads the directory</span>
</pre></div>
</div>
<p>When saving to <a class="reference external" href="https://zarr.readthedocs.io/en/stable/index.html">zspy</a>, all supported objects in the signal’s
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.metadata" title="hyperspy.signal.BaseSignal.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metadata</span></code></a> is stored. This includes lists, tuples and signals.
Please note that in order to increase saving efficiency and speed, if possible,
the inner-most structures are converted to numpy arrays when saved. This
procedure homogenizes any types of the objects inside, most notably casting
numbers as strings if any other strings are present:</p>
<p>By default, a <a class="reference external" href="https://zarr.readthedocs.io/en/stable/api/storage.html#zarr.storage.NestedDirectoryStore" title="(in zarr v2.14.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">zarr.storage.NestedDirectoryStore</span></code></a> is used, but other
zarr store can be used by providing a <a class="reference external" href="https://zarr.readthedocs.io/en/stable/api/storage.html">zarr store</a>
instead as argument to the <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.save" title="hyperspy.signal.BaseSignal.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a> or the
<a class="reference internal" href="../api/hyperspy.io.html#hyperspy.io.load" title="hyperspy.io.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a> function. If a zspy file has been saved with a different
store, it would need to be loaded by passing a store of the same type:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">zarr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;test.zspy&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">store</span> <span class="o">=</span> <span class="n">zarr</span><span class="o">.</span><span class="n">LMDBStore</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">store</span><span class="p">)</span> <span class="c1"># saved to LMDB</span>
</pre></div>
</div>
<p>To load this file again</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">zarr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;test.zspy&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">store</span> <span class="o">=</span> <span class="n">zarr</span><span class="o">.</span><span class="n">LMDBStore</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">store</span><span class="p">)</span> <span class="c1"># load from LMDB</span>
</pre></div>
</div>
<section id="id2">
<h4>Extra saving arguments<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h4>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">compressor</span></code>: <a class="reference external" href="https://numcodecs.readthedocs.io/en/stable/index.html?">Numcodecs codec</a>,
a compressor can be passed to the save function to compress the data efficiently. The default
is to call a Blosc compressor object.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numcodecs</span> <span class="kn">import</span> <span class="n">Blosc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compressor</span><span class="o">=</span><span class="n">Blosc</span><span class="p">(</span><span class="n">cname</span><span class="o">=</span><span class="s1">&#39;zstd&#39;</span><span class="p">,</span> <span class="n">clevel</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="n">Blosc</span><span class="o">.</span><span class="n">SHUFFLE</span><span class="p">)</span> <span class="c1"># Used by default</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;test.zspy&#39;</span><span class="p">,</span> <span class="n">compressor</span> <span class="o">=</span> <span class="n">compressor</span><span class="p">)</span> <span class="c1"># will save with Blosc compression</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lazy operations are often i-o bound, reading and writing the data creates a bottle neck in processes
due to the slow read write speed of many hard disks. In these cases, compressing your data is often
beneficial to the speed of some operations. Compression speeds up the process as there is less to
read/write with the trade off of slightly more computational work on the CPU.</p>
</div>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">chunks</span></code>: tuple of integer or None. Define the chunking used for saving
the dataset. If None, calculates chunks for the signal, with preferably at
least one chunk per signal space.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">close_file</span></code>: only relevant for some zarr store (<code class="docutils literal notranslate"><span class="pre">ZipStore</span></code>, <code class="docutils literal notranslate"><span class="pre">DBMStore</span></code>)
requiring store to flush data to disk. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, doesn’t close the file
after writing. The file should not be closed if the data need to be accessed
lazily after saving.
Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write_dataset</span></code>: if <code class="docutils literal notranslate"><span class="pre">False</span></code>, doesn’t write the dataset when writing the file.
This can be useful to overwrite signal attributes only (for example <code class="docutils literal notranslate"><span class="pre">axes_manager</span></code>)
without having to write the whole dataset, which can take time. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</section>
</section>
<section id="netcdf">
<span id="netcdf-format"></span><h3><a class="toc-backref" href="#id34" role="doc-backlink">NetCDF</a><a class="headerlink" href="#netcdf" title="Permalink to this heading"></a></h3>
<p>This was the default format in HyperSpy’s predecessor, EELSLab, but it has been
superseded by <a class="reference internal" href="#hspy-format"><span class="std std-ref">HSpy - HyperSpy’s HDF5 Specification</span></a> in HyperSpy. We provide only reading capabilities
but we do not support writing to this format.</p>
<p>Note that only NetCDF files written by EELSLab are supported.</p>
<p>To use this format a python netcdf interface must be installed manually because
it is not installed by default when using the automatic installers.</p>
</section>
<section id="mrc">
<span id="mrc-format"></span><h3><a class="toc-backref" href="#id35" role="doc-backlink">MRC</a><a class="headerlink" href="#mrc" title="Permalink to this heading"></a></h3>
<p>This is a format widely used for tomographic data. Our implementation is based
on <a class="reference external" href="https://www2.mrc-lmb.cam.ac.uk/research/locally-developed-software/image-processing-software/">this specification</a>. We also
partly support FEI’s custom header. We do not provide writing features for this
format, but, as it is an open format, we may implement this feature in the
future on demand.</p>
<p>For mrc files <code class="docutils literal notranslate"><span class="pre">load</span></code> takes the <code class="docutils literal notranslate"><span class="pre">mmap_mode</span></code> keyword argument enabling
loading the file using a different mode (default is copy-on-write) . However,
note that lazy loading does not support in-place writing (i.e lazy loading and
the “r+” mode are incompatible).</p>
</section>
<section id="mrcz">
<span id="mrcz-format"></span><h3><a class="toc-backref" href="#id36" role="doc-backlink">MRCZ</a><a class="headerlink" href="#mrcz" title="Permalink to this heading"></a></h3>
<p>MRCZ is an extension of the CCP-EM MRC2014 file format. <a class="reference external" href="http://www.ccpem.ac.uk/mrc_format/mrc2014.php">CCP-EM MRC2014</a> file format.  It uses the
<cite>blosc</cite> meta-compression library to bitshuffle and compress files in a blocked,
multi-threaded environment. The supported data types are:</p>
<p>[<cite>float32</cite>,`int8`,`uint16`,`int16`,`complex64`]</p>
<p>It supports arbitrary meta-data, which is serialized into JSON.</p>
<p>MRCZ also supports asynchronous reads and writes.</p>
<p>Repository: <a class="reference external" href="https://github.com/em-MRCZ">https://github.com/em-MRCZ</a>
PyPI:       <a class="reference external" href="https://pypi.python.org/pypi/mrcz">https://pypi.python.org/pypi/mrcz</a>
Citation:   Submitted.
Preprint:   <a class="reference external" href="http://www.biorxiv.org/content/early/2017/03/13/116533">http://www.biorxiv.org/content/early/2017/03/13/116533</a></p>
<p>Support for this format is not enabled by default. In order to enable it
install the <cite>mrcz</cite> and optionally the <cite>blosc</cite> Python packages.</p>
<section id="id3">
<h4>Extra saving arguments<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">do_async</span></code>: currently supported within HyperSpy for writing only, this will
save  the file in a background thread and return immediately. Defaults
to <cite>False</cite>.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There is no method currently implemented within Hyperspy to tell if an
asychronous write has finished.</p>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">compressor</span></code>: The compression codec, one of [<cite>None</cite>,`’zlib`’,`’zstd’<cite>, `’lz4’</cite>].
Defaults to <cite>None</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clevel</span></code>: The compression level, an <cite>int</cite> from 1 to 9. Defaults to 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_threads</span></code>: The number of threads to use for ‘blosc’ compression. Defaults to
the maximum number of virtual cores (including Intel Hyperthreading)
on your system, which is recommended for best performance. If <code class="docutils literal notranslate"><span class="pre">do_async</span> <span class="pre">=</span> <span class="pre">True</span></code> you may wish to leave one thread free for the
Python GIL.</p></li>
</ul>
<p>The recommended compression codec is ‘zstd’ (zStandard) with <cite>clevel=1</cite> for
general use. If speed is critical, use ‘lz4’ (LZ4) with <cite>clevel=9</cite>. Integer data
compresses more redably than floating-point data, and in general the histogram
of values in the data reflects how compressible it is.</p>
<p>To save files that are compatible with other programs that can use MRC such as
GMS, IMOD, Relion, MotionCorr, etc. save with <cite>compressor=None</cite>, extension <cite>.mrc</cite>.
JSON metadata will not be recognized by other MRC-supporting software but should
not cause crashes.</p>
</section>
<section id="example-usage">
<h4>Example Usage<a class="headerlink" href="#example-usage" title="Permalink to this heading"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file.mrcz&#39;</span><span class="p">,</span> <span class="n">do_async</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compressor</span><span class="o">=</span><span class="s1">&#39;zstd&#39;</span><span class="p">,</span> <span class="n">clevel</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">new_signal</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;file.mrcz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="emsa-msa">
<span id="msa-format"></span><h3><a class="toc-backref" href="#id37" role="doc-backlink">EMSA/MSA</a><a class="headerlink" href="#emsa-msa" title="Permalink to this heading"></a></h3>
<p>This <a class="reference external" href="https://www.microscopy.org/resources/scientific_data/index.cfm">open standard format</a>
is widely used to exchange single spectrum data, but it does not support
multidimensional data. It can be used to exchange single spectra with Gatan’s
Digital Micrograph.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If several spectra are loaded and stacked (<code class="docutils literal notranslate"><span class="pre">hs.load('pattern',</span> <span class="pre">stack_signals=True</span></code>)
the calibration read from the first spectrum and applied to all other spectra.</p>
</div>
<section id="id4">
<h4>Extra saving arguments<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h4>
<p>For the MSA format the <code class="docutils literal notranslate"><span class="pre">format</span></code> argument is used to specify whether the
energy axis should also be saved with the data.  The default, ‘Y’ omits the
energy axis in the file.  The alternative, ‘XY’, saves a second column with the
calibrated energy data. It  is possible to personalise the separator with the
<cite>separator</cite> keyword.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>However, if a different separator is chosen the resulting file will not
comply with the MSA/EMSA standard and HyperSpy and other software may not
be able to read it.</p>
</div>
<p>The default encoding is <cite>latin-1</cite>. It is possible to set a different encoding
using the <cite>encoding</cite> argument, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file.msa&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="ripple">
<span id="ripple-format"></span><h3><a class="toc-backref" href="#id38" role="doc-backlink">Ripple</a><a class="headerlink" href="#ripple" title="Permalink to this heading"></a></h3>
<p>This <em>open standard format</em> developed at NIST as native format for
<a class="reference external" href="http://www.nist.gov/lispix/">Lispix</a> is widely used to exchange
multidimensional data. However, it only supports data of up to three
dimensions. It can also be used to exchange data with Bruker and used in
combination with the <a class="reference internal" href="#import-rpl"><span class="std std-ref">ImportRPL Digital Micrograph plugin</span></a> it is very useful for exporting data
to Gatan’s Digital Micrograph.</p>
<p>The default encoding is latin-1. It is possible to set a different encoding
using the encoding argument, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file.rpl&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For mrc files <code class="docutils literal notranslate"><span class="pre">load</span></code> takes the <code class="docutils literal notranslate"><span class="pre">mmap_mode</span></code> keyword argument enabling
loading the file using a different mode (default is copy-on-write) . However,
note that lazy loading does not support in-place writing (i.e lazy loading and
the “r+” mode are incompatible).</p>
</section>
<section id="images">
<span id="image-format"></span><h3><a class="toc-backref" href="#id39" role="doc-backlink">Images</a><a class="headerlink" href="#images" title="Permalink to this heading"></a></h3>
<p>HyperSpy can read and write data to <a class="reference external" href="https://imageio.readthedocs.io/en/stable/formats.html">all the image formats</a> supported by
<cite>imageio</cite>, which uses the Python Image Library  (PIL/pillow).
This includes png, pdf, gif, etc.
It is important to note that these image formats only support 8-bit files, and
therefore have an insufficient dynamic range for most scientific applications.
It is therefore highly discouraged to use any general image format (with the
exception of <a class="reference internal" href="#tiff-format"><span class="std std-ref">TIFF</span></a> which uses another library) to store data for
analysis purposes.</p>
<section id="id5">
<h4>Extra saving arguments<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h4>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">scalebar</span></code> (bool, optional): Export the image with a scalebar. Default
is False.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scalebar_kwds</span></code> (dict, optional): dictionary of keyword arguments for the
scalebar. Useful to set formattiong, location, etc. of the scalebar. See the
<a class="reference external" href="https://pypi.org/project/matplotlib-scalebar/">matplotlib-scalebar</a>
documentation for more information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_size</span></code> : (int, tuple of length 2 or None, optional): the output size
of the image in pixels:</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">int</span></code>, defines the width of the image, the height is
determined from the aspect ratio of the image.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">tuple</span></code> of length 2, defines the width and height of the
image. Padding with white pixels is used to maintain the aspect
ratio of the image.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the size of the data is used.</p></li>
</ul>
<p>For output sizes larger than the data size, “nearest” interpolation is
used by default and this behaviour can be changed through the
<code class="docutils literal notranslate"><span class="pre">imshow_kwds</span></code> dictionary.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">imshow_kwds</span></code> (dict, optional):  Keyword arguments dictionary for
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="(in Matplotlib v3.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">imshow()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwds</span></code> : keyword arguments supported by the individual file
writers as documented at
<a class="reference external" href="https://imageio.readthedocs.io/en/stable/formats.html">https://imageio.readthedocs.io/en/stable/formats.html</a> when exporting
an image without scalebar. When exporting with a scalebar, the keyword
arguments are passed to the <cite>pil_kwargs</cite> dictionary of
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.savefig.html#matplotlib.pyplot.savefig" title="(in Matplotlib v3.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.savefig()</span></code></a></p></li>
</ul>
<p>When saving an image, a scalebar can be added to the image and the formatting,
location, etc. of the scalebar can be set using the <code class="docutils literal notranslate"><span class="pre">scalebar_kwds</span></code>
arguments:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file.jpg&#39;</span><span class="p">,</span> <span class="n">scalebar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file.jpg&#39;</span><span class="p">,</span> <span class="n">scalebar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scalebar_kwds</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;location&#39;</span><span class="p">:</span><span class="s1">&#39;lower right&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>In the example above, the image is created using
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="(in Matplotlib v3.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">imshow()</span></code></a>, and additional keyword arguments can be
passed to this function using <code class="docutils literal notranslate"><span class="pre">imshow_kwds</span></code>. For example, this can be used
to save an image displayed using a matplotlib colormap:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file.jpg&#39;</span><span class="p">,</span> <span class="n">imshow_kwds</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>The resolution of the exported image can be adjusted:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file.jpg&#39;</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="tiff">
<span id="tiff-format"></span><h3><a class="toc-backref" href="#id40" role="doc-backlink">TIFF</a><a class="headerlink" href="#tiff" title="Permalink to this heading"></a></h3>
<p>HyperSpy can read and write 2D and 3D TIFF files using using
Christoph Gohlke’s <code class="docutils literal notranslate"><span class="pre">tifffile</span></code> library. In particular, it supports reading and
writing of TIFF, BigTIFF, OME-TIFF, STK, LSM, NIH, and FluoView files. Most of
these are uncompressed or losslessly compressed 2**(0 to 6) bit integer, 16, 32
and 64-bit float, grayscale and RGB(A) images, which are commonly used in
bio-scientific imaging. See <a class="reference external" href="http://www.lfd.uci.edu/~gohlke/code/tifffile.py.html">the library webpage</a> for more details.</p>
<p>Currently HyperSpy has limited support for reading and saving the TIFF tags.
However, the way that HyperSpy reads and saves the scale and the units of TIFF
files is compatible with ImageJ/Fiji and Gatan Digital Micrograph software.
HyperSpy can also import the scale and the units from TIFF files saved using
FEI, Zeiss SEM, Olympus SIS, Jeol SightX and Hamamatsu HPD-TA (streak camera)
software.</p>
<section id="extra-loading-arguments">
<h4>Extra loading arguments<a class="headerlink" href="#extra-loading-arguments" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">force_read_resolution</span></code> (bool, optional): Force read image resolution using
the x_resolution, y_resolution and resolution_unit tags of the TIFF. Beware:
most software don’t (properly) use these tags when saving TIFF files. Default
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hamamatsu_streak_axis_type</span></code> (str, optional): decide the type of the
time axis for hamamatsu streak files:</p>
<ul>
<li><p>if <code class="docutils literal notranslate"><span class="pre">uniform</span></code>, the best-fit linear axis is used, inducing a (small)
linearisation error. Initialise a UniformDataAxis.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">data</span></code>, the raw time axis parsed from the metadata is used. Initialise
a DataAxis.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">functional</span></code>, the best-fit 3rd-order polynomial axis is used, avoiding
linearisation error. Initialise a FunctionalDataAxis.</p></li>
</ul>
</li>
</ul>
<p>By default, <code class="docutils literal notranslate"><span class="pre">uniform</span></code> is used but a warning of the linearisation error is issued.
Explicitly passing <code class="docutils literal notranslate"><span class="pre">hamamatsu_streak_axis_type='uniform'</span></code> suppresses the warning.
In all cases, the original axis values are stored in the <code class="docutils literal notranslate"><span class="pre">original_metadata</span></code> of the
signal object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Force read image resolution using the x_resolution, y_resolution and</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the resolution_unit of the TIFF tags.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;file.tif&#39;</span><span class="p">,</span> <span class="n">force_read_resolution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load a non-uniform axis from a hamamatsu streak file:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;file.tif&#39;</span><span class="p">,</span> <span class="n">hamamatsu_streak_axis_type</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id6">
<h4>Extra saving arguments<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">extratags</span></code> (tuple, optional): save custom tags through the</dt><dd><p><code class="docutils literal notranslate"><span class="pre">tifffile</span></code> library. Must conform to a specific convention
(see <code class="docutils literal notranslate"><span class="pre">tifffile</span></code> documentation and example below).</p>
</dd>
</dl>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Saving the string &#39;Random metadata&#39; in a custom tag (ID 65000)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extratag</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">65000</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Random metadata&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file.tif&#39;</span><span class="p">,</span> <span class="n">extratags</span><span class="o">=</span><span class="n">extratag</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Saving the string &#39;Random metadata&#39; from a custom tag (ID 65000)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;file.tif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span><span class="o">.</span><span class="n">original_metadata</span><span class="p">[</span><span class="s1">&#39;Number_65000&#39;</span><span class="p">]</span>
<span class="go">b&#39;Random metadata&#39;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The file will be saved with the same bit depth as the signal. Since
most processing operations in HyperSpy and numpy will result in 64-bit
floats, this can result in 64-bit <code class="docutils literal notranslate"><span class="pre">.tiff</span></code> files, which are not always
compatible with other imaging software.</p>
<p>You can first change the dtype of the signal before saving:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;float64&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">change_dtype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;float32&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file.tif&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="gatan-digital-micrograph">
<span id="dm3-format"></span><h3><a class="toc-backref" href="#id41" role="doc-backlink">Gatan Digital Micrograph</a><a class="headerlink" href="#gatan-digital-micrograph" title="Permalink to this heading"></a></h3>
<p>HyperSpy can read both dm3 and dm4 files but the reading features are not
complete (and probably they will remain so unless Gatan releases the
specifications of the format). That said, we understand that this is an
important feature and if loading a particular Digital Micrograph file fails for
you, please report it as an issue in the <a class="reference external" href="https://github.com/hyperspy/hyperspy/issues">issues tracker</a> to make
us aware of the problem.</p>
<p>Some of the tags in the DM-files are added to the metadata of the signal
object. This includes, microscope information and certain parameters for EELS,
EDS and CL signals.</p>
<section id="id7">
<h4>Extra loading arguments<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">optimize</span></code>: bool, default is True. During loading, the data is replaced by its
<a class="reference internal" href="signal.html#signal-transpose-optimize"><span class="std std-ref">optimized copy</span></a> to speed up operations,
e. g. iteration over navigation axes. The cost of this speed improvement is to
double the memory requirement during data loading.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It has been reported that in some versions of Gatan Digital Micrograph,
any binned data stores the _averages_ of the binned channels or pixels,
rather than the _sum_, which would be required for proper statistical
analysis. We therefore strongly recommend that all binning is performed
using Hyperspy where possible.</p>
<p>See the original <a class="reference external" href="https://github.com/hyperspy/hyperspy/issues/1624">bug report here</a>.</p>
</div>
</section>
</section>
<section id="edax-team-genesis-spd-and-spc">
<span id="edax-format"></span><h3><a class="toc-backref" href="#id42" role="doc-backlink">EDAX TEAM/Genesis SPD and SPC</a><a class="headerlink" href="#edax-team-genesis-spd-and-spc" title="Permalink to this heading"></a></h3>
<p>HyperSpy can read both <code class="docutils literal notranslate"><span class="pre">.spd</span></code> (spectrum image) and <code class="docutils literal notranslate"><span class="pre">.spc</span></code> (single spectra)
files from the EDAX TEAM software and its predecessor EDAX Genesis.
If reading an <code class="docutils literal notranslate"><span class="pre">.spd</span></code> file, the calibration of the
spectrum image is loaded from the corresponding <code class="docutils literal notranslate"><span class="pre">.ipr</span></code> and <code class="docutils literal notranslate"><span class="pre">.spc</span></code> files
stored in the same directory, or from specific files indicated by the user.
If these calibration files are not available, the data from the <code class="docutils literal notranslate"><span class="pre">.spd</span></code>
file will still be loaded, but with no spatial or energy calibration.
If elemental information has been defined in the spectrum image, those
elements will automatically be added to the signal loaded by HyperSpy.</p>
<p>Currently, loading an EDAX TEAM spectrum or spectrum image will load an
<code class="docutils literal notranslate"><span class="pre">EDSSEMSpectrum</span></code> Signal. If support for TEM EDS data is needed, please
open an issue in the <a class="reference external" href="https://github.com/hyperspy/hyperspy/issues">issues tracker</a> to
alert the developers of the need.</p>
<p>For further reference, file specifications for the formats are
available publicly available from EDAX and are on Github
(<a class="reference external" href="https://github.com/hyperspy/hyperspy/files/29506/SPECTRUM-V70.pdf">.spc</a>,
<a class="reference external" href="https://github.com/hyperspy/hyperspy/files/29505/SpcMap-spd.file.format.pdf">.spd</a>, and
<a class="reference external" href="https://github.com/hyperspy/hyperspy/files/29507/ImageIPR.pdf">.ipr</a>).</p>
<section id="extra-loading-arguments-for-spd-file">
<h4>Extra loading arguments for SPD file<a class="headerlink" href="#extra-loading-arguments-for-spd-file" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">spc_fname</span></code>: {None, str}, name of file from which to read the spectral calibration. If data was exported fully from EDAX TEAM software, an .spc file with the same name as the .spd should be present. If <cite>None</cite>, the default filename will be searched for. Otherwise, the name of the <code class="docutils literal notranslate"><span class="pre">.spc</span></code> file to use for calibration can be explicitly given as a string.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ipr_fname</span></code>: {None, str}, name of file from which to read the spatial calibration. If data was exported fully from EDAX TEAM software, an <code class="docutils literal notranslate"><span class="pre">.ipr</span></code> file with the same name as the <code class="docutils literal notranslate"><span class="pre">.spd</span></code> (plus a “_Img” suffix) should be present.  If <cite>None</cite>, the default filename will be searched for. Otherwise, the name of the <code class="docutils literal notranslate"><span class="pre">.ipr</span></code> file to use for spatial calibration can be explicitly given as a string.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>: remaining arguments are passed to the Numpy <code class="docutils literal notranslate"><span class="pre">memmap</span></code> function.</p></li>
</ul>
</section>
<section id="extra-loading-arguments-for-spd-and-spc-files">
<h4>Extra loading arguments for SPD and SPC files<a class="headerlink" href="#extra-loading-arguments-for-spd-and-spc-files" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">load_all_spc</span></code> : bool, switch to control if all of the <code class="docutils literal notranslate"><span class="pre">.spc</span></code> header is
read, or just the important parts for import into HyperSpy.</p></li>
</ul>
</section>
</section>
<section id="fei-tia-ser-and-emi">
<span id="fei-format"></span><h3><a class="toc-backref" href="#id43" role="doc-backlink">FEI TIA SER and EMI</a><a class="headerlink" href="#fei-tia-ser-and-emi" title="Permalink to this heading"></a></h3>
<p>HyperSpy can read <code class="docutils literal notranslate"><span class="pre">ser</span></code> and <code class="docutils literal notranslate"><span class="pre">emi</span></code> files but the reading features are not
complete (and probably they will be unless FEI releases the specifications of
the format). That said we know that this is an important feature and if loading
a particular ser or emi file fails for you, please report it as an issue in the
<a class="reference external" href="https://github.com/hyperspy/hyperspy/issues">issues tracker</a> to make us
aware of the problem.</p>
<p>HyperSpy (unlike TIA) can read data directly from the <code class="docutils literal notranslate"><span class="pre">.ser</span></code> files. However,
by doing so, the information that is stored in the emi file is lost.
Therefore strongly recommend to load using the <code class="docutils literal notranslate"><span class="pre">.emi</span></code> file instead.</p>
<p>When reading an <code class="docutils literal notranslate"><span class="pre">.emi</span></code> file if there are several <code class="docutils literal notranslate"><span class="pre">.ser</span></code> files associated
with it, all of them will be read and returned as a list.</p>
<section id="id8">
<h4>Extra loading arguments<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">only_valid_data</span></code> : bool, in case of series or linescan data with the
acquisition stopped before the end: if True, load only the acquired data.
If False, the empty data are filled with zeros. The default is False and this
default value will change to True in version 2.0.</p></li>
</ul>
</section>
</section>
<section id="semper-unf-binary-format">
<span id="unf-format"></span><h3><a class="toc-backref" href="#id44" role="doc-backlink">SEMPER UNF binary format</a><a class="headerlink" href="#semper-unf-binary-format" title="Permalink to this heading"></a></h3>
<p>SEMPER is a fully portable system of programs for image processing, particularly
suitable for applications in electron microscopy developed by Owen Saxton (see
DOI: 10.1016/S0304-3991(79)80044-3 for more information). The unf format is a
binary format with an extensive header for up to 3 dimensional data.
HyperSpy can read and write unf-files and will try to convert the data into a
fitting BaseSignal subclass, based on the information stored in the label.
Currently version 7 of the format should be fully supported.</p>
</section>
<section id="blockfile">
<span id="blockfile-format"></span><h3><a class="toc-backref" href="#id45" role="doc-backlink">Blockfile</a><a class="headerlink" href="#blockfile" title="Permalink to this heading"></a></h3>
<p>HyperSpy can read and write the blockfile format from NanoMegas ASTAR software.
It is used to store a series of diffraction patterns from scanning precession
electron diffraction (SPED) measurements, with a limited set of metadata. The
header of the blockfile contains information about centering and distortions
of the diffraction patterns, but is not applied to the signal during reading.
Blockfiles only support data values of type
<a class="reference external" href="http://docs.scipy.org/doc/numpy/user/basics.types.html">np.uint8</a> (integers
in range 0-255).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>While Blockfiles are supported, it is a proprietary format, and future
versions of the format might therefore not be readable. Complete
interoperability with the official software can neither be guaranteed.</p>
</div>
<p>Blockfiles are by default loaded in a “copy-on-write” manner using
<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.memmap.html">numpy.memmap</a> .
For blockfiles <code class="docutils literal notranslate"><span class="pre">load</span></code> takes the <code class="docutils literal notranslate"><span class="pre">mmap_mode</span></code> keyword argument enabling
loading the file using a different mode. However, note that lazy loading
does not support in-place writing (i.e lazy loading and the “r+” mode
are incompatible).</p>
<section id="id9">
<h4>Extra saving arguments<a class="headerlink" href="#id9" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">intensity_scaling</span></code> : in case the dataset that needs to be saved does not
have the <cite>np.uint8</cite> data type, casting to this datatype without intensity
rescaling results in overflow errors (default behavior). This option allows
you to perform linear intensity scaling of the images prior to saving the
data. The options are:</p>
<ul>
<li><p><cite>‘dtype’</cite>: the limits of the datatype of the dataset, e.g. 0-65535 for
<cite>np.uint16</cite>, are mapped onto 0-255 respectively. Does not work for <cite>float</cite>
data types.</p></li>
<li><p><cite>‘minmax’</cite>: the minimum and maximum in the dataset are mapped to 0-255.</p></li>
<li><p><cite>‘crop’</cite>: everything below 0 and above 255 is set to 0 and 255 respectively</p></li>
<li><p>2-tuple of <cite>floats</cite> or <cite>ints</cite>: the intensities between these values are
scaled between 0-255, everything below is 0 and everything above is 255.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">navigator_signal</span></code>: the BLO file also stores a virtual bright field (VBF) image which
behaves like a navigation signal in the ASTAR software. By default this is
set to <cite>‘navigator’</cite>, which results in the default <code class="xref py py-attr docutils literal notranslate"><span class="pre">navigator</span></code> signal to be used.
If this signal was not calculated before (e.g. by calling <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.plot" title="hyperspy.signal.BaseSignal.plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot()</span></code></a>), it is
calculated when <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.save" title="hyperspy.signal.BaseSignal.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a> is called, which can be time consuming.
Alternatively, setting the argument to <cite>None</cite> will result in a correctly sized
zero array to be used. Finally, a custom <code class="docutils literal notranslate"><span class="pre">Signal2D</span></code> object can be passed,
but the shape must match the navigation dimensions.</p></li>
</ul>
</section>
</section>
<section id="denssolutions-formats">
<span id="dens-format"></span><h3><a class="toc-backref" href="#id46" role="doc-backlink">DENSsolutions formats</a><a class="headerlink" href="#denssolutions-formats" title="Permalink to this heading"></a></h3>
<p>HyperSpy can read any logfile from DENSsolutions’ new Impulse software as well as the legacy heating software DigiHeater.</p>
<section id="denssolutions-impulse-logfile">
<h4>DENSsolutions Impulse logfile<a class="headerlink" href="#denssolutions-impulse-logfile" title="Permalink to this heading"></a></h4>
<p>Impulse logfiles are stored in csv format. All metadata linked to the experiment is stored in a separate metadata.log file.
This metadata file contains crucial information about the experiment and should be included in the same folder with the csv file when reading data into Hyperspy.</p>
<p>To read Impulse logfiles, use the reader argument to define the correct file reader:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;filename.csv&quot;</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="s2">&quot;impulse&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="denssolutions-digiheater-logfile">
<h4>DENSsolutions DigiHeater logfile<a class="headerlink" href="#denssolutions-digiheater-logfile" title="Permalink to this heading"></a></h4>
<p>HyperSpy can read the heater log format from the DENSsolutions’ DigiHeater software. The format stores all the captured data for each timestamp, together with a small header in a plain-text format. The reader extracts the measured temperature along the time axis, as well as the date and calibration constants stored in the header.</p>
</section>
</section>
<section id="bruker-s-formats">
<h3><a class="toc-backref" href="#id47" role="doc-backlink">Bruker’s formats</a><a class="headerlink" href="#bruker-s-formats" title="Permalink to this heading"></a></h3>
<p>Bruker’s Esprit(TM) software and hardware allows to acquire and save the data
in different kind of formats. Hyperspy can read two main basic formats: bcf
and spx.</p>
<section id="bruker-composite-file">
<span id="bcf-format"></span><h4>Bruker composite file<a class="headerlink" href="#bruker-composite-file" title="Permalink to this heading"></a></h4>
<p>HyperSpy can read “hypermaps” saved with Bruker’s Esprit v1.x or v2.x in bcf
hybrid (virtual file system/container with xml and binary data, optionally
compressed) format. Most bcf import functionality is implemented. Both
high-resolution 16-bit SEM images and hyperspectral EDX data can be retrieved
simultaneously.</p>
<p>BCF can look as all inclusive format, however it does not save some key EDX
parameters: any of dead/live/real times, FWHM at Mn_Ka line. However, real time
for whole map is calculated from pixelAverage, lineAverage, pixelTime,
lineCounter and map height parameters.</p>
<p>Note that Bruker Esprit uses a similar format for EBSD data, but it is not
currently supported by HyperSpy.</p>
<section id="id10">
<h5>Extra loading arguments<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">select_type</span></code> : one of (None, ‘spectrum’, ‘image’). If specified, only the
corresponding type of data, either spectrum or image, is returned.
By default (None), all data are loaded.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> : one of (None, int, “all”). Allow to select the index of the dataset
in the bcf file, which can contains several datasets. Default None value
result in loading the first dataset. When set to ‘all’, all available datasets
will be loaded and returned as separate signals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">downsample</span></code> : the downsample ratio of hyperspectral array (height and width
only), can be integer &gt;=1, where ‘1’ results in no downsampling (default 1).
The underlying method of downsampling is unchangeable: sum. Differently than
<code class="docutils literal notranslate"><span class="pre">block_reduce</span></code> from skimage.measure it is memory efficient (does not creates
intermediate arrays, works inplace).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cutoff_at_kV</span></code> : if set (can be None, int, float (kV), one of ‘zealous’
or ‘auto’) can be used either to crop or enlarge energy (or number of
channels) range at max values. It can be used to conserve memory or enlarge
the range if needed to mach the size of other file. Default value is None
(which does not influence size). Numerical values should be in kV.
‘zealous’ truncates to the last non zero channel (this option
should not be used for stacks, as low beam current EDS can have different
last non zero channel per slice). ‘auto’ truncates channels to SEM/TEM
acceleration voltage or energy at last channel, depending which is smaller.
In case the hv info is not there or hv is off (0 kV) then it fallbacks to
full channel range.</p></li>
</ul>
<p>Example of loading reduced (downsampled, and with energy range cropped)
“spectrum only” data from bcf (original shape: 80keV EDS range (4096 channels),
100x75 pixels; SEM acceleration voltage: 20kV):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample80kv.bcf&quot;</span><span class="p">,</span> <span class="n">select_type</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">,</span> <span class="n">downsample</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cutoff_at_kV</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">&lt;EDSSEMSpectrum, title: EDX, dimensions: (50, 38|595)&gt;</span>
</pre></div>
</div>
<p>load the same file with limiting array size to SEM acceleration voltage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample80kv.bcf&quot;</span><span class="p">,</span> <span class="n">cutoff_at_kV</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="go">[&lt;Signal2D, title: BSE, dimensions: (|100, 75)&gt;,</span>
<span class="go">&lt;Signal2D, title: SE, dimensions: (|100, 75)&gt;,</span>
<span class="go">&lt;EDSSEMSpectrum, title: EDX, dimensions: (100, 75|1024)&gt;]</span>
</pre></div>
</div>
<p>The loaded array energy dimension can by forced to be larger than the data
recorded by setting the ‘cutoff_at_kV’ kwarg to higher value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample80kv.bcf&quot;</span><span class="p">,</span> <span class="n">cutoff_at_kV</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="go">[&lt;Signal2D, title: BSE, dimensions: (|100, 75)&gt;,</span>
<span class="go">&lt;Signal2D, title: SE, dimensions: (|100, 75)&gt;,</span>
<span class="go">&lt;EDSSEMSpectrum, title: EDX, dimensions: (100, 75|3072)&gt;]</span>
</pre></div>
</div>
<p>loading without setting cutoff_at_kV value would return data with all 4096
channels. Note that setting downsample to &gt;1 currently locks out using SEM
images for navigation in the plotting.</p>
</section>
</section>
<section id="spx-format">
<span id="id11"></span><h4>SPX format<a class="headerlink" href="#spx-format" title="Permalink to this heading"></a></h4>
<p>Hyperspy can read Bruker’s spx format (single spectra format based on XML).
The format contains extensive list of details and parameters of EDS analyses
which are mapped in hyperspy to metadata and original_metadata dictionaries.</p>
</section>
</section>
<section id="emd">
<span id="emd-format"></span><h3><a class="toc-backref" href="#id48" role="doc-backlink">EMD</a><a class="headerlink" href="#emd" title="Permalink to this heading"></a></h3>
<p>EMD stands for “Electron Microscopy Dataset.” It is a subset of the open source
HDF5 wrapper format. N-dimensional data arrays of any standard type can be
stored in an HDF5 file, as well as tags and other metadata.</p>
<section id="emd-ncem">
<h4>EMD (NCEM)<a class="headerlink" href="#emd-ncem" title="Permalink to this heading"></a></h4>
<p>This <a class="reference external" href="https://emdatasets.com">EMD format</a> was developed by Colin Ophus at the
National Center for Electron Microscopy (NCEM).
This format is used by the <a class="reference external" href="https://prism-em.com/docs-outputs/">prismatic software</a>
to save the simulation outputs.</p>
<section id="id13">
<h5>Extra loading arguments<a class="headerlink" href="#id13" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dataset_path</span></code> : None, str or list of str. Path of the dataset. If None,
load all supported datasets, otherwise the specified dataset(s).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stack_group</span></code> : bool, default is True. Stack datasets of groups with common
path. Relevant for emd file version &gt;= 0.5 where groups can be named
‘group0000’, ‘group0001’, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chunks</span></code> : None, True or tuple. Determine the chunking of the dataset to save.
See the <code class="docutils literal notranslate"><span class="pre">chunks</span></code> arguments of the <code class="docutils literal notranslate"><span class="pre">hspy</span></code> file format for more details.</p></li>
</ul>
<p>For files containing several datasets, the <cite>dataset_name</cite> argument can be
used to select a specific one:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;adatafile.emd&quot;</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s2">&quot;/experimental/science_data_1/data&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Or several by using a list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;adatafile.emd&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">dataset_name</span><span class="o">=</span><span class="p">[</span>
<span class="gp">... </span>                <span class="s2">&quot;/experimental/science_data_1/data&quot;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="s2">&quot;/experimental/science_data_2/data&quot;</span><span class="p">])</span>
</pre></div>
</div>
</section>
</section>
<section id="emd-velox">
<span id="emd-fei-format"></span><h4>EMD (Velox)<a class="headerlink" href="#emd-velox" title="Permalink to this heading"></a></h4>
<p>This is a non-compliant variant of the standard EMD format developed by
Thermo-Fisher (former FEI). HyperSpy supports importing images, EDS spectrum and EDS
spectrum streams (spectrum images stored in a sparse format). For spectrum
streams, there are several loading options (described below) to control the frames
and detectors to load and if to sum them on loading.  The default is
to import the sum over all frames and over all detectors in order to decrease
the data size in memory.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pruned Velox EMD files only contain the spectrum image in a proprietary
format that HyperSpy cannot read. Therefore, don’t prune Velox EMD files
if you intend to read them with HyperSpy.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.emd&quot;</span><span class="p">)</span>
<span class="go">[&lt;Signal2D, title: HAADF, dimensions: (|179, 161)&gt;,</span>
<span class="go">&lt;EDSSEMSpectrum, title: EDS, dimensions: (179, 161|4096)&gt;]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FFTs made in Velox are loaded in as-is as a HyperSpy ComplexSignal2D object.
The FFT is not centered and only positive frequencies are stored in the file.
Making FFTs with HyperSpy from the respective image datasets is recommended.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DPC data is loaded in as a HyperSpy ComplexSignal2D object.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently only lazy uncompression rather than lazy loading is implemented.
This means that it is not currently possible to read EDS SI Velox EMD files
with size bigger than the available memory.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This format is still not stable and files generated with the most recent
version of Velox may not be supported. If you experience issues loading
a file, please report it  to the HyperSpy developers so that they can
add support for newer versions of the format.</p>
</div>
<section id="extra-loading-arguments-fei-emd">
<span id="id14"></span><h5>Extra loading arguments<a class="headerlink" href="#extra-loading-arguments-fei-emd" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">select_type</span></code> : one of {None, ‘image’, ‘single_spectrum’, ‘spectrum_image’} (default is None).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">first_frame</span></code> : integer (default is 0).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last_frame</span></code> : integer (default is None)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sum_frames</span></code> : boolean (default is True)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sum_EDS_detectors</span></code> : boolean (default is True)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rebin_energy</span></code> : integer (default is 1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SI_dtype</span></code> : numpy dtype (default is None)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">load_SI_image_stack</span></code> : boolean (default is False)</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">select_type</span></code> parameter specifies the type of data to load: if <cite>image</cite> is selected,
only images (including EDS maps) are loaded, if <cite>single_spectrum</cite> is selected, only
single spectra are loaded and if <cite>spectrum_image</cite> is selected, only the spectrum
image will be loaded. The <code class="docutils literal notranslate"><span class="pre">first_frame</span></code> and <code class="docutils literal notranslate"><span class="pre">last_frame</span></code> parameters can be used
to select the frame range of the EDS spectrum image to load. To load each individual
EDS frame, use <code class="docutils literal notranslate"><span class="pre">sum_frames=False</span></code> and the EDS spectrum image will be loaded
with an extra navigation dimension corresponding to the frame index
(time axis). Use the <code class="docutils literal notranslate"><span class="pre">sum_EDS_detectors=True</span></code> parameter to load the signal of
each individual EDS detector. In such a case, a corresponding number of distinct
EDS signal is returned. The default is <code class="docutils literal notranslate"><span class="pre">sum_EDS_detectors=True</span></code>, which loads the
EDS signal as a sum over the signals from each EDS detectors.  The <code class="docutils literal notranslate"><span class="pre">rebin_energy</span></code>
and <code class="docutils literal notranslate"><span class="pre">SI_dtype</span></code> parameters are particularly useful in combination with
<code class="docutils literal notranslate"><span class="pre">sum_frames=False</span></code> to reduce the data size when one want to read the
individual frames of the spectrum image. If <code class="docutils literal notranslate"><span class="pre">SI_dtype=None</span></code> (default), the dtype
of the data in the emd file is used. The <code class="docutils literal notranslate"><span class="pre">load_SI_image_stack</span></code> parameter allows
loading the stack of STEM images acquired simultaneously as the EDS spectrum image.
This can be useful to monitor any specimen changes during the acquisition or to
correct the spatial drift in the spectrum image by using the STEM images.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.emd&quot;</span><span class="p">,</span> <span class="n">sum_EDS_detectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[&lt;Signal2D, title: HAADF, dimensions: (|179, 161)&gt;,</span>
<span class="go">&lt;EDSSEMSpectrum, title: EDS - SuperXG21, dimensions: (179, 161|4096)&gt;,</span>
<span class="go">&lt;EDSSEMSpectrum, title: EDS - SuperXG22, dimensions: (179, 161|4096)&gt;,</span>
<span class="go">&lt;EDSSEMSpectrum, title: EDS - SuperXG23, dimensions: (179, 161|4096)&gt;,</span>
<span class="go">&lt;EDSSEMSpectrum, title: EDS - SuperXG24, dimensions: (179, 161|4096)&gt;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.emd&quot;</span><span class="p">,</span> <span class="n">sum_frames</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">load_SI_image_stack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">SI_dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span> <span class="n">rebin_energy</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[&lt;Signal2D, title: HAADF, dimensions: (50|179, 161)&gt;,</span>
<span class="go">&lt;EDSSEMSpectrum, title: EDS, dimensions: (50, 179, 161|1024)&gt;]</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="protochips-log">
<span id="protochips-format"></span><h3><a class="toc-backref" href="#id49" role="doc-backlink">Protochips log</a><a class="headerlink" href="#protochips-log" title="Permalink to this heading"></a></h3>
<p>HyperSpy can read heater, biasing and gas cell log files for Protochips holder.
The format stores all the captured data together with a small header in a csv
file. The reader extracts the measured quantity (e. g. temperature, pressure,
current, voltage) along the time axis, as well as the notes saved during the
experiment. The reader returns a list of signal with each signal corresponding
to a quantity. Since there is a small fluctuation in the step of the time axis,
the reader assumes that the step is constant and takes its mean, which is a
good approximation. Further release of HyperSpy will read the time axis more
precisely by supporting non-uniform axis.</p>
<p>To read Protochips logfiles, use the reader argument to define the correct file reader:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;filename.csv&quot;</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="s2">&quot;protochips&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="usid">
<span id="usid-format"></span><h3><a class="toc-backref" href="#id50" role="doc-backlink">USID</a><a class="headerlink" href="#usid" title="Permalink to this heading"></a></h3>
<section id="background">
<h4>Background<a class="headerlink" href="#background" title="Permalink to this heading"></a></h4>
<p><a class="reference external" href="https://pycroscopy.github.io/USID/about.html">Universal Spectroscopy and Imaging Data</a>
(USID) is an open, community-driven, self-describing, and standardized schema for
representing imaging and spectroscopy data of any size, dimensionality, precision,
instrument of origin, or modality. USID data is typically stored in
Hierarchical Data Format Files (HDF5) and the combination of USID within HDF5 files is
referred to as h5USID.</p>
<p><a class="reference external" href="https://pycroscopy.github.io/pyUSID/about.html">pyUSID</a>
provides a convenient interface to I/O operations on such h5USID files. USID
(via pyUSID) forms the foundation for other materials microscopy scientific
python package called <a class="reference external" href="https://pycroscopy.github.io/pycroscopy/about.html">pycroscopy</a>.
If you have any questions regarding this module, please consider
<a class="reference external" href="https://pycroscopy.github.io/pyUSID/contact.html">contacting</a>
the developers of pyUSID.</p>
</section>
<section id="requirements">
<h4>Requirements<a class="headerlink" href="#requirements" title="Permalink to this heading"></a></h4>
<ol class="arabic simple">
<li><p>Reading and writing h5USID files require the
<a class="reference external" href="https://pycroscopy.github.io/pyUSID/install.html">installation of pyUSID</a>.</p></li>
<li><p>Files must use the <code class="docutils literal notranslate"><span class="pre">.h5</span></code> file extension in order to use this io plugin.
Using the <code class="docutils literal notranslate"><span class="pre">.hdf5</span></code> extension will default to HyperSpy’s own plugin.</p></li>
</ol>
</section>
<section id="reading">
<h4>Reading<a class="headerlink" href="#reading" title="Permalink to this heading"></a></h4>
<p>h5USID files can contain multiple USID datasets within the same file.
HyperSpy supports reading in one or more USID datasets.</p>
<section id="id15">
<h5>Extra loading arguments<a class="headerlink" href="#id15" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dataset_path</span></code>: str. Absolute path of USID Main HDF5 dataset.
(default is <code class="docutils literal notranslate"><span class="pre">None</span></code> - all USID Main Datasets will be read)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore_non_linear_dims</span></code>: bool, default is True. If True, parameters that
were varied non-linearly in the desired dataset will result in Exceptions.
Else, all such non-linearly varied parameters will be treated as
linearly varied parameters and a Signal object will be generated.</p></li>
</ul>
<p>Reading the sole dataset within a h5USID file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.h5&quot;</span><span class="p">)</span>
<span class="go">&lt;Signal2D, title: HAADF, dimensions: (|128, 128)&gt;</span>
</pre></div>
</div>
<p>If multiple datasets are present within the h5USID file and you try the same command again,
<strong>all</strong> available datasets will be loaded.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Given that HDF5 files can accommodate very large datasets, setting <code class="docutils literal notranslate"><span class="pre">lazy=True</span></code>
is strongly recommended if the contents of the HDF5 file are not known apriori.
This prevents issues with regard to loading datasets far larger than memory.</p>
<p>Also note that setting <code class="docutils literal notranslate"><span class="pre">lazy=True</span></code> leaves the file handle to the HDF5 file open.
If it is important that the files be closed after reading, set <code class="docutils literal notranslate"><span class="pre">lazy=False</span></code>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.h5&quot;</span><span class="p">)</span>
<span class="go">[&lt;Signal2D, title: HAADF, dimensions: (|128, 128)&gt;,</span>
<span class="go">&lt;Signal1D, title: EELS, dimensions: (|64, 64, 1024)&gt;]</span>
</pre></div>
</div>
<p>We can load a specific dataset using the <code class="docutils literal notranslate"><span class="pre">dataset_path</span></code> keyword argument. Setting it to the
absolute path of the desired dataset will cause the single dataset to be loaded.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Loading a specific dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.h5&quot;</span><span class="p">,</span> <span class="n">dataset_path</span><span class="o">=</span><span class="s1">&#39;/Measurement_004/Channel_003/Main_Data&#39;</span><span class="p">)</span>
<span class="go">&lt;Signal2D, title: HAADF, dimensions: (|128, 128)&gt;</span>
</pre></div>
</div>
<p>h5USID files support the storage of HDF5 dataset with
<a class="reference external" href="https://pycroscopy.github.io/USID/usid_model.html#compound-datasets">compound data types</a>.
As an (<em>oversimplified</em>) example, one could store a color image using a compound data type that allows
each color channel to be accessed by name rather than an index.
Naturally, reading in such a compound dataset into HyperSpy will result in a separate
signal for each named component in the dataset:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;file_with_a_compound_dataset.h5&quot;</span><span class="p">)</span>
<span class="go">[&lt;Signal2D, title: red, dimensions: (|128, 128)&gt;,</span>
<span class="go">Signal2D, title: blue, dimensions: (|128, 128)&gt;,</span>
<span class="go">Signal2D, title: green, dimensions: (|128, 128)&gt;]</span>
</pre></div>
</div>
<p>h5USID files also support parameters or dimensions that have been varied non-uniformly.
This capability is important in several spectroscopy techniques where the bias is varied as a
<a class="reference external" href="https://pycroscopy.github.io/pyUSID/auto_examples/beginner/plot_usi_dataset.html#values-for-each-dimension">bi-polar triangular waveform</a>
rather than uniformly from the minimum value to the maximum value.
Since HyperSpy Signals expect uniform variation of parameters / axes, such non-uniform information
would be lost in the axes manager. The USID plugin will default to a warning
when it encounters a parameter that has been varied non-uniformly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.h5&quot;</span><span class="p">)</span>
<span class="go">UserWarning: Ignoring non-uniformity of dimension: Bias</span>
<span class="go">&lt;BaseSignal, title: , dimensions: (|7, 3, 5, 2)&gt;</span>
</pre></div>
</div>
<p>Obviously, the
In order to prevent accidental misinterpretation of information downstream, the keyword argument
<code class="docutils literal notranslate"><span class="pre">ignore_non_uniform_dims</span></code> can be set to <code class="docutils literal notranslate"><span class="pre">False</span></code> which will result in a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> instead.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.h5&quot;</span><span class="p">)</span>
<span class="go">ValueError: Cannot load provided dataset. Parameter: Bias was varied non-uniformly.</span>
<span class="go">Supply keyword argument &quot;ignore_non_uniform_dims=True&quot; to ignore this error</span>
</pre></div>
</div>
</section>
</section>
<section id="writing">
<h4>Writing<a class="headerlink" href="#writing" title="Permalink to this heading"></a></h4>
<p>Signals can be written to new h5USID files using the standard <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.save" title="hyperspy.signal.BaseSignal.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a> function.
Setting the <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> keyword argument to <code class="docutils literal notranslate"><span class="pre">True</span></code> will append to the specified
HDF5 file. All other keyword arguments will be passed to
<a class="reference external" href="https://pycroscopy.github.io/pyUSID/_autosummary/_autosummary/pyUSID.io.hdf_utils.html#pyUSID.io.hdf_utils.write_main_dataset">pyUSID.hdf_utils.write_main_dataset()</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;USID.h5&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the model and other secondary data artifacts linked to the signal are not
written to the file but these can be implemented at a later stage.</p>
</section>
</section>
<section id="nexus">
<span id="nexus-format"></span><h3><a class="toc-backref" href="#id51" role="doc-backlink">Nexus</a><a class="headerlink" href="#nexus" title="Permalink to this heading"></a></h3>
<section id="id16">
<h4>Background<a class="headerlink" href="#id16" title="Permalink to this heading"></a></h4>
<p><a class="reference external" href="https://www.nexusformat.org">NeXus</a> is a common data format originally
developed by the neutron and x-ray science x-ray communities. It is still being
developed as an international standard by scientists and programmers
representing major scientific facilities in order to facilitate greater
cooperation in the analysis and visualization of data.
Nexus uses a variety of classes to record data, values,
units and other experimental metadata associated with an experiment.
For specific types of experiments an Application Definition may exist, which
defines an agreed common layout that facilities can adhere to.</p>
<p>Nexus metadata and data are stored in Hierarchical Data Format Files (HDF5) with
a .nxs extension although standards HDF5 extensions are sometimes used.
Files must use the <code class="docutils literal notranslate"><span class="pre">.nxs</span></code> file extension in order to use this io plugin.
Using the <code class="docutils literal notranslate"><span class="pre">.nxs</span></code> extension will default to the Nexus loader. If your file has
an HDF5 extension, you can also explicitly set the Nexus file reader:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load a NeXus file with a .h5 extension</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;filename.h5&quot;</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="s2">&quot;nxs&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The loader will follow version 3 of the
<a class="reference external" href="https://manual.nexusformat.org/datarules.html#version-3">Nexus data rules</a>.
The signal type, Signal1D or Signal2D, will be inferred by the <code class="docutils literal notranslate"><span class="pre">interpretation</span></code>
attribute, if this is set to <code class="docutils literal notranslate"><span class="pre">spectrum</span></code> or <code class="docutils literal notranslate"><span class="pre">image</span></code>, in the <code class="docutils literal notranslate"><span class="pre">NXdata</span></code>
description. If the <a class="reference external" href="https://manual.nexusformat.org/design.html#design-attributes">interpretation</a> attribute is
not set, the loader will return a <code class="docutils literal notranslate"><span class="pre">BaseSignal</span></code>, which must then be converted
to the appropriate signal type. Following the Nexus data rules, if a <code class="docutils literal notranslate"><span class="pre">default</span></code>
dataset is not defined, the loader will load NXdata
and HDF datasets according to the keyword options in the reader.
A number of the <a class="reference external" href="https://github.com/nexusformat/exampledata">Nexus examples</a>
from large facilties do not use NXdata or use older versions of the Nexus
implementation. Data can still be loaded from these files but information or
associations may be missing. However, this missing information can be recovered
from within the  <code class="docutils literal notranslate"><span class="pre">original_metadata</span></code> which contains the overall structure of
the entry.</p>
<p>As the Nexus format uses the HDF5 format and needs to read both data and
metadata structured in different ways, the loader is written to be quite
flexible and can also be used to inspect any hdf5 based file.</p>
</section>
<section id="differences-with-respect-to-hspy">
<h4>Differences with respect to hspy<a class="headerlink" href="#differences-with-respect-to-hspy" title="Permalink to this heading"></a></h4>
<p>HyperSpy metadata structure stores arrays as hdf datasets without attributes
and stores floats, ints and strings as attributes.
Nexus formats typically use hdf datasets attributes to store additional
information such as an indication of the units for an axis or the NX_class which
the dataset structure follows. The metadata, hyperspy  or original_metadata,
therefore needs to be able to indicate the values and attributes of a dataset.
To implement this structure the <code class="docutils literal notranslate"><span class="pre">value</span></code> and <code class="docutils literal notranslate"><span class="pre">attrs</span></code> of a dataset can also be
defined. The value of a dataset is set using a <code class="docutils literal notranslate"><span class="pre">value</span></code> key.
The attributes of a dataset are defined by an <code class="docutils literal notranslate"><span class="pre">attrs</span></code> key.</p>
<p>For example, to store an array called <code class="docutils literal notranslate"><span class="pre">axis_x</span></code>, with a units attribute within
original_metadata, the following structure would be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├──original_metadata
│   ├── axis_x
│   │   ├── value : array([1.0,2.0,3.0,4.0,5.0])
│   │   ├── attrs
│   │   │   ├── units : mm
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">original_metadata</span><span class="o">.</span><span class="n">set_item</span><span class="p">(</span><span class="n">axis_x</span><span class="o">.</span><span class="n">value</span><span class="p">,[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original_metadata</span><span class="o">.</span><span class="n">set_item</span><span class="p">(</span><span class="n">axis_x</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">units</span><span class="p">,</span><span class="s2">&quot;mm&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To access the axis information:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">original_metadata</span><span class="o">.</span><span class="n">axis_x</span><span class="o">.</span><span class="n">value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original_metadata</span><span class="o">.</span><span class="n">axis_x</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">units</span>
</pre></div>
</div>
<p>To modify the axis information:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">original_metadata</span><span class="o">.</span><span class="n">axis_x</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">6.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">original_metadata</span><span class="o">.</span><span class="n">axis_x</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;um&quot;</span>
</pre></div>
</div>
<p>To store data in a Nexus monochromator format, <code class="docutils literal notranslate"><span class="pre">value</span></code>
and <code class="docutils literal notranslate"><span class="pre">attrs</span></code> keys can define additional attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── monochromator
│   ├── energy
│   │   ├── value : 12.0
│   │   ├── attrs
│   │   │   ├── units : keV
│   │   │   ├── NXclass : NXmonochromator
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">attrs</span></code> key can also be used to define Nexus structures for the definition
of structures and relationships between data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── mydata
│   ├── attrs
│   │   ├── NX_class : &quot;NXdata&quot;
│   │   ├── axes : [&quot;x&quot;,&quot;.&quot;]
│   ├── data
│   │   ├──value : [[30,23...110]
│   ├── x
│   │   ├──value : [1,2.....100]
│   │   ├── attrs
│   │   │   ├── unit : &quot;mm&quot;
</pre></div>
</div>
<p>The use of <code class="docutils literal notranslate"><span class="pre">attrs</span></code> or <code class="docutils literal notranslate"><span class="pre">value</span></code> to set values within the metadata is optional
and metadata values can also be set, read or modified in the normal way.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">original_metadata</span><span class="o">.</span><span class="n">monochromator</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="mf">12.5</span>
</pre></div>
</div>
<p>HyperSpy metadata is stored within the Nexus file and should be automatically
restored when a signal is loaded from a previously saved Nexus file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Altering the standard metadata structure of a signal
using <code class="docutils literal notranslate"><span class="pre">attrs</span></code> or <code class="docutils literal notranslate"><span class="pre">value</span></code> keywords is not recommended.</p>
</div>
</section>
<section id="id18">
<h4>Reading<a class="headerlink" href="#id18" title="Permalink to this heading"></a></h4>
<p>Nexus files can contain multiple datasets within the same file, but the
ordering of datasets can vary depending on the setup of an experiment or
processing step when the data was collected.
For example, in one experiment Fe, Ca, P, Pb were collected but in the next experiment
Ca, P, K, Fe, Pb were collected. HyperSpy supports reading in one or more datasets
and returns a list of signals but in this example case the indexing is different.
To control which data or metadata is loaded and in what order
some additional loading arguments are provided.</p>
<section id="id19">
<h5>Extra loading arguments<a class="headerlink" href="#id19" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dataset_key</span></code>: <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code> of strings - Default is <code class="docutils literal notranslate"><span class="pre">None</span></code> . String(s) to search for in the path to find one or more datasets.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dataset_path</span></code>: <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code> of strings - Default is <code class="docutils literal notranslate"><span class="pre">None</span></code> . Absolute path(s) to search for in the path to find one or more datasets.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">metadata_key</span></code>: <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code> of strings - Default is <code class="docutils literal notranslate"><span class="pre">None</span></code> . Absolute path(s) or string(s) to search for in the path to find metadata.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skip_array_metadata</span></code>: <code class="docutils literal notranslate"><span class="pre">bool</span></code> - Default is False. Option to skip loading metadata that are arrays to avoid duplicating loading of data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nxdata_only</span></code>: <code class="docutils literal notranslate"><span class="pre">bool</span></code> - Default is False. Option to only convert NXdata formatted data to signals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hardlinks_only</span></code>: <code class="docutils literal notranslate"><span class="pre">bool</span></code> - Default is False. Option to ignore soft or External links in the file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_default</span></code>: <code class="docutils literal notranslate"><span class="pre">bool</span></code> - Default is False. Only load the <code class="docutils literal notranslate"><span class="pre">default</span></code> dataset, if defined, from the file. Otherwise load according to the other keyword options.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Given that HDF5 files can accommodate very large datasets, setting <code class="docutils literal notranslate"><span class="pre">lazy=True</span></code>
is strongly recommended if the content of the HDF5 file is not known apriori.
This prevents issues with regard to loading datasets far larger than memory.</p>
<p>Also note that setting <code class="docutils literal notranslate"><span class="pre">lazy=True</span></code> leaves the file handle to the HDF5 file open
and it can be closed with <a class="reference internal" href="../api/hyperspy._signals.lazy.html#hyperspy._signals.lazy.LazySignal.close_file" title="hyperspy._signals.lazy.LazySignal.close_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">close_file()</span></code></a>
or when using <a class="reference internal" href="../api/hyperspy._signals.lazy.html#hyperspy._signals.lazy.LazySignal.compute" title="hyperspy._signals.lazy.LazySignal.compute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compute()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">close_file=True</span></code>.</p>
</div>
<p>Reading a Nexus file (a single Nexus dataset):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.nxs&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, the loader will look for stored NXdata objects.
If there are hdf datasets which are not stored as NXdata, but which
should be loaded as signals, set the <code class="docutils literal notranslate"><span class="pre">nxdata_only</span></code> keyword to False and all
hdf datasets will be returned as signals:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.nxs&quot;</span><span class="p">,</span> <span class="n">nxdata_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>We can load a specific dataset using the <code class="docutils literal notranslate"><span class="pre">dataset_path</span></code> keyword argument.
Setting it to the absolute path of the desired dataset will cause
the single dataset to be loaded:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Loading a specific dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.nxs&quot;</span><span class="p">,</span> <span class="n">dataset_path</span><span class="o">=</span><span class="s2">&quot;/entry/experiment/EDS/data&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also choose to load datasets based on a search key using the
<code class="docutils literal notranslate"><span class="pre">dataset_key</span></code> keyword argument. This can also be used to load NXdata not
outside of the <code class="docutils literal notranslate"><span class="pre">default</span></code> version 3 rules. Instead of providing an absolute
path, a string can be provided as well, and datasets with this key will be
returned. The previous example could also be written as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Loading datasets containing the string &quot;EDS&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.nxs&quot;</span><span class="p">,</span> <span class="n">dataset_key</span><span class="o">=</span><span class="s2">&quot;EDS&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The difference between <code class="docutils literal notranslate"><span class="pre">dataset_path</span></code> and <code class="docutils literal notranslate"><span class="pre">dataset_key</span></code> is illustrated
here:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Only the dataset /entry/experiment/EDS/data will be loaded</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.nxs&quot;</span><span class="p">,</span> <span class="n">dataset_path</span><span class="o">=</span><span class="s2">&quot;/entry/experiment/EDS/data&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># All datasets contain the entire string &quot;/entry/experiment/EDS/data&quot; will be loaded</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.nxs&quot;</span><span class="p">,</span> <span class="n">dataset_key</span><span class="o">=</span><span class="s2">&quot;/entry/experiment/EDS/data&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Multiple datasets can be loaded by providing a number of keys:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Loading a specific dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.nxs&quot;</span><span class="p">,</span> <span class="n">dataset_key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;EDS&quot;</span><span class="p">,</span> <span class="s2">&quot;Fe&quot;</span><span class="p">,</span> <span class="s2">&quot;Ca&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Metadata can also be filtered in the same way using <code class="docutils literal notranslate"><span class="pre">metadata_key</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load data with metadata matching metadata_key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.nxs&quot;</span><span class="p">,</span> <span class="n">metadata_key</span><span class="o">=</span><span class="s2">&quot;entry/instrument&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Nexus loader removes any NXdata blocks from the metadata.</p>
</div>
<p>Metadata that are arrays can be skipped by using <code class="docutils literal notranslate"><span class="pre">skip_array_metadata</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load data while skipping metadata that are arrays</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample.nxs&quot;</span><span class="p">,</span> <span class="n">skip_array_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Nexus files also support parameters or dimensions that have been varied
non-linearly. Since HyperSpy Signals expect linear variation of parameters /
axes, such non-linear information would be lost in the axes manager and
replaced with indices.
Nexus and HDF can result in large metadata structures with large datasets within the loaded
original_metadata. If lazy loading is used this may not be a concern but care must be taken
when saving the data. To control whether large datasets are loaded or saved,
use the <code class="docutils literal notranslate"><span class="pre">metadata_key</span></code> to load only the most relevant information. Alternatively,
set <code class="docutils literal notranslate"><span class="pre">skip_array_metadata</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> to avoid loading those large datasets in original_metadata.</p>
</section>
</section>
<section id="id20">
<h4>Writing<a class="headerlink" href="#id20" title="Permalink to this heading"></a></h4>
<p>Signals can be written to new Nexus files using the standard <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.save" title="hyperspy.signal.BaseSignal.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a>
function.</p>
<section id="id21">
<h5>Extra saving arguments<a class="headerlink" href="#id21" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">save_original_metadata</span></code>: <code class="docutils literal notranslate"><span class="pre">bool</span></code> - Default is True, option to save the original_metadata when storing to file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skip_metadata_key</span></code>: <code class="docutils literal notranslate"><span class="pre">bool</span></code> - <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code> of strings - Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>. Option to skip certain metadata keys when storing to file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_default</span></code>: <code class="docutils literal notranslate"><span class="pre">bool</span></code> - Default is False. Set the <code class="docutils literal notranslate"><span class="pre">default</span></code> attribute for the Nexus file.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;output.nxs&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the save method will store the nexus file with the following structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── entry1
│   ├── signal_name
│   │   ├── auxiliary
│   │   │   ├── original_metadata
│   │   │   ├── hyperspy_metadata
│   │   │   ├── learning_results
│   │   ├── signal_data
│   │   │   ├── data and axes (NXdata format)
</pre></div>
</div>
<p>The original_metadata can include hdf datasets which you may not wish to store.
The original_metadata can be omitted using <code class="docutils literal notranslate"><span class="pre">save_original_metadata</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;output.nxs&quot;</span><span class="p">,</span> <span class="n">save_original_metadata</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>If only certain metadata are to be ignored, use <code class="docutils literal notranslate"><span class="pre">skip_metadata_key</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;output.nxs&quot;</span><span class="p">,</span> <span class="n">skip_metadata_key</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;xsp3&#39;</span><span class="p">,</span> <span class="s1">&#39;solstice_scan&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>To save multiple signals, the file_writer method can be called directly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hyperspy.io_plugins.nexus</span> <span class="kn">import</span> <span class="n">file_writer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_writer</span><span class="p">(</span><span class="s2">&quot;test.nxs&quot;</span><span class="p">,[</span><span class="n">signal1</span><span class="p">,</span><span class="n">signal2</span><span class="p">])</span>
</pre></div>
</div>
<p>When saving multiple signals, a default signal can be defined. This can be used when storing
associated data or processing steps along with a final result. All signals can be saved but
a single signal can be marked as the default for easier loading in HyperSpy or plotting with Nexus tools.
The default signal is selected as the first signal in the list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hyperspy.io_plugins.nexus</span> <span class="kn">import</span> <span class="n">file_writer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">hyperspy.api</span> <span class="k">as</span> <span class="nn">hs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_writer</span><span class="p">(</span><span class="s2">&quot;test.nxs&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">],</span> <span class="n">use_default</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;test.nxs&quot;</span><span class="p">,</span> <span class="n">use_default</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The output will be arranged by signal name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── entry1 (NXentry)
│   ├── signal_name (NXentry)
│   │   ├── auxiliary (NXentry)
│   │   │   ├── original_metadata (NXcollection)
│   │   │   ├── hyperspy_metadata (NXcollection)
│   │   │   ├── learning_results  (NXcollection)
│   │   ├── signal_data (NXdata format)
│   │   │   ├── data and axes
├── entry2 (NXentry)
│   ├── signal_name (NXentry)
│   │   ├── auxiliary (NXentry)
│   │   │   ├── original_metadata (NXcollection)
│   │   │   ├── hyperspy_metadata (NXcollection)
│   │   │   ├── learning_results (NXcollection)
│   │   ├── signal_data (NXdata)
│   │   │   ├── data and axes
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Signals saved as nxs by this plugin can be loaded normally and the
original_metadata, signal data, axes, metadata and learning_results
will be restored. Model information is not currently stored.
Nexus does not store how the data should be displayed.
To preserve the signal details an additional navigation attribute
is added to each axis to indicate if it is a navigation axis.</p>
</div>
</section>
</section>
<section id="inspecting">
<h4>Inspecting<a class="headerlink" href="#inspecting" title="Permalink to this heading"></a></h4>
<p>Looking in a Nexus or HDF file for specific metadata is often useful - e.g. to find
what position a specific stage was at. The methods <code class="docutils literal notranslate"><span class="pre">read_metadata_from_file</span></code>
and <code class="docutils literal notranslate"><span class="pre">list_datasets_in_file</span></code> can be used to load the file contents or
list the hdf datasets contained in a file. The inspection methods use the same <code class="docutils literal notranslate"><span class="pre">metadata_key</span></code> or <code class="docutils literal notranslate"><span class="pre">dataset_key</span></code> as when loading.
For example to search for metadata in a file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hyperspy.io_plugins.nexus</span> <span class="kn">import</span> <span class="n">read_metadata_from_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">read_metadata_from_file</span><span class="p">(</span><span class="s2">&quot;sample.hdf5&quot;</span><span class="p">,</span><span class="n">metadata_key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;stage1_z&quot;</span><span class="p">])</span>
<span class="go">{&#39;entry&#39;: {&#39;instrument&#39;: {&#39;scannables&#39;: {&#39;stage1&#39;: {&#39;stage1_z&#39;: {&#39;value&#39;: -9.871700000000002,</span>
<span class="go">&#39;attrs&#39;: {&#39;gda_field_name&#39;: &#39;stage1_z&#39;,</span>
<span class="go">&#39;local_name&#39;: &#39;stage1.stage1_z&#39;,</span>
<span class="go">&#39;target&#39;: &#39;/entry/instrument/scannables/stage1/stage1_z&#39;,</span>
<span class="go">&#39;units&#39;: &#39;mm&#39;}}}}}}}</span>
</pre></div>
</div>
<p>To list the datasets stored in the file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hyperspy.io_plugins.nexus</span> <span class="kn">import</span> <span class="n">read_datasets_from_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_datasets_in_file</span><span class="p">(</span><span class="s2">&quot;sample.nxs&quot;</span><span class="p">)</span>
<span class="go">NXdata found</span>
<span class="go">/entry/xsp3_addetector</span>
<span class="go">/entry/xsp3_addetector_total</span>
<span class="go">HDF datasets found</span>
<span class="go">/entry/solstice_scan/keys/uniqueKeys</span>
<span class="go">/entry/solstice_scan/scan_shape</span>
<span class="go">Out[3]:</span>
<span class="go">([&#39;/entry/xsp3_addetector&#39;, &#39;/entry/xsp3_addetector_total&#39;],</span>
<span class="go"> [&#39;/entry/solstice_scan/keys/uniqueKeys&#39;, &#39;/entry/solstice_scan/scan_shape&#39;])</span>
</pre></div>
</div>
</section>
</section>
<section id="sur-and-pro-format">
<span id="sur-format"></span><h3><a class="toc-backref" href="#id52" role="doc-backlink">SUR and PRO format</a><a class="headerlink" href="#sur-and-pro-format" title="Permalink to this heading"></a></h3>
<p>This is a format developed by the digitalsurf company to handle various types of
scientific measurements data such as profilometer, SEM, AFM, RGB(A) images, multilayer
surfaces and profiles. Even though it is essentially a surfaces format, 1D signals
are supported for spectra and spectral maps. Specifically, this file format is used
by Attolight SA for its scanning electron microscope cathodoluminescence
(SEM-CL) hyperspectral maps. Metadata parsing is supported, including user-specific
metadata, as well as the loading of files containing multiple objects packed together.</p>
<p>The plugin was developed based on the MountainsMap software documentation, which
contains a description of the binary format.</p>
</section>
<section id="empad-format">
<span id="id22"></span><h3><a class="toc-backref" href="#id53" role="doc-backlink">EMPAD format</a><a class="headerlink" href="#empad-format" title="Permalink to this heading"></a></h3>
<p>This is the file format used by the Electron Microscope Pixel Array
Detector (EMPAD). It is used to store a series of diffraction patterns from
scanning transmission electron diffraction measurements, with a limited set of
metadata. Similarly, to the <a class="reference internal" href="#ripple-format"><span class="std std-ref">ripple format</span></a>, the raw data
and metadata are saved in two different files and for the EMPAD reader, these
are saved in the <code class="docutils literal notranslate"><span class="pre">raw</span></code> and <code class="docutils literal notranslate"><span class="pre">xml</span></code> files, respectively. To read EMPAD data,
use the <code class="docutils literal notranslate"><span class="pre">xml</span></code> file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;file.xml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>which will automatically read the raw data from the <code class="docutils literal notranslate"><span class="pre">raw</span></code> file too. The
filename of the <code class="docutils literal notranslate"><span class="pre">raw</span></code> file is defined in the <code class="docutils literal notranslate"><span class="pre">xml</span></code> file, which implies
changing the file name of the <code class="docutils literal notranslate"><span class="pre">raw</span></code> file will break reading the file.</p>
</section>
<section id="phenom-elid-format">
<span id="elid-format-label"></span><h3><a class="toc-backref" href="#id54" role="doc-backlink">Phenom ELID format</a><a class="headerlink" href="#phenom-elid-format" title="Permalink to this heading"></a></h3>
<p>This is the file format used by the software package Element Identification for the Thermo
Fisher Scientific Phenom desktop SEM. It is a proprietary binary format which can contain
images, single EDS spectra, 1D line scan EDS spectra and 2D EDS spectrum maps. The reader
will convert all signals and its metadata into hyperspy signals.</p>
<p>The current implementation supports ELID files created with Element Identification version
3.8.0 and later. You can convert older ELID files by loading the file into a recent Element
Identification release and then save the ELID file into the newer file format.</p>
</section>
<section id="jeol-asw-format">
<span id="jeol-format-label"></span><h3><a class="toc-backref" href="#id55" role="doc-backlink">JEOL ASW format</a><a class="headerlink" href="#jeol-asw-format" title="Permalink to this heading"></a></h3>
<p>This is the file format used by the <cite>JEOL Analysist Station software</cite> for which
hyperspy can read the <code class="docutils literal notranslate"><span class="pre">asw</span></code>, <code class="docutils literal notranslate"><span class="pre">pts</span></code>, <code class="docutils literal notranslate"><span class="pre">map</span></code> and <code class="docutils literal notranslate"><span class="pre">eds</span></code> format. To read the
calibration, it is required to load the <code class="docutils literal notranslate"><span class="pre">asw</span></code> file, which will load all others
files automatically.</p>
<section id="id23">
<h4>Extra loading arguments<a class="headerlink" href="#id23" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rebin_energy</span></code> : int, default 1.
Factor used to rebin the energy dimension. It must be a
factor of the number of channels, typically 4096.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sum_frames</span></code> : bool, default True.
If False, each individual frame (sweep in JEOL software jargon)
is loaded. Be aware that loading each individual will use a lot of memory,
however, it can be used in combination with <code class="docutils literal notranslate"><span class="pre">rebin_energy</span></code>, <code class="docutils literal notranslate"><span class="pre">cutoff_at_kV</span></code>
and <code class="docutils literal notranslate"><span class="pre">downsample</span></code> to reduce memory usage.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SI_dtype</span></code> : dtype, default np.uint8.
set dtype of the eds dataset. Useful to adjust memory usage
and maximum number of X-rays per channel.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cutoff_at_kV</span></code> : int, float, or None, default None.
if set (&gt;= 0), use to crop the energy range up the specified energy.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the whole energy range is loaded.
Useful to reduce memory usage.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">downsample</span></code> : int, default 1.
the downsample ratio of the navigation dimension of EDS
dataset, it can be integer or a tuple of length 2 to define <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>
separetely and it must be a mutiple of the size of the navigation dimension.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">only_valid_data</span></code> : bool, default True.
for <code class="docutils literal notranslate"><span class="pre">pts</span></code> file only, ignore incomplete and partly
acquired last frame, which typically occurs when the acquisition was
interrupted. When loading incomplete data (<code class="docutils literal notranslate"><span class="pre">only_valid_data=False</span></code>),
the missing data are filled with zeros. If <code class="docutils literal notranslate"><span class="pre">sum_frames=True</span></code>, this argument
will be ignored to enforce consistent sum over the mapped area.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">read_em_image</span></code> : bool, default False.
for <code class="docutils literal notranslate"><span class="pre">pts</span></code> file only, If <code class="docutils literal notranslate"><span class="pre">read_em_image=True</span></code>,
read SEM/STEM image from pts file if available. In this case, both
spectrum Image and SEM/STEM Image will be returned as list.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frame_list</span></code> : list of integer or None, default None
for <code class="docutils literal notranslate"><span class="pre">pts</span></code> file only, frames in frame_list will be loaded.
for example, <code class="docutils literal notranslate"><span class="pre">frame_list=[1,3]</span></code> means second and forth frame will be loaded.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all frames are loaded.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frame_shifts</span></code> : list of [int, int], list of [int, int, int], or None, default None
for <code class="docutils literal notranslate"><span class="pre">pts</span></code> file only, each frame will be loaded with offset of
[dy, dx (, and optionary dEnergy)]. Units are pixels/channels.
The result of estimate_shift2D() can be used as a parameter of frame_shifts.
This is useful for express drift correction. Not suitable for accurate analysis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lazy</span></code> : bool, default False
for <code class="docutils literal notranslate"><span class="pre">pts</span></code> file only, spectrum image is loaded as a dask.array if lazy == true.
This is useful to reduce memory usage, with cost of cpu time for calculation.</p></li>
</ul>
<p>Example of loading data downsampled, and with energy range cropped with the
original navigation dimension 512 x 512 and the EDS range 40 keV over 4096
channels:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample40kv.asw&quot;</span><span class="p">,</span> <span class="n">downsample</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">cutoff_at_kV</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[&lt;Signal2D, title: IMG1, dimensions: (|512, 512)&gt;,</span>
<span class="go"> &lt;Signal2D, title: C K, dimensions: (|512, 512)&gt;,</span>
<span class="go"> &lt;Signal2D, title: O K, dimensions: (|512, 512)&gt;,</span>
<span class="go"> &lt;EDSTEMSpectrum, title: EDX, dimensions: (64, 64|1096)&gt;]</span>
</pre></div>
</div>
<p>load the same file without extra arguments:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample40kv.asw&quot;</span><span class="p">)</span>
<span class="go">[&lt;Signal2D, title: IMG1, dimensions: (|512, 512)&gt;,</span>
<span class="go"> &lt;Signal2D, title: C K, dimensions: (|512, 512)&gt;,</span>
<span class="go"> &lt;Signal2D, title: O K, dimensions: (|512, 512)&gt;,</span>
<span class="go"> &lt;EDSTEMSpectrum, title: EDX, dimensions: (512, 512|4096)&gt;]</span>
</pre></div>
</div>
</section>
</section>
<section id="tvips-format">
<span id="tvips-format-label"></span><h3><a class="toc-backref" href="#id56" role="doc-backlink">TVIPS format</a><a class="headerlink" href="#tvips-format" title="Permalink to this heading"></a></h3>
<p>The TVIPS format is the default format for image series collected by pixelated
cameras from the TVIPS company. Typically individual images captured by these
cameras are stored in the <a class="reference internal" href="#tiff-format"><span class="std std-ref">TIFF format</span></a> which can also be
loaded by Hyperspy. This format instead serves to store image streams from
in-situ and 4D-STEM experiments. During collection, the maximum file size is
typically capped meaning the dataset is typically split over multiple files
ending in <cite>_xyz.tvips</cite>. The <cite>_000.tvips</cite> will contain the main header and
it is essential for loading the data. If a filename is provided for loading
or saving without a <cite>_000</cite> suffix, this will automatically be added. Loading
will not work if no such file is found.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>While TVIPS files are supported, it is a proprietary format, and future
versions of the format might therefore not be readable. Complete
interoperability with the official software can neither be guaranteed.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The TVIPS format currently stores very limited amount of metadata about
scanning experiments. To reconstruct scan data, e.g. 4D-STEM datasets,
parameters like the shape and scales of the scan dimensions should be
manually recorded.</p>
</div>
<section id="id24">
<h4>Extra loading arguments<a class="headerlink" href="#id24" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scan_shape</span></code>: a tuple of integers to indicate the shape of the navigation
axes. For example, <cite>(3, 4)</cite> will have 3 scan points in the y direction and 4
in the x direction. If this argument is not provided, the data will be loaded
as a 1D stack of images. <cite>auto</cite> is also an option which aims to reconstruct
the scan based on the <cite>rotidx</cite> indices in frame headers. Since this only
works for square scan grids and is prone to failure, this option is not
recommended.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scan_start_frame</span></code>: index of the first frame of the dataset to consider,
mainly relevant for 4D-STEM datasets. If <cite>scan_shape=”auto”</cite> this parameter
is ignored.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">winding_scan_axis</span></code>: if the acquisition software collected data without
beam flyback but with a winding “snake” scan, then every second scan row
or column needs to be reversed to make sense of the data. This can be
indicated with values <cite>“x”</cite> or <cite>“y”</cite>, depending on whether winding happened
along the primary or secondary axis. By default, flyback scan without winding
is assumed with <cite>x</cite> the fast scan and <cite>y</cite> the slow scan direction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hysteresis</span></code>: if winding scan was active it is likely there is an overshoot
of a few pixels (2-5) every second scan row. This parameter shifts every
second row by the indicated number of scan points to align even and odd scan
rows. Default is 0, no hysteresis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rechunking</span></code>: only relevant when using lazy loading. If set to <cite>False</cite>
each TVIPS file is loaded as a single chunk. For a better experience, with the
default setting of <cite>auto</cite> rechunking is performed such that the navigation axes
are optimally chunked and the signal axes are not chunked. If set to anything else, the
value will be passed to the <cite>chunks</cite> argument in <cite>dask.array.rechunk</cite>.</p></li>
</ul>
</section>
<section id="id25">
<h4>Extra saving arguments<a class="headerlink" href="#id25" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">max_file_size</span></code>: approximate maximum size of individual files in bytes.
In this way a dataset can be split into multiple files. A file needs to be
at least the size of the main header in the first file plus one frame and its
frame header. By default there is no maximum and the entire dataset is saved
to one file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">version</span></code>: TVIPS file format version, defaults to version 2. Only version
1 and 2 are currently supported.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frame_header_extra_bytes</span></code>: the number of bytes to pad the frame headers
with. By default this is 0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mode</span></code>: <cite>1</cite> for imaging, <cite>2</cite> for diffraction. By default the mode is
guessed from the signal type and signal unites.</p></li>
</ul>
</section>
</section>
</section>
<section id="reading-data-generated-by-hyperspy-using-other-software-packages">
<h2><a class="toc-backref" href="#id57" role="doc-backlink">Reading data generated by HyperSpy using other software packages</a><a class="headerlink" href="#reading-data-generated-by-hyperspy-using-other-software-packages" title="Permalink to this heading"></a></h2>
<p>The following scripts may help reading data generated by HyperSpy using
other software packages.</p>
<section id="importrpl-digital-micrograph-plugin">
<span id="import-rpl"></span><h3><a class="toc-backref" href="#id58" role="doc-backlink">ImportRPL Digital Micrograph plugin</a><a class="headerlink" href="#importrpl-digital-micrograph-plugin" title="Permalink to this heading"></a></h3>
<p>This Digital Micrograph plugin is designed to import Ripple files into Digital Micrograph.
It is used to ease data transit between DigitalMicrograph and HyperSpy without losing
the calibration using the extra keywords that HyperSpy adds to the standard format.</p>
<p>When executed it will ask for 2 files:</p>
<ol class="arabic simple">
<li><p>The riple file with the data  format and calibrations</p></li>
<li><p>The data itself in raw format.</p></li>
</ol>
<p>If a file with the same name and path as the riple file exits
with raw or bin extension it is opened directly without prompting.
ImportRPL was written by Luiz Fernando Zagonel.</p>
<p><a class="reference external" href="https://github.com/downloads/hyperspy/ImportRPL/ImportRPL.s">Download ImportRPL</a></p>
</section>
<section id="hdf5-reader-plugin-for-digital-micrograph">
<h3><a class="toc-backref" href="#id59" role="doc-backlink">HDF5 reader plugin for Digital Micrograph</a><a class="headerlink" href="#hdf5-reader-plugin-for-digital-micrograph" title="Permalink to this heading"></a></h3>
<p>This Digital Micrograph plugin is designed to import HDF5 files and like the
<cite>ImportRPL</cite> script above, it can be used to easily transfer data from HyperSpy to
Digital Micrograph by using the HDF5 hyperspy format (<code class="docutils literal notranslate"><span class="pre">hspy</span></code> extension).</p>
<p>Download <code class="docutils literal notranslate"><span class="pre">gms_plugin_hdf5</span></code> from its <a class="reference external" href="https://github.com/niermann/gms_plugin_hdf5">Github repository</a>.</p>
</section>
<section id="readhyperspyh5-matlab-plugin">
<span id="hyperspy-matlab"></span><h3><a class="toc-backref" href="#id60" role="doc-backlink">readHyperSpyH5 MATLAB Plugin</a><a class="headerlink" href="#readhyperspyh5-matlab-plugin" title="Permalink to this heading"></a></h3>
<p>This MATLAB script is designed to import HyperSpy’s saved HDF5 files (<code class="docutils literal notranslate"><span class="pre">.hspy</span></code> extension).
Like the Digital Micrograph script above, it is used to easily transfer data
from HyperSpy to MATLAB, while retaining spatial calibration information.</p>
<p>Download <code class="docutils literal notranslate"><span class="pre">readHyperSpyH5</span></code> from its <a class="reference external" href="https://github.com/jat255/readHyperSpyH5">Github repository</a>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="electron_holography.html" class="btn btn-neutral float-left" title="Electron Holography" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="events.html" class="btn btn-neutral float-right" title="Events" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011-2023, The HyperSpy development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>