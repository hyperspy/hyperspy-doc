

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Energy-Dispersive X-ray Spectrometry (EDS) &mdash; HyperSpy 1.4.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/hyperspy.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dielectric function tools" href="dielectric_function.html" />
    <link rel="prev" title="Electron Energy Loss Spectroscopy" href="eels.html" />
 
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-25260850-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> HyperSpy
          

          
            
            <img src="../_static/hyperspy_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.4.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">HyperSpy User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="what_is_new.html">What’s new</a></li>
<li class="toctree-l2"><a class="reference internal" href="what_is_new.html#changelog">Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html">Installing HyperSpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools: the Signal class</a></li>
<li class="toctree-l2"><a class="reference internal" href="signal1d.html">Signal1D Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="signal2d.html">Signal2D Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualisation.html">Data visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="mva.html">Machine learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html">Model fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="eels.html">Electron Energy Loss Spectroscopy</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Energy-Dispersive X-ray Spectrometry (EDS)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spectrum-loading-and-parameters">Spectrum loading and parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#loading-data">Loading data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#microscope-and-detector-parameters">Microscope and detector parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#energy-axis">Energy axis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#copying-spectrum-calibration">Copying spectrum calibration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#describing-the-sample">Describing the sample</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#elements">Elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#x-ray-lines">X-ray lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#elemental-database">Elemental database</a></li>
<li class="toctree-l4"><a class="reference internal" href="#finding-elements-from-energy">Finding elements from energy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mass-absorption-coefficient-database">Mass absorption coefficient database</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#plotting">Plotting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#plotting-x-ray-lines">Plotting X-ray lines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#geting-the-intensity-of-an-x-ray-line">Geting the intensity of an X-ray line</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#background-subtraction">Background subtraction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#eds-quantification">EDS Quantification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eds-curve-fitting">EDS curve fitting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dielectric_function.html">Dielectric function tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="electron_holography.html">Electron Holography</a></li>
<li class="toctree-l2"><a class="reference internal" href="io.html">Loading and saving data</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="big_data.html">Working with big data</a></li>
<li class="toctree-l2"><a class="reference internal" href="metadata_structure.html">Metadata structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">Full HyperSpy API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing HyperSpy</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HyperSpy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">HyperSpy User Guide</a> &raquo;</li>
        
      <li>Energy-Dispersive X-ray Spectrometry (EDS)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user_guide/eds.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="energy-dispersive-x-ray-spectrometry-eds">
<span id="eds-label"></span><h1>Energy-Dispersive X-ray Spectrometry (EDS)<a class="headerlink" href="#energy-dispersive-x-ray-spectrometry-eds" title="Permalink to this headline">¶</a></h1>
<p>The methods described in this chapter are specific to the following signals:</p>
<ul class="simple">
<li><code class="xref py py-class docutils literal notranslate"><span class="pre">EDSTEM</span></code></li>
<li><code class="xref py py-class docutils literal notranslate"><span class="pre">EDSSEMSpectrum</span></code></li>
</ul>
<p>This chapter describes step-by-step the analysis of an EDS
spectrum (SEM or TEM).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See also the <a class="reference external" href="http://nbviewer.ipython.org/github/hyperspy/hyperspy-demos/blob/master/electron_microscopy/EDS/">EDS tutorials</a> .</p>
</div>
<div class="section" id="spectrum-loading-and-parameters">
<h2>Spectrum loading and parameters<a class="headerlink" href="#spectrum-loading-and-parameters" title="Permalink to this headline">¶</a></h2>
<p>The sample and  data used in this section are described in
<a class="reference internal" href="bibliography.html#burdet2013"><span class="std std-ref">[Burdet2013]</span></a>,
and can be downloaded using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#Download the data (130MB)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlretrieve</span><span class="p">,</span> <span class="n">urlopen</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">files</span> <span class="o">=</span> <span class="n">urlretrieve</span><span class="p">(</span><span class="s2">&quot;https://www.dropbox.com/s/s7cx92mfh2zvt3x/&quot;</span>
<span class="gp">... </span>                    <span class="s2">&quot;HyperSpy_demos_EDX_SEM_files.zip?raw=1&quot;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="s2">&quot;./HyperSpy_demos_EDX_SEM_files.zip&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">ZipFile</span><span class="p">(</span><span class="s2">&quot;HyperSpy_demos_EDX_SEM_files.zip&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">z</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">z</span><span class="o">.</span><span class="n">extractall</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="loading-data">
<h3>Loading data<a class="headerlink" href="#loading-data" title="Permalink to this headline">¶</a></h3>
<p>All data are loaded with the <a class="reference internal" href="../api/hyperspy.io.html#hyperspy.io.load" title="hyperspy.io.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a> function, as described in
detail in <a class="reference internal" href="io.html#loading-files"><span class="std std-ref">Loading files</span></a>. HyperSpy is able to import
different formats, among them “.msa” and “.rpl” (the raw format of Oxford
Instruments and Brucker).</p>
<p>Here are three example for files exported by Oxford Instruments software
(INCA). For a single spectrum:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;Ni_superalloy_1pix.msa&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;Signal1D, title: Signal1D, dimensions: (|1024)&gt;</span>
</pre></div>
</div>
<p>For a spectrum image (The .rpl file is recorded as an image in this example,
The method <a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.as_signal1D" title="hyperspy.signal.BaseSignal.as_signal1D"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_signal1D()</span></code></a> set it back to a one
dimensional signal with the energy axis in first position):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">si</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;Ni_superalloy_010.rpl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">as_signal1D</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span>
<span class="go">&lt;Signal1D, title: , dimensions: (256, 224|1024)&gt;</span>
</pre></div>
</div>
<p>Finally, for a stack of spectrum images, using “*” as a wildcard character:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">si4D</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;Ni_superalloy_0*.rpl&quot;</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si4D</span> <span class="o">=</span> <span class="n">si4D</span><span class="o">.</span><span class="n">as_signal1D</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si4D</span>
<span class="go">&lt;Signal1D, title:, dimensions: (256, 224, 2|1024)&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="microscope-and-detector-parameters">
<span id="eds-calibration-label"></span><h3>Microscope and detector parameters<a class="headerlink" href="#microscope-and-detector-parameters" title="Permalink to this headline">¶</a></h3>
<p>First, the signal type (“EDS_TEM” or “EDS_SEM”) needs to be set with the
<a class="reference internal" href="../api/hyperspy.signal.html#hyperspy.signal.BaseSignal.set_signal_type" title="hyperspy.signal.BaseSignal.set_signal_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_signal_type()</span></code></a> method. By assigning the
class of the object, specific EDS methods are made available.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;Ni_superalloy_1pix.msa&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_signal_type</span><span class="p">(</span><span class="s2">&quot;EDS_SEM&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;EDSSEMSpectrum, title: Signal1D, dimensions: (|1024)&gt;</span>
</pre></div>
</div>
<p>You can also specify the signal type as an argument of
the <a class="reference internal" href="../api/hyperspy.io.html#hyperspy.io.load" title="hyperspy.io.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load()</span></code></a> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;Ni_superalloy_1pix.msa&quot;</span><span class="p">,</span> <span class="n">signal_type</span><span class="o">=</span><span class="s2">&quot;EDS_SEM&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">&lt;EDSSEMSpectrum, title: Signal1D, dimensions: (|1024)&gt;</span>
</pre></div>
</div>
<p>HyperSpy will automatically load any existing  microscope parameters from the
file, and store them in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">metadata</span></code>
attribute (see <a class="reference internal" href="metadata_structure.html#metadata-structure"><span class="std std-ref">Metadata structure</span></a>). These parameters can be displayed
as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;Ni_superalloy_1pix.msa&quot;</span><span class="p">,</span> <span class="n">signal_type</span><span class="o">=</span><span class="s2">&quot;EDS_SEM&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Acquisition_instrument</span><span class="o">.</span><span class="n">SEM</span>
<span class="go">├── Detector</span>
<span class="go">│   └── EDS</span>
<span class="go">│       ├── azimuth_angle = 63.0</span>
<span class="go">│       ├── elevation_angle = 35.0</span>
<span class="go">│       ├── energy_resolution_MnKa = 130.0</span>
<span class="go">│       ├── live_time = 0.006855</span>
<span class="go">│       └── real_time = 0.0</span>
<span class="go">├── beam_current = 0.0</span>
<span class="go">├── beam_energy = 15.0</span>
<span class="go">└── tilt_stage = 38.0</span>
</pre></div>
</div>
<p>You can also set these parameters directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;Ni_superalloy_1pix.msa&quot;</span><span class="p">,</span> <span class="n">signal_type</span><span class="o">=</span><span class="s2">&quot;EDS_SEM&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Acquisition_instrument</span><span class="o">.</span><span class="n">SEM</span><span class="o">.</span><span class="n">beam_energy</span> <span class="o">=</span> <span class="mi">30</span>
</pre></div>
</div>
<p>or by using the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">set_microscope_parameters()</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;Ni_superalloy_1pix.msa&quot;</span><span class="p">,</span> <span class="n">signal_type</span><span class="o">=</span><span class="s2">&quot;EDS_SEM&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_microscope_parameters</span><span class="p">(</span><span class="n">beam_energy</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>or through the GUI:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;Ni_superalloy_1pix.msa&quot;</span><span class="p">,</span> <span class="n">signal_type</span><span class="o">=</span><span class="s2">&quot;EDS_SEM&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_microscope_parameters</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../_images/EDS_microscope_parameters_gui.png"><img alt="../_images/EDS_microscope_parameters_gui.png" src="../_images/EDS_microscope_parameters_gui.png" style="width: 350px;" /></a>
<p class="caption"><span class="caption-text">EDS microscope parameters preferences window</span></p>
</div>
<p>Any microscope and detector parameters that are not found in the imported file
will be set by default. These default values can be changed in the
<a class="reference internal" href="../api/hyperspy.defaults_parser.html#hyperspy.defaults_parser.Preferences" title="hyperspy.defaults_parser.Preferences"><code class="xref py py-class docutils literal notranslate"><span class="pre">Preferences</span></code></a> class (see <a class="reference internal" href="getting_started.html#configuring-hyperspy-label"><span class="std std-ref">preferences</span></a>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">EDS</span><span class="o">.</span><span class="n">eds_detector_elevation</span> <span class="o">=</span> <span class="mi">37</span>
</pre></div>
</div>
<p>or through the GUI:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">gui</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../_images/EDS_preferences_gui.png"><img alt="../_images/EDS_preferences_gui.png" src="../_images/EDS_preferences_gui.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">EDS preferences window</span></p>
</div>
</div>
<div class="section" id="energy-axis">
<h3>Energy axis<a class="headerlink" href="#energy-axis" title="Permalink to this headline">¶</a></h3>
<p>The size, scale and units of the energy axis are automatically imported from
the imported file, where they exist. These properties can also be set
or adjusted manually with the <a class="reference internal" href="../api/hyperspy.axes.html#hyperspy.axes.AxesManager" title="hyperspy.axes.AxesManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">AxesManager</span></code></a>
(see <a class="reference internal" href="getting_started.html#setting-axis-properties"><span class="std std-ref">Axis properties</span></a> for more info):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">si</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;Ni_superalloy_010.rpl&quot;</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">signal_type</span><span class="o">=</span><span class="s2">&quot;EDS_TEM&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">as_signal1D</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;E&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;keV&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
</pre></div>
</div>
<p>or through the GUI:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">axes_manager</span><span class="o">.</span><span class="n">gui</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="../_images/EDS_energy_axis_gui.png"><img alt="../_images/EDS_energy_axis_gui.png" src="../_images/EDS_energy_axis_gui.png" style="width: 280px;" /></a>
<p class="caption"><span class="caption-text">Axis properties window</span></p>
</div>
</div>
<div class="section" id="copying-spectrum-calibration">
<h3>Copying spectrum calibration<a class="headerlink" href="#copying-spectrum-calibration" title="Permalink to this headline">¶</a></h3>
<p>All of the above parameters can be copied from one spectrum to another
with the <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_calibration_from()</span></code>
method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># s1pixel contains all the parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1pixel</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;Ni_superalloy_1pix.msa&quot;</span><span class="p">,</span> <span class="n">signal_type</span><span class="o">=</span><span class="s2">&quot;EDS_TEM&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># si contains no parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;Ni_superalloy_010.rpl&quot;</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">signal_type</span><span class="o">=</span><span class="s2">&quot;EDS_TEM&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">as_signal1D</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Copy all the properties of s1pixel to si</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">si</span><span class="o">.</span><span class="n">get_calibration_from</span><span class="p">(</span><span class="n">s1pixel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="describing-the-sample">
<span id="eds-sample-label"></span><h2>Describing the sample<a class="headerlink" href="#describing-the-sample" title="Permalink to this headline">¶</a></h2>
<p>The description of the sample is also stored in the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">metadata</span></code> attribute. It can be displayed using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_TEM_Spectrum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_lines</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Sample</span><span class="o">.</span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Sample</span>
<span class="go">├── description = FePt bimetallic nanoparticles</span>
<span class="go">├── elements = [&#39;Fe&#39;, &#39;Pt&#39;]</span>
<span class="go">├── thickness = 100</span>
<span class="go">└── xray_lines = [&#39;Fe_Ka&#39;, &#39;Pt_La&#39;]</span>
</pre></div>
</div>
<p>The following methods are either called “set” or “add”.</p>
<ul class="simple">
<li>“set” methods overwrite previously defined values</li>
<li>“add” methods add to the previously defined values</li>
</ul>
<div class="section" id="elements">
<h3>Elements<a class="headerlink" href="#elements" title="Permalink to this headline">¶</a></h3>
<p>The elements present in the sample can be defined using the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">set_elements()</span></code>  and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">add_elements()</span></code> methods.  Only element
abbreviations are accepted:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_TEM_Spectrum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_elements</span><span class="p">([</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="s1">&#39;Pt&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_elements</span><span class="p">([</span><span class="s1">&#39;Cu&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Sample</span>
<span class="go">└── elements = [&#39;Cu&#39;, &#39;Fe&#39;, &#39;Pt&#39;]</span>
</pre></div>
</div>
</div>
<div class="section" id="x-ray-lines">
<h3>X-ray lines<a class="headerlink" href="#x-ray-lines" title="Permalink to this headline">¶</a></h3>
<p>Similarly, the X-ray lines can be defined using the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">set_lines()</span></code> and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">add_lines()</span></code> methods. The corresponding
elements will be added automatically.
Several lines per element can be defined at once.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_TEM_Spectrum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_elements</span><span class="p">([</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="s1">&#39;Pt&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_lines</span><span class="p">([</span><span class="s1">&#39;Fe_Ka&#39;</span><span class="p">,</span> <span class="s1">&#39;Pt_La&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_lines</span><span class="p">([</span><span class="s1">&#39;Fe_La&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Sample</span>
<span class="go">├── elements = [&#39;Fe&#39;, &#39;Pt&#39;]</span>
<span class="go">└── xray_lines = [&#39;Fe_Ka&#39;, &#39;Fe_La&#39;, &#39;Pt_La&#39;]</span>
</pre></div>
</div>
<p>The X-ray lines can also be defined automatically, if the beam energy is set.
The most excited X-ray line is selected per element (highest energy above an
overvoltage of 2 (&lt; beam energy / 2)):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_SEM_Spectrum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_elements</span><span class="p">([</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span> <span class="s1">&#39;Cu&#39;</span><span class="p">,</span> <span class="s1">&#39;Mn&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_microscope_parameters</span><span class="p">(</span><span class="n">beam_energy</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_lines</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Sample</span>
<span class="go">├── elements = [&#39;Al&#39;, &#39;Cu&#39;, &#39;Mn&#39;]</span>
<span class="go">└── xray_lines = [&#39;Al_Ka&#39;, &#39;Cu_Ka&#39;, &#39;Mn_Ka&#39;]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_microscope_parameters</span><span class="p">(</span><span class="n">beam_energy</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_lines</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">Sample</span>
<span class="go">├── elements = [&#39;Al&#39;, &#39;Cu&#39;, &#39;Mn&#39;]</span>
<span class="go">└── xray_lines = [&#39;Al_Ka&#39;, &#39;Cu_La&#39;, &#39;Mn_La&#39;]</span>
</pre></div>
</div>
<p>A warning is raised if you try to set an X-ray line higher than the beam
energy:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_SEM_Spectrum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_elements</span><span class="p">([</span><span class="s1">&#39;Mn&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_microscope_parameters</span><span class="p">(</span><span class="n">beam_energy</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_lines</span><span class="p">([</span><span class="s1">&#39;Mn_Ka&#39;</span><span class="p">])</span>
<span class="go">Warning: Mn Ka is above the data energy range.</span>
</pre></div>
</div>
</div>
<div class="section" id="elemental-database">
<h3>Elemental database<a class="headerlink" href="#elemental-database" title="Permalink to this headline">¶</a></h3>
<p>HyperSpy includes an elemental database, which contains the energy of the
X-ray lines.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">Fe</span><span class="o">.</span><span class="n">General_properties</span>
<span class="go">├── Z = 26</span>
<span class="go">├── atomic_weight = 55.845</span>
<span class="go">└── name = iron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">Fe</span><span class="o">.</span><span class="n">Physical_properties</span>
<span class="go">└── density (g/cm^3) = 7.874</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">Fe</span><span class="o">.</span><span class="n">Atomic_properties</span><span class="o">.</span><span class="n">Xray_lines</span>
<span class="go">├── Ka</span>
<span class="go">│   ├── energy (keV) = 6.404</span>
<span class="go">│   └── weight = 1.0</span>
<span class="go">├── Kb</span>
<span class="go">│   ├── energy (keV) = 7.0568</span>
<span class="go">│   └── weight = 0.1272</span>
<span class="go">├── La</span>
<span class="go">│   ├── energy (keV) = 0.705</span>
<span class="go">│   └── weight = 1.0</span>
<span class="go">├── Lb3</span>
<span class="go">│   ├── energy (keV) = 0.792</span>
<span class="go">│   └── weight = 0.02448</span>
<span class="go">├── Ll</span>
<span class="go">│   ├── energy (keV) = 0.615</span>
<span class="go">│   └── weight = 0.3086</span>
<span class="go">└── Ln</span>
<span class="go">    ├── energy (keV) = 0.62799</span>
<span class="go">    └── weight = 0.12525</span>
</pre></div>
</div>
</div>
<div class="section" id="finding-elements-from-energy">
<span id="eds-plot-label"></span><h3>Finding elements from energy<a class="headerlink" href="#finding-elements-from-energy" title="Permalink to this headline">¶</a></h3>
<p>To find the nearest X-ray line for a given energy, use the utility function
<a class="reference internal" href="../api/hyperspy.misc.eds.utils.html#hyperspy.misc.eds.utils.get_xray_lines_near_energy" title="hyperspy.misc.eds.utils.get_xray_lines_near_energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_xray_lines_near_energy()</span></code></a> to search the elemental
database:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_SEM_Spectrum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">find_peaks1D_ohaver</span><span class="p">(</span><span class="n">maxpeakn</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">eds</span><span class="o">.</span><span class="n">get_xray_lines_near_energy</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">],</span> <span class="n">only_lines</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="go">[&#39;C_Ka&#39;, &#39;Ca_La&#39;, &#39;B_Ka&#39;]</span>
</pre></div>
</div>
<p>The lines are returned in order of distance from the specified energy, and can
be limited by additional, optional arguments.</p>
</div>
<div class="section" id="mass-absorption-coefficient-database">
<h3>Mass absorption coefficient database<a class="headerlink" href="#mass-absorption-coefficient-database" title="Permalink to this headline">¶</a></h3>
<p>A mass absorption coefficient database <a class="reference internal" href="bibliography.html#chantler2005"><span class="std std-ref">[Chantler2005]</span></a>
is available:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">mass_absorption_coefficient</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">element</span><span class="o">=</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span> <span class="n">energies</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C_Ka&#39;</span><span class="p">,</span><span class="s1">&#39;Al_Ka&#39;</span><span class="p">])</span>
<span class="go">array([ 26330.38933818,    372.02616732])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hs</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">mass_absorption_mixture</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span><span class="s1">&#39;Zn&#39;</span><span class="p">],</span> <span class="n">weight_percent</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> <span class="n">energies</span><span class="o">=</span><span class="s1">&#39;Al_Ka&#39;</span><span class="p">)</span>
<span class="go">2587.4161643905127</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="plotting">
<span id="id1"></span><h2>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h2>
<p>You can visualize an EDS spectrum using the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">plot()</span></code> method (see
<a class="reference internal" href="visualisation.html#visualization-label"><span class="std std-ref">visualisation</span></a>). For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_SEM_Spectrum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="../_images/EDS_plot_spectrum.png"><img alt="../_images/EDS_plot_spectrum.png" src="../_images/EDS_plot_spectrum.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">EDS spectrum</span></p>
</div>
<p>An example of multi-dimensional EDS data (e.g. 3D SEM-EDS) is given in
<span class="xref std std-ref">visualisation multi-dimension</span>.</p>
<div class="section" id="plotting-x-ray-lines">
<span id="eds-plot-markers-label"></span><h3>Plotting X-ray lines<a class="headerlink" href="#plotting-x-ray-lines" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.8.</span></p>
</div>
<p>X-ray lines can be added as plot labels with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">plot()</span></code>. The lines are either retrieved
from “metadata.Sample.Xray_lines”, or selected with the same method as
<code class="xref py py-meth docutils literal notranslate"><span class="pre">add_lines()</span></code> using the elements in
“metadata.Sample.elements”.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_SEM_Spectrum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_elements</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;Mn&#39;</span><span class="p">,</span><span class="s1">&#39;Cu&#39;</span><span class="p">,</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span><span class="s1">&#39;Zr&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="id6">
<a class="reference internal image-reference" href="../_images/EDS_plot_Xray_default.png"><img alt="../_images/EDS_plot_Xray_default.png" src="../_images/EDS_plot_Xray_default.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">EDS spectrum plot with line markers</span></p>
</div>
<p>You can also select a subset of lines to label:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_SEM_Spectrum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_elements</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;Mn&#39;</span><span class="p">,</span><span class="s1">&#39;Cu&#39;</span><span class="p">,</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span><span class="s1">&#39;Zr&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">only_lines</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ka&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="figure align-center" id="id7">
<a class="reference internal image-reference" href="../_images/EDS_plot_Xray_a.png"><img alt="../_images/EDS_plot_Xray_a.png" src="../_images/EDS_plot_Xray_a.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">EDS spectrum plot with a selection of line markers</span></p>
</div>
</div>
</div>
<div class="section" id="geting-the-intensity-of-an-x-ray-line">
<span id="get-lines-intensity"></span><h2>Geting the intensity of an X-ray line<a class="headerlink" href="#geting-the-intensity-of-an-x-ray-line" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.8.</span></p>
</div>
<p>The sample and data used in this section are described in
<a class="reference internal" href="bibliography.html#rossouw2015"><span class="std std-ref">[Rossouw2015]</span></a>, and can be downloaded using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#Download the data (1MB)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlretrieve</span><span class="p">,</span> <span class="n">urlopen</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">files</span> <span class="o">=</span> <span class="n">urlretrieve</span><span class="p">(</span><span class="s2">&quot;https://www.dropbox.com/s/ecdlgwxjq04m5mx/&quot;</span>
<span class="gp">... </span>                    <span class="s2">&quot;HyperSpy_demos_EDS_TEM_files.zip?raw=1&quot;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="s2">&quot;./HyperSpy_demos_EDX_TEM_files.zip&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">ZipFile</span><span class="p">(</span><span class="s2">&quot;HyperSpy_demos_EDX_TEM_files.zip&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">z</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">z</span><span class="o">.</span><span class="n">extractall</span><span class="p">()</span>
</pre></div>
</div>
<p>The width of integration is defined by extending the energy resolution of
Mn Ka to the peak energy (“energy_resolution_MnKa” in metadata):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;core_shell.hdf5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">get_lines_intensity</span><span class="p">([</span><span class="s1">&#39;Fe_Ka&#39;</span><span class="p">],</span> <span class="n">plot_result</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="id8">
<a class="reference internal image-reference" href="../_images/EDS_get_lines_intensity.png"><img alt="../_images/EDS_get_lines_intensity.png" src="../_images/EDS_get_lines_intensity.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Iron map as computed and displayed by <code class="docutils literal notranslate"><span class="pre">get_lines_intensity</span></code></span></p>
</div>
<p>The X-ray lines defined in “metadata.Sample.Xray_lines” (see above)
are used by default:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;core_shell.hdf5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_lines</span><span class="p">([</span><span class="s1">&#39;Fe_Ka&#39;</span><span class="p">,</span> <span class="s1">&#39;Pt_La&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">get_lines_intensity</span><span class="p">()</span>
<span class="go">[&lt;Signal2D, title: X-ray line intensity of Core shell: Fe_Ka at 6.40 keV, dimensions: (|64, 64)&gt;,</span>
<span class="go">&lt;Signal2D, title: X-ray line intensity of Core shell: Pt_La at 9.44 keV, dimensions: (|64, 64)&gt;]</span>
</pre></div>
</div>
<p>Finally, the windows of integration can be visualised using
<code class="xref py py-meth docutils literal notranslate"><span class="pre">plot()</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_TEM_Spectrum</span><span class="p">()</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mf">5.</span><span class="p">:</span><span class="mf">13.</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_lines</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">integration_windows</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="id9">
<a class="reference internal image-reference" href="../_images/EDS_integration_windows.png"><img alt="../_images/EDS_integration_windows.png" src="../_images/EDS_integration_windows.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">EDS spectrum with integration windows markers</span></p>
</div>
<div class="section" id="background-subtraction">
<span id="eds-background-subtraction-label"></span><h3>Background subtraction<a class="headerlink" href="#background-subtraction" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.8.</span></p>
</div>
<p>The background can be subtracted from the X-ray intensities with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">get_lines_intensity()</span></code>.
The background value is obtained by averaging the intensity in two
windows on each side of the X-ray line.
The position of the windows can be estimated using
<code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate_background_windows()</span></code>, and
can be plotted using <code class="xref py py-meth docutils literal notranslate"><span class="pre">plot()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_TEM_Spectrum</span><span class="p">()</span><span class="o">.</span><span class="n">isig</span><span class="p">[</span><span class="mf">5.</span><span class="p">:</span><span class="mf">13.</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_lines</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bw</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">estimate_background_windows</span><span class="p">(</span><span class="n">line_width</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">background_windows</span><span class="o">=</span><span class="n">bw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">get_lines_intensity</span><span class="p">(</span><span class="n">background_windows</span><span class="o">=</span><span class="n">bw</span><span class="p">,</span> <span class="n">plot_result</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="id10">
<a class="reference internal image-reference" href="../_images/EDS_background_subtraction.png"><img alt="../_images/EDS_background_subtraction.png" src="../_images/EDS_background_subtraction.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">EDS spectrum with background subtraction markers.</span></p>
</div>
</div>
</div>
<div class="section" id="eds-quantification">
<span id="eds-quantification-label"></span><h2>EDS Quantification<a class="headerlink" href="#eds-quantification" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.8: </span>EDS Quantification</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.0: </span>zeta-factors and ionization cross sections</p>
</div>
<p>HyperSpy now includes three methods for EDS quantification:</p>
<ul class="simple">
<li>Cliff-Lorimer</li>
<li>Zeta-factors</li>
<li>Ionization cross sections</li>
</ul>
<p>Quantification must be applied to the background-subtracted intensities, which
can be found using <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_lines_intensity()</span></code>.
The quantification of these intensities can then be calculated using
<code class="xref py py-meth docutils literal notranslate"><span class="pre">quantification()</span></code>.</p>
<p>The quantification method needs be specified as either ‘CL’, ‘zeta’, or
‘cross_section’. If no method is specified, the function will raise an
exception.</p>
<p>A list of factors or cross sections should be supplied in the same order as
the listed intensities (please note that HyperSpy intensities in
<code class="xref py py-meth docutils literal notranslate"><span class="pre">get_lines_intensity()</span></code> are in alphabetical
order).</p>
<p>A set of k-factors can be usually found in the EDS manufacturer software
although determination from standard samples for the particular instrument used
is usually preferable. In the case of zeta-factors and cross sections, these
must be determined experimentally using standards.</p>
<p>Zeta-factors should be provided in units of kg/m^2. The method is described
further in <a class="reference internal" href="bibliography.html#watanabe1996"><span class="std std-ref">[Watanabe1996]</span></a>
and <a class="reference internal" href="bibliography.html#watanabe2006"><span class="std std-ref">[Watanabe2006]</span></a>. Cross sections should be
provided in units of barns (b). Further details on the cross section method can
be found in <a class="reference internal" href="bibliography.html#macarthur2016"><span class="std std-ref">[MacArthur2016]</span></a>. Conversion between
zeta-factors and cross sections is possible using
<a class="reference internal" href="../api/hyperspy.misc.eds.utils.html#hyperspy.misc.eds.utils.edx_cross_section_to_zeta" title="hyperspy.misc.eds.utils.edx_cross_section_to_zeta"><code class="xref py py-func docutils literal notranslate"><span class="pre">edx_cross_section_to_zeta()</span></code></a> or
<a class="reference internal" href="../api/hyperspy.misc.eds.utils.html#hyperspy.misc.eds.utils.zeta_to_edx_cross_section" title="hyperspy.misc.eds.utils.zeta_to_edx_cross_section"><code class="xref py py-func docutils literal notranslate"><span class="pre">zeta_to_edx_cross_section()</span></code></a>.</p>
<p>Using the Cliff-Lorimer method as an example, quantification can be carried
out as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">example_signals</span><span class="o">.</span><span class="n">EDS_TEM_Spectrum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_lines</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kfactors</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.450226</span><span class="p">,</span> <span class="mf">5.075602</span><span class="p">]</span> <span class="c1">#For Fe Ka and Pt La</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bw</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">estimate_background_windows</span><span class="p">(</span><span class="n">line_width</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_lines_intensity</span><span class="p">(</span><span class="n">background_windows</span><span class="o">=</span><span class="n">bw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atomic_percent</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">quantification</span><span class="p">(</span><span class="n">intensities</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;CL&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">factors</span><span class="o">=</span><span class="n">kfactors</span><span class="p">)</span>
<span class="go">Fe (Fe_Ka): Composition = 15.41 atomic percent</span>
<span class="go">Pt (Pt_La): Composition = 84.59 atomic percent</span>
</pre></div>
</div>
<p>The obtained composition is in atomic percent, by default. However, it can be
transformed into weight percent either with the option
<code class="xref py py-meth docutils literal notranslate"><span class="pre">quantification()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># With s, intensities and kfactors from before</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">quantification</span><span class="p">(</span><span class="n">intensities</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;CL&#39;</span><span class="p">,</span> <span class="n">factors</span><span class="o">=</span><span class="n">kfactors</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="n">composition_units</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>
<span class="go">Fe (Fe_Ka): Composition = 4.96 weight percent</span>
<span class="go">Pt (Pt_La): Composition = 95.04 weight percent</span>
</pre></div>
</div>
<p>or using <a class="reference internal" href="../api/hyperspy.misc.material.html#hyperspy.misc.material.atomic_to_weight" title="hyperspy.misc.material.atomic_to_weight"><code class="xref py py-func docutils literal notranslate"><span class="pre">atomic_to_weight()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># With atomic_percent from before</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight_percent</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">atomic_to_weight</span><span class="p">(</span><span class="n">atomic_percent</span><span class="p">)</span>
</pre></div>
</div>
<p>The reverse method is <a class="reference internal" href="../api/hyperspy.misc.material.html#hyperspy.misc.material.weight_to_atomic" title="hyperspy.misc.material.weight_to_atomic"><code class="xref py py-func docutils literal notranslate"><span class="pre">weight_to_atomic()</span></code></a>.</p>
<p>The zeta-factor method needs both the ‘beam_current’ (in nA) and the
acquisition or dwell time (referred to as ‘real_time’ in seconds) in order
to obtain an accurate quantification. Both of the these parameters can be
assigned to the metadata using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_microscope_parameters</span><span class="p">(</span><span class="n">beam_current</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_microscope_parameters</span><span class="p">(</span><span class="n">real_time</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
<p>If these parameters are not set, the code will produce an error.
The zeta-factor method will produce two sets of results. Index [0] contains the
composition maps for each element in atomic percent, and index [1] contains the
mass-thickness map.</p>
<p>The cross section method needs the ‘beam_current’, dwell time (‘real_time’) and
probe area in order to obtain an accurate quantification. The ‘beam_current’
and ‘real_time’ can be set as shown above. The ‘probe_area’ (in nm^2) can
be defined in two different ways.</p>
<p>If the probe diameter is narrower than the pixel width, then the probe is being
under-sampled and an estimation of the probe area needs to be used. This can
be added to the metadata with:</p>
<p>Alternatively, if sub-pixel scanning is used (or the spectrum map was recorded
at a high spatial sampling and subsequently binned into much larger pixels)
then the illumination area becomes the pixel area of the spectrum image.
This is a much more accurate approach for quantitative EDS and should be
used where possible. The pixel width could either be added to the metadata
by putting the pixel area in as the ‘probe_area’ (above) or by calibrating
the spectrum image (see <span class="xref std std-ref">Setting axis properties</span>).</p>
<p>Either approach will provide an illumination area for the cross_section
quantification. If the pixel width is not set, the code will still run with the
default value of 1 nm with a warning message to remind the user that this is
the case.</p>
<p>The cross section method will produce two sets of results. Index [0] contains
the composition maps for each element in atomic percent and index [1] is the
number of atoms per pixel for each element.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please note that the function does not assume square pixels, so both the
x and y pixel dimensions must be set. For quantification of line scans,
rather than spectrum images, the pixel area should be added to the
metadata as above.</p>
</div>
</div>
<div class="section" id="eds-curve-fitting">
<span id="eds-fitting-label"></span><h2>EDS curve fitting<a class="headerlink" href="#eds-curve-fitting" title="Permalink to this headline">¶</a></h2>
<p>The intensity of X-ray lines can be extracted using curve-fitting in HyperSpy.
This example uses an EDS-SEM spectrum of a a test material (EDS-TM001) provided
by <a class="reference external" href="http://www.webshop.bam.de">BAM</a>.</p>
<p>First, we load the spectrum, define the chemical composition of the sample and
set the beam energy:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;bam.msa&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_elements</span><span class="p">([</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span> <span class="s1">&#39;Ar&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;Cu&#39;</span><span class="p">,</span> <span class="s1">&#39;Mn&#39;</span><span class="p">,</span> <span class="s1">&#39;Zr&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">set_microscope_parameters</span><span class="p">(</span><span class="n">beam_energy</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, the model is created with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">create_model()</span></code>. One Gaussian is
automatically created per X-ray line, along with a polynomial for the
background.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">create_model</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">print_current_values</span><span class="p">()</span>

<span class="go">Components    Parameter    Value</span>
<span class="go">Al_Ka</span>
<span class="go">              A            65241.4</span>
<span class="go">Al_Kb</span>
<span class="go">Ar_Ka</span>
<span class="go">              A            3136.88</span>
<span class="go">Ar_Kb</span>
<span class="go">C_Ka</span>
<span class="go">              A            79258.9</span>
<span class="go">Cu_Ka</span>
<span class="go">              A            1640.8</span>
<span class="go">Cu_Kb</span>
<span class="go">Cu_La</span>
<span class="go">              A            74032.6</span>
<span class="go">Cu_Lb1</span>
<span class="go">Cu_Ln</span>
<span class="go">Cu_Ll</span>
<span class="go">Cu_Lb3</span>
<span class="go">Mn_Ka</span>
<span class="go">              A            47796.6</span>
<span class="go">Mn_Kb</span>
<span class="go">Mn_La</span>
<span class="go">              A            73665.7</span>
<span class="go">Mn_Ln</span>
<span class="go">Mn_Ll</span>
<span class="go">Mn_Lb3</span>
<span class="go">Zr_La</span>
<span class="go">              A            68703.8</span>
<span class="go">Zr_Lb1</span>
<span class="go">Zr_Lb2</span>
<span class="go">Zr_Ln</span>
<span class="go">Zr_Lg3</span>
<span class="go">Zr_Ll</span>
<span class="go">Zr_Lg1</span>
<span class="go">Zr_Lb3</span>
<span class="go">background_order_6</span>
</pre></div>
</div>
<p>The width and the energies are fixed, while the heights of the sub-X-ray
lines are linked to the main X-ray lines (alpha lines). The model can now be
fitted:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<p>The background fitting can be improved with
<a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.fit_background" title="hyperspy.models.edsmodel.EDSModel.fit_background"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_background()</span></code></a> by enabling only energy
ranges containing no X-ray lines:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">fit_background</span><span class="p">()</span>
</pre></div>
</div>
<p>The width of the X-ray lines is defined from the energy resolution (FWHM at
Mn Ka) provided by <cite>energy_resolution_MnKa</cite> in <cite>metadata</cite>. This parameters
can be calibrated by fitting with
<a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.calibrate_energy_axis" title="hyperspy.models.edsmodel.EDSModel.calibrate_energy_axis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calibrate_energy_axis()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">calibrate_energy_axis</span><span class="p">(</span><span class="n">calibrate</span><span class="o">=</span><span class="s1">&#39;resolution&#39;</span><span class="p">)</span>
<span class="go">Energy resolution (FWHM at Mn Ka) changed from 130.000000 to 131.927922 eV</span>
</pre></div>
</div>
<p>Fine-tuning of specific X-ray lines can be achieved using
<a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.calibrate_xray_lines" title="hyperspy.models.edsmodel.EDSModel.calibrate_xray_lines"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calibrate_xray_lines()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">calibrate_xray_lines</span><span class="p">(</span><span class="s1">&#39;energy&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Ar_Ka&#39;</span><span class="p">],</span> <span class="n">bound</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">calibrate_xray_lines</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Ar_Ka&#39;</span><span class="p">],</span> <span class="n">bound</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">calibrate_xray_lines</span><span class="p">(</span><span class="s1">&#39;sub_weight&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Mn_La&#39;</span><span class="p">],</span> <span class="n">bound</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>The result of the fit is obtained with the
<a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.get_lines_intensity" title="hyperspy.models.edsmodel.EDSModel.get_lines_intensity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_lines_intensity()</span></code></a> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_lines_intensity</span><span class="p">(</span><span class="n">plot_result</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Al_Ka at 1.4865 keV : Intensity = 65241.42</span>
<span class="go">Ar_Ka at 2.9577 keV : Intensity = 3136.88</span>
<span class="go">C_Ka at 0.2774 keV : Intensity = 79258.95</span>
<span class="go">Cu_Ka at 8.0478 keV : Intensity = 1640.80</span>
<span class="go">Cu_La at 0.9295 keV : Intensity = 74032.56</span>
<span class="go">Mn_Ka at 5.8987 keV : Intensity = 47796.57</span>
<span class="go">Mn_La at 0.63316 keV : Intensity = 73665.70</span>
<span class="go">Zr_La at 2.0423 keV : Intensity = 68703.75</span>
</pre></div>
</div>
<p>Finally, we visualize the result:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/EDS_fitting.png"><img alt="../_images/EDS_fitting.png" src="../_images/EDS_fitting.png" style="width: 500px;" /></a>
</div>
<p>The following methods can be used to enable/disable different
functionalities of X-ray lines when fitting:</p>
<ul class="simple">
<li><a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.free_background" title="hyperspy.models.edsmodel.EDSModel.free_background"><code class="xref py py-meth docutils literal notranslate"><span class="pre">free_background()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.fix_background" title="hyperspy.models.edsmodel.EDSModel.fix_background"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fix_background()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.enable_xray_lines" title="hyperspy.models.edsmodel.EDSModel.enable_xray_lines"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enable_xray_lines()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.disable_xray_lines" title="hyperspy.models.edsmodel.EDSModel.disable_xray_lines"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disable_xray_lines()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.free_sub_xray_lines_weight" title="hyperspy.models.edsmodel.EDSModel.free_sub_xray_lines_weight"><code class="xref py py-meth docutils literal notranslate"><span class="pre">free_sub_xray_lines_weight()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.fix_sub_xray_lines_weight" title="hyperspy.models.edsmodel.EDSModel.fix_sub_xray_lines_weight"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fix_sub_xray_lines_weight()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.free_xray_lines_energy" title="hyperspy.models.edsmodel.EDSModel.free_xray_lines_energy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">free_xray_lines_energy()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.fix_xray_lines_energy" title="hyperspy.models.edsmodel.EDSModel.fix_xray_lines_energy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fix_xray_lines_energy()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.free_xray_lines_width" title="hyperspy.models.edsmodel.EDSModel.free_xray_lines_width"><code class="xref py py-meth docutils literal notranslate"><span class="pre">free_xray_lines_width()</span></code></a></li>
<li><a class="reference internal" href="../api/hyperspy.models.edsmodel.html#hyperspy.models.edsmodel.EDSModel.fix_xray_lines_width" title="hyperspy.models.edsmodel.EDSModel.fix_xray_lines_width"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fix_xray_lines_width()</span></code></a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dielectric_function.html" class="btn btn-neutral float-right" title="Dielectric function tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="eels.html" class="btn btn-neutral" title="Electron Energy Loss Spectroscopy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2011-2018, The HyperSpy development team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'1.4.1',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/copybutton.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>